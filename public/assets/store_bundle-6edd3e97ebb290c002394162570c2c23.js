(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};quanto.StoreManager=t=function(){function t(){this.change_main_cta_button_text=e(this.change_main_cta_button_text,this),this.set_button_text_to_purchase_status=e(this.set_button_text_to_purchase_status,this),this.set_button_html=e(this.set_button_html,this),this.set_button_to_spinner=e(this.set_button_to_spinner,this),this.initialize_sample_cta_button=e(this.initialize_sample_cta_button,this),this.initialize_main_cta_button=e(this.initialize_main_cta_button,this),this.add_query_param_to_url=e(this.add_query_param_to_url,this),this.update_filter_links=e(this.update_filter_links,this);var t,a,n,r,i,o,s,d,u;$.support.pjax&&($.pjax.defaults.scrollTo=!1),$(document).pjax("[data-pjax] a, a[data-pjax]","#pjax-container"),$(document).on("pjax:send",function(){return function(){return $("#pjax-container-wrapper").height($("#pjax-container").height()),$("#pjax-container").fadeOut(100)}}(this)),$(document).on("pjax:complete",function(){return function(){return $("#pjax-container").fadeIn(100),$("#pjax-container-wrapper").height("100%")}}(this)),$(".store-clone-algo-btn").click(function(){return quanto.track_mixpanel("store home algorithm cloned",{feature:$(this).data("internal-name"),location:$(this).data("location")})}),s=this,o=function(){var t,e,a,n;return t=""+window.location.href.split("?")[0],n=$("#search-box").val(),e=s.add_query_param_to_url("searchq",n),a=""+t+e,null!=n&&quanto.track_mixpanel("store search",{query:n}),$.pjax({url:a,container:"#pjax-container"}),s.update_filter_links()},t=_.debounce(o,200),$("#data-filter-dropdown li > a").click(function(){return function(t){return $("#data-filter-dropdown .placeholder-text").html($(t.target).text())}}(this)),$("#search-section").addClass("active"),$("#search-section").click(function(){return function(){return $("#search-section").addClass("active")}}(this)),$(".content-area").click(function(t){var e,a;e=$("#search-section"),a=$("#search-box"),e.is(t.target)||0!==e.has(t.target).length||""!==a.val()||e.removeClass("active")}),$("#search-box").keydown(function(){return function(e){var a,n,r;return a=$(e.target).val(),13===e.keyCode?(o(),void 0):8===e.keyCode?($("#search-box").focus(),""!==a&&t(),void 0):(e.keyCode<48||90<(n=e.keyCode)&&106>n||111<(r=e.keyCode)&&145>r||t(),void 0)}}(this)),$(".feature-holder").hover(function(){quanto.track_mixpanel("store content box hovered",{feature:$(this).data("internal-name")})}),$(".preview-nb").click(function(){return quanto.track_mixpanel("store preview notebook clicked",{feature:$(".main-cta-button").data("internal-name")})}),quanto.is_employee_or_admin()||mixpanel.track_links(".feature-holder a","store detail page clicked",function(t){return{feature:$(t).data("internal-name")}}),$(".help-text").hover(function(){return quanto.track_mixpanel("store mailto hovered")}),$(".help-text").click(function(){return quanto.track_mixpanel("store mailto clicked")}),$(".quantopian-features-container").on("click",".show-more",function(t){return function(e){return t.current_show_more=$(e.target),t.page_to_add=t.current_show_more.data("next-page"),t.current_show_more.addClass("hidden"),$.get(window.location.href,{page:t.page_to_add},function(e){var a,n;return n="new-content-"+t.page_to_add,a="<div id="+n+">"+e+"</div>",$(".quantopian-features-container").append($(a).hide()),$("#"+n).fadeIn(100)})}}(this)),$(".faq-section").length&&(a=.25*$(window).height(),n=($(".faq-section").offset().top-a).toFixed(),u=function(){return quanto.track_mixpanel("faq scrolled into rudimentary")},d=_.throttle(u,2e4),$(window).scroll(function(){var t,e;return e=$(window).scrollTop(),t=Math.abs(e-n),10>t?d():void 0})),quanto.is_mobile_screen()&&(i=$(".navbar-header").height(),r=$(".mobile-footer").offset().top,$(window).scroll(function(){var t;return t=$(window).scrollTop(),t>i&&r>t?$(".preview-and-buy.mobile").removeClass("hidden"):$(".preview-and-buy.mobile").addClass("hidden")}),$("#purchase-feature-modal").on("hidden.bs.modal",function(){return function(){return $(".preview-and-buy.mobile").removeClass("hidden")}}(this))),this.initialize_sample_cta_button(),this.update_filter_links(),this.initialize_main_cta_button(),$.cookie("seen_data_modal")||($("#data-intro-modal").modal("show"),$.cookie("seen_data_modal","true",{expires:365})),$(".data-modal-span").click(function(){return function(){return $("#data-intro-modal").modal("show")}}(this))}return t.prototype.update_filter_links=function(){return $("#select-all-link").attr("href",this.add_query_param_to_url("type","all")),$("#select-free-link").attr("href",this.add_query_param_to_url("type","free")),$("#select-premium-link").attr("href",this.add_query_param_to_url("type","premium")),$("#select-mine-link").attr("href",this.add_query_param_to_url("type","mine"))},t.prototype.add_query_param_to_url=function(t,e){var a,n,r,i,o;return r=window.location.href.split("?")[1],o={},o[t]=e,n=$.param(o),r?(i=!1,a=r.split("&"),a=a.map(function(e){var a;return a=e.split("="),a[0]===t?(i=!0,n):e}),i||a.push(n),"?"+a.join("&")):"?"+n},t.prototype.initialize_main_cta_button=function(){return $(".main-cta-button").click(function(t){return function(e){var a,n,r,i,o;if(!quanto.is_real_user())return quanto.show_join_popup(),void 0;switch(a=$(e.target).closest(".main-cta-button"),r=a.data("internal-name"),o=a.data("vendor-internal-name"),i=a.data("purchase-status"),n={feature_name:r},i){case"Cancel":return t.set_button_to_spinner(a),$.post("/users/remove_paid_feature",n,function(e){var n;return n=new quanto.JsonResponse(e),n.ok()?t.change_main_cta_button_text():(t.set_button_text_to_purchase_status(a),quanto.show_error_popup())}).error(function(){return t.set_button_text_to_purchase_status(a),quanto.show_error_popup()});case"Get":return quanto.track_mixpanel("store buy button clicked",{feature:$(".main-cta-button").data("internal-name")}),$(".preview-and-buy.mobile").addClass("hidden"),quanto.instances.billmodalmgr.handle_feature(n.feature_name,o);case"Restart":return t.set_button_to_spinner(a),$.post("/users/add_paid_feature",n,function(e){var n;return n=new quanto.JsonResponse(e),n.ok()?t.change_main_cta_button_text():(t.set_button_text_to_purchase_status(a),quanto.show_error_popup())}).error(function(){return t.set_button_text_to_purchase_status(a),quanto.show_error_popup()})}}}(this))},t.prototype.initialize_sample_cta_button=function(){return $(".sample-cta-button").click(function(t){return function(e){var a,n,r,i,o,s,d;return quanto.is_real_user()?(a=$(e.target).closest(".sample-cta-button"),n=a.html(),i=a.data("internal-name"),o=a.data("vendor-internal-name"),r={feature_name:i},quanto.track_mixpanel("store free dataset added",{feature:i}),d=i.split(".")[2],s="/data/confirmation/"+o+"/"+d,$(".main-cta-button").length&&(s=""+s+"?type=free_sample"),t.set_button_to_spinner(a),window.location=s,$.post("/users/add_free_feature",r,function(e){var r;return r=new quanto.JsonResponse(e),r.ok()?window.location=s:(t.set_button_html(a,n),quanto.show_error_popup())}).error(function(){return t.set_button_html(a,n),quanto.show_error_popup()})):(quanto.show_join_popup(),void 0)}}(this))},t.prototype.set_button_to_spinner=function(t){return t.addClass("disabled"),t.html('<i class="icon icon-refresh icon-spin icon-large blue-icon"></i>')},t.prototype.set_button_html=function(t,e){return t.removeClass("disabled"),t.html(e)},t.prototype.set_button_text_to_purchase_status=function(t){return t.removeClass("disabled"),t.text(t.data("purchase-status"))},t.prototype.change_main_cta_button_text=function(){var t;switch(t=$(".main-cta-button"),t.removeClass("disabled"),t.data("purchase-status")){case"Cancel":t.data("purchase-status","Restart"),t.text("Restart");break;case"Restart":t.data("purchase-status","Cancel"),t.text("Cancel");break;case"Get":t.data("purchase-status","Cancel"),t.text("Cancel")}},t}()}).call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};quanto.BillingUIBase=t=function(){function t(){this.validate_card_field=e(this.validate_card_field,this),this.handle_add_card_clicked=e(this.handle_add_card_clicked,this)}return t.prototype.handle_add_card_clicked=function(t,e,a){var n,r,i,o,s,d,u,c,l,h,p;return i=this.$cardnumber_box.val(),u=this.$carddate_box.val().split("/"),c=$.trim(u[0]),l=$.trim(u[1]),o=this.$cardcvc_box.val(),n=this.$region_box.find(":selected").text(),h=this.validate_card_field(this.$cardnumber_box),d=this.validate_card_field(this.$carddate_box),s=this.validate_card_field(this.$cardcvc_box),p=this.validate_card_field(this.$region_box),h&&d&&s&&p?(r=function(){return function(e,n){var r,i;return n.error?null!=a?a():void 0:(i=n.id,r={card_token:i},$.post("/users/add_billing_info",r,function(e){var a;return a=new quanto.JsonResponse(e),a.ok()&&null!=t?t():void 0}).error(function(){return null!=a?a():void 0}))}}(this),Stripe.card.createToken({number:i,cvc:o,exp_month:c,exp_year:l,address_state:n},r)):(null!=e&&e(),void 0)},t.prototype.validate_card_field=function(t){var e,a,n,r,i,o,s,d,u,c;switch(t){case this.$cardnumber_box:return e=this.$cardnumber_box.val(),d=$.payment.validateCardNumber(e),d?this.$cardnumber_box.removeClass("invalid"):this.$cardnumber_box.addClass("invalid"),d;case this.$carddate_box:return i=this.$carddate_box.val().split("/"),o=$.trim(i[0]),s=$.trim(i[1]),r=$.payment.validateCardExpiry(o,s),r?this.$carddate_box.removeClass("invalid"):this.$carddate_box.addClass("invalid"),r;case this.$cardcvc_box:return a=this.$cardcvc_box.val(),n=$.payment.validateCardCVC(a),n?this.$cardcvc_box.removeClass("invalid"):this.$cardcvc_box.addClass("invalid"),n;case this.$region_box:return u=this.$region_box.find(":selected").text(),c="Select"!==u&&"Region"!==u,c?this.$region_box.removeClass("invalid"):this.$region_box.addClass("invalid"),c}},t}()}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},a={}.hasOwnProperty,n=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};quanto.BillingModalManager=t=function(t){function a(){this.show_sales_tax_info=e(this.show_sales_tax_info,this),this.handle_payment_error=e(this.handle_payment_error,this),this.add_paid_feature=e(this.add_paid_feature,this),this.handle_purchase_clicked=e(this.handle_purchase_clicked,this),this.handle_feature=e(this.handle_feature,this),this.set_ui=e(this.set_ui,this),this.$purchase_modal=$("#purchase-feature-modal"),this.$purchase_modal.find(".action-button").click(function(t){return function(){return t.handle_purchase_clicked()}}(this)),this.$cardnumber_box=this.$purchase_modal.find("#card-number"),this.$carddate_box=this.$purchase_modal.find("#card-date"),this.$cardcvc_box=this.$purchase_modal.find("#card-cvc"),this.$region_box=this.$purchase_modal.find("#region"),this.$cardnumber_box.on("focusout",function(t){return function(){return t.validate_card_field(t.$cardnumber_box)}}(this)),this.$carddate_box.on("focusout",function(t){return function(){return t.validate_card_field(t.$carddate_box)}}(this)),this.$cardcvc_box.on("focusout",function(t){return function(){return t.validate_card_field(t.$cardcvc_box)}}(this)),this.$region_box.on("focusout",function(t){return function(){return t.validate_card_field(t.$region_box)}}(this)),$("#tos-checkbox").on("click",function(){return function(){var t,e;return e=$("#tos-checkbox"),t=$(".tos-check"),e[0].checked?t.removeClass("error"):t.addClass("error")}}(this)),this.$region_box.on("change load",function(t){return function(e){var a,n,r;return a=$(e.target).find(":selected").text(),r=$(e.target).data("tax-rates"),n=r[a],t.show_sales_tax_info(n)}}(this)),this.$cardnumber_box.payment("formatCardNumber"),this.$cardnumber_box.bind("payment.cardType",function(t){return function(e,a){return t.$purchase_modal.find(".card-image").removeClass().addClass("card-image").addClass(a)}}(this)),this.$carddate_box.payment("formatCardExpiry"),this.$cardcvc_box.payment("formatCardCVC"),this.user_saved_card=$(".main-cta-button").data("user-saved-card")}return n(a,t),a.prototype.set_ui=function(t){var e,a;switch(this.$purchase_modal.find(".modal-footer").removeClass("hidden"),this.$purchase_modal.find(".default-buttons").removeClass("hidden"),this.$purchase_modal.find(".finish-button").addClass("hidden"),t){case"initial":return this.$purchase_modal.find(".body-content").removeClass("hidden"),this.$purchase_modal.find(".billing-ui, .result-display").addClass("hidden"),this.$purchase_modal.find(".tos-check").removeClass("hidden");case"billing":return this.$purchase_modal.find(".billing-ui").removeClass("hidden"),this.$purchase_modal.find(".invalid").removeClass("invalid"),this.$purchase_modal.find(".tos-check").removeClass("hidden"),a=this.$region_box.find(":selected").text(),e=this.$region_box.data("tax-rates"),this.show_sales_tax_info(e[a]);case"saved-card":return this.$purchase_modal.find(".saved-card-ui").removeClass("hidden"),this.$purchase_modal.find(".invalid").removeClass("invalid"),this.$purchase_modal.find(".tos-check").removeClass("hidden"),a=$(".main-cta-button").data("user-region"),e=this.$region_box.data("tax-rates"),this.show_sales_tax_info(e[a]);case"success":return this.$purchase_modal.find(".body-content, .billing-ui").addClass("hidden"),this.$purchase_modal.find(".result-display").removeClass("hidden"),this.$purchase_modal.find(".result-display .success").removeClass("hidden"),this.$purchase_modal.find(".result-display .failure").addClass("hidden"),this.$purchase_modal.find(".default-buttons").addClass("hidden");case"internal-failure":return this.$purchase_modal.find(".body-content, .billing-ui").addClass("hidden"),this.$purchase_modal.find(".result-display").removeClass("hidden"),this.$purchase_modal.find(".result-display .success").addClass("hidden"),this.$purchase_modal.find(".result-display .failure").removeClass("hidden"),this.$purchase_modal.find(".result-display .failure .internal").removeClass("hidden"),this.$purchase_modal.find(".saved-card-ui").addClass("hidden"),this.$purchase_modal.find(".salestax-info").addClass("hidden"),this.$purchase_modal.find(".tos-check").addClass("hidden"),this.$purchase_modal.find(".modal-footer").addClass("hidden");case"card-failure":return this.$purchase_modal.find(".body-content, .billing-ui").addClass("hidden"),this.$purchase_modal.find(".result-display").removeClass("hidden"),this.$purchase_modal.find(".result-display .success").addClass("hidden"),this.$purchase_modal.find(".result-display .failure").removeClass("hidden"),this.$purchase_modal.find(".result-display .failure .card").removeClass("hidden"),this.$purchase_modal.find(".saved-card-ui").addClass("hidden"),this.$purchase_modal.find(".salestax-info").addClass("hidden"),this.$purchase_modal.find(".tos-check").addClass("hidden"),this.$purchase_modal.find(".modal-footer").addClass("hidden");case"noretry-failure":return this.$purchase_modal.find(".body-content, .billing-ui").addClass("hidden"),this.$purchase_modal.find(".result-display").removeClass("hidden"),this.$purchase_modal.find(".result-display .success").addClass("hidden"),this.$purchase_modal.find(".result-display .failure").removeClass("hidden"),this.$purchase_modal.find(".result-display .failure .noretry").removeClass("hidden"),this.$purchase_modal.find(".saved-card-ui").addClass("hidden"),this.$purchase_modal.find(".salestax-info").addClass("hidden"),this.$purchase_modal.find(".tos-check").addClass("hidden"),this.$purchase_modal.find(".modal-footer").addClass("hidden")}},a.prototype.handle_feature=function(t,e){return quanto.is_real_user()?(this.feature_to_purchase=t,this.feature_vendor=e,this.set_ui("initial"),this.$purchase_modal.find(".feature-name").html(t),this.user_saved_card?this.set_ui("saved-card"):this.set_ui("billing"),this.$purchase_modal.find(".action-button").removeClass("disabled"),this.$purchase_modal.find(".action-button .content").removeClass("hidden"),this.$purchase_modal.find(".action-button .loading").addClass("hidden"),this.$purchase_modal.modal({show:!0,backdrop:"static"})):(quanto.show_join_popup(),void 0)},a.prototype.handle_purchase_clicked=function(){var t,e,a;return t=function(t){return function(){return t.add_paid_feature(t.feature_to_purchase,t.feature_vendor)}}(this),e=function(t){return function(){return t.$purchase_modal.find(".action-button").removeClass("disabled"),t.$purchase_modal.find(".action-button .content").removeClass("hidden"),t.$purchase_modal.find(".action-button .loading").addClass("hidden")}}(this),a=$("#tos-checkbox")[0].checked,a?(this.$purchase_modal.find(".action-button").addClass("disabled"),$(".tos-check").removeClass("error"),this.$purchase_modal.find(".action-button .content").addClass("hidden"),this.$purchase_modal.find(".action-button .loading").removeClass("hidden"),this.user_saved_card?t():this.handle_add_card_clicked(t,e,e)):(setTimeout(function(){return $(".tos-check").removeClass("shake")},1500),$(".tos-check").addClass("shake"),$(".tos-check").addClass("error"))},a.prototype.add_paid_feature=function(t,e){var a,n,r;return a={feature_name:t},r=t.split(".")[2],n=""+e+"/"+r,$.post("/users/add_paid_feature",a,function(t){return function(e){var r;return r=new quanto.JsonResponse(e),r.ok()?window.location="/data/confirmation/"+n:(a=r.data(),t.handle_payment_error(a))}}(this)).error(function(t){return function(e){var n;return n=new quanto.JsonResponse(e),a=n.data(),t.handle_payment_error(a)}}(this))},a.prototype.handle_payment_error=function(t){if(this.user_saved_card||$.post("/users/delete_billing_info",{},function(){return function(t){var e;return e=new quanto.JsonResponse(t),e.ok()?void 0:quanto.show_error_popup()}}(this)).error(function(){return function(){return quanto.show_error_popup()}}(this)),!t)return this.set_ui("internal-failure"),void 0;switch(t.type){case"UserPaymentError":return this.set_ui("card-failure");case"PostSuccessfulPaymentError":return this.set_ui("noretry-failure");default:return this.set_ui("internal-failure")}},a.prototype.show_sales_tax_info=function(t){var e,a;return t?(e=parseInt($(".modal-price").data("monthly-price")),a=e*(1+t/100),a=a.toFixed(2),$(".salestax-info").text("Your total charge for this subscription will be $"+a+" per month, inclusive of applicable sales taxes."),$(".salestax-info").removeClass("hidden")):$(".salestax-info").addClass("hidden")},a}(quanto.BillingUIBase)}.call(this),!function(t){function e(e,n,r){var i=this;return this.on("click.pjax",e,function(e){var o=t.extend({},f(n,r));o.container||(o.container=t(this).attr("data-pjax")||i),a(e,o)})}function a(e,a,n){n=f(a,n);var i=e.currentTarget;if("A"!==i.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||location.protocol!==i.protocol||location.hostname!==i.hostname||i.href.indexOf("#")>-1&&_(i)==_(location)||e.isDefaultPrevented())){var o={url:i.href,container:t(i).attr("data-pjax"),target:i},s=t.extend({},o,n),d=t.Event("pjax:click");t(i).trigger(d,[s]),d.isDefaultPrevented()||(r(s),e.preventDefault(),t(i).trigger("pjax:clicked",[s]))}}function n(e,a,n){n=f(a,n);var i=e.currentTarget,o=t(i);if("FORM"!==i.tagName.toUpperCase())throw"$.pjax.submit requires a form element";var s={type:(o.attr("method")||"GET").toUpperCase(),url:o.attr("action"),container:o.attr("data-pjax"),target:i};if("GET"!==s.type&&void 0!==window.FormData)s.data=new FormData(i),s.processData=!1,s.contentType=!1;else{if(t(i).find(":file").length)return;s.data=t(i).serializeArray()}r(t.extend({},s,n)),e.preventDefault()}function r(e){function a(e,a,r){r||(r={}),r.relatedTarget=n;var i=t.Event(e,r);return s.trigger(i,a),!i.isDefaultPrevented()}e=t.extend(!0,{},t.ajaxSettings,r.defaults,e),t.isFunction(e.url)&&(e.url=e.url());var n=e.target,i=p(e.url).hash,s=e.context=m(e.container);e.data||(e.data={}),t.isArray(e.data)?e.data.push({name:"_pjax",value:s.selector}):e.data._pjax=s.selector;var d;e.beforeSend=function(t,n){if("GET"!==n.type&&(n.timeout=0),t.setRequestHeader("X-PJAX","true"),t.setRequestHeader("X-PJAX-Container",s.selector),!a("pjax:beforeSend",[t,n]))return!1;n.timeout>0&&(d=setTimeout(function(){a("pjax:timeout",[t,e])&&t.abort("timeout")},n.timeout),n.timeout=0);var r=p(n.url);i&&(r.hash=i),e.requestUrl=h(r)},e.complete=function(t,n){d&&clearTimeout(d),a("pjax:complete",[t,n,e]),a("pjax:end",[t,e])},e.error=function(t,n,r){var i=b("",t,e),s=a("pjax:error",[t,n,r,e]);"GET"==e.type&&"abort"!==n&&s&&o(i.url)},e.success=function(n,d,u){var l=r.state,h="function"==typeof t.pjax.defaults.version?t.pjax.defaults.version():t.pjax.defaults.version,_=u.getResponseHeader("X-PJAX-Version"),f=b(n,u,e),m=p(f.url);if(i&&(m.hash=i,f.url=m.href),h&&_&&h!==_)return void o(f.url);if(!f.contents)return void o(f.url);r.state={id:e.id||c(),url:f.url,title:f.title,container:s.selector,fragment:e.fragment,timeout:e.timeout},(e.push||e.replace)&&window.history.replaceState(r.state,f.title,f.url);var v=t.contains(e.container,document.activeElement);if(v)try{document.activeElement.blur()}catch($){}f.title&&(document.title=f.title),a("pjax:beforeReplace",[f.contents,e],{state:r.state,previousState:l}),s.html(f.contents);var y=s.find("input[autofocus], textarea[autofocus]").last()[0];y&&document.activeElement!==y&&y.focus(),x(f.scripts);var g=e.scrollTo;if(i){var w=decodeURIComponent(i.slice(1)),C=document.getElementById(w)||document.getElementsByName(w)[0];C&&(g=t(C).offset().top)}"number"==typeof g&&t(window).scrollTop(g),a("pjax:success",[n,d,u,e])},r.state||(r.state={id:c(),url:window.location.href,title:document.title,container:s.selector,fragment:e.fragment,timeout:e.timeout},window.history.replaceState(r.state,document.title)),u(r.xhr),r.options=e;var _=r.xhr=t.ajax(e);return _.readyState>0&&(e.push&&!e.replace&&(y(r.state.id,l(s)),window.history.pushState(null,"",e.requestUrl)),a("pjax:start",[_,e]),a("pjax:send",[_,e])),r.xhr}function i(e,a){var n={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return r(t.extend(n,f(e,a)))}function o(t){window.history.replaceState(null,"",r.state.url),window.location.replace(t)}function s(e){q||u(r.xhr);var a,n=r.state,i=e.state;if(i&&i.container){if(q&&T==i.url)return;if(n){if(n.id===i.id)return;a=n.id<i.id?"forward":"back"}var s=S[i.id]||[],d=t(s[0]||i.container),c=s[1];if(d.length){n&&g(a,n.id,l(d));var h=t.Event("pjax:popstate",{state:i,direction:a});d.trigger(h);var p={id:i.id,url:i.url,container:d,push:!1,fragment:i.fragment,timeout:i.timeout,scrollTo:!1};if(c){d.trigger("pjax:start",[null,p]),r.state=i,i.title&&(document.title=i.title);var _=t.Event("pjax:beforeReplace",{state:i,previousState:n});d.trigger(_,[c,p]),d.html(c),d.trigger("pjax:end",[null,p])}else r(p);d[0].offsetHeight}else o(location.href)}q=!1}function d(e){var a=t.isFunction(e.url)?e.url():e.url,n=e.type?e.type.toUpperCase():"GET",r=t("<form>",{method:"GET"===n?"GET":"POST",action:a,style:"display:none"});"GET"!==n&&"POST"!==n&&r.append(t("<input>",{type:"hidden",name:"_method",value:n.toLowerCase()}));var i=e.data;if("string"==typeof i)t.each(i.split("&"),function(e,a){var n=a.split("=");r.append(t("<input>",{type:"hidden",name:n[0],value:n[1]}))});else if(t.isArray(i))t.each(i,function(e,a){r.append(t("<input>",{type:"hidden",name:a.name,value:a.value}))});else if("object"==typeof i){var o;for(o in i)r.append(t("<input>",{type:"hidden",name:o,value:i[o]}))}t(document.body).append(r),r.submit()}function u(e){e&&e.readyState<4&&(e.onreadystatechange=t.noop,e.abort())}function c(){return(new Date).getTime()}function l(t){var e=t.clone();return e.find("script").each(function(){this.src||jQuery._data(this,"globalEval",!1)}),[t.selector,e.contents()]}function h(t){return t.search=t.search.replace(/([?&])(_pjax|_)=[^&]*/g,""),t.href.replace(/\?($|#)/,"$1")}function p(t){var e=document.createElement("a");return e.href=t,e}function _(t){return t.href.replace(/#.*/,"")}function f(e,a){return e&&a?a.container=e:a=t.isPlainObject(e)?e:{container:e},a.container&&(a.container=m(a.container)),a}function m(e){if(e=t(e),e.length){if(""!==e.selector&&e.context===document)return e;if(e.attr("id"))return t("#"+e.attr("id"));throw"cant get selector for pjax container!"}throw"no pjax container for "+e.selector}function v(t,e){return t.filter(e).add(t.find(e))}function $(e){return t.parseHTML(e,document,!0)}function b(e,a,n){var r={},i=/<html/i.test(e),o=a.getResponseHeader("X-PJAX-URL");if(r.url=o?h(p(o)):n.requestUrl,i)var s=t($(e.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0])),d=t($(e.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]));else var s=d=t($(e));if(0===d.length)return r;if(r.title=v(s,"title").last().text(),n.fragment){if("body"===n.fragment)var u=d;else var u=v(d,n.fragment).first();u.length&&(r.contents="body"===n.fragment?u:u.contents(),r.title||(r.title=u.attr("title")||u.data("title")))}else i||(r.contents=d);return r.contents&&(r.contents=r.contents.not(function(){return t(this).is("title")}),r.contents.find("title").remove(),r.scripts=v(r.contents,"script[src]").remove(),r.contents=r.contents.not(r.scripts)),r.title&&(r.title=t.trim(r.title)),r}function x(e){if(e){var a=t("script[src]");e.each(function(){var e=this.src,n=a.filter(function(){return this.src===e});if(!n.length){var r=document.createElement("script"),i=t(this).attr("type");i&&(r.type=i),r.src=t(this).attr("src"),document.head.appendChild(r)}})}}function y(t,e){S[t]=e,P.push(t),w(R,0),w(P,r.defaults.maxCacheLength)}function g(t,e,a){var n,i;S[e]=a,"forward"===t?(n=P,i=R):(n=R,i=P),n.push(e),(e=i.pop())&&delete S[e],w(n,r.defaults.maxCacheLength)}function w(t,e){for(;t.length>e;)delete S[t.shift()]}function C(){return t("meta").filter(function(){var e=t(this).attr("http-equiv");return e&&"X-PJAX-VERSION"===e.toUpperCase()}).attr("content")}function k(){t.fn.pjax=e,t.pjax=r,t.pjax.enable=t.noop,t.pjax.disable=j,t.pjax.click=a,t.pjax.submit=n,t.pjax.reload=i,t.pjax.defaults={timeout:650,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20,version:C},t(window).on("popstate.pjax",s)}function j(){t.fn.pjax=function(){return this},t.pjax=d,t.pjax.enable=k,t.pjax.disable=t.noop,t.pjax.click=t.noop,t.pjax.submit=t.noop,t.pjax.reload=function(){window.location.reload()},t(window).off("popstate.pjax",s)}var q=!0,T=window.location.href,E=window.history.state;E&&E.container&&(r.state=E),"state"in window.history&&(q=!1);var S={},R=[],P=[];t.inArray("state",t.event.props)<0&&t.event.props.push("state"),t.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/),t.support.pjax?k():j()}(jQuery);