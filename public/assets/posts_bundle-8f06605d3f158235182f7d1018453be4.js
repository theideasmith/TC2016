var Markdown;Markdown="object"==typeof exports&&"function"==typeof require?exports:{},function(){function t(t){return t}function e(){return!1}function i(){}function n(){}i.prototype={chain:function(e,i){var n=this[e];if(!n)throw new Error("unknown hook "+e);this[e]=n===t?i:function(t){return i(n(t))}},set:function(t,e){if(!this[t])throw new Error("unknown hook "+t);this[t]=e},addNoop:function(e){this[e]=t},addFalse:function(t){this[t]=e}},Markdown.HookCollection=i,n.prototype={set:function(t,e){this["s_"+t]=e},get:function(t){return this["s_"+t]}},Markdown.Converter=function(){function t(t){return t=t.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(?:\n+)/gm,function(t,e,i,n,r,o){return e=e.toLowerCase(),O.set(e,k(i)),r?n:(o&&E.set(e,o.replace(/"/g,"&quot;")),"")})}function e(t){return t=t.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,r),t=t.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,r),t=t.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,r),t=t.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,r),t=t.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,r)}function r(t,e){var i=e;return i=i.replace(/^\n+/,""),i=i.replace(/\n+$/g,""),i="\n\n~K"+(H.push(i)-1)+"K\n\n"}function o(t,i){t=p(t);var n="<hr />\n";return t=t.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,n),t=t.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,n),t=t.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,n),t=f(t),t=m(t),t=_(t),t=e(t),t=w(t,i)}function a(t){return t=b(t),t=s(t),t=C(t),t=h(t),t=l(t),t=T(t),t=t.replace(/~P/g,"://"),t=k(t),t=x(t),t=t.replace(/  +\n/g," <br>\n")}function s(t){var e=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi;return t=t.replace(e,function(t){var e=t.replace(/(.)<\/?code>(?=.)/g,"$1`");return e=$(e,"!"==t.charAt(1)?"\\`*_/":"\\`*_")})}function l(t){return t=t.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,c),t=t.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,c),t=t.replace(/(\[([^\[\]]+)\])()()()()()/g,c)}function c(t,e,i,n,r,o,a,s){void 0==s&&(s="");var l=e,c=i.replace(/:\/\//g,"~P"),h=n.toLowerCase(),u=r,p=s;if(""==u)if(""==h&&(h=c.toLowerCase().replace(/ ?\n/g," ")),u="#"+h,void 0!=O.get(h))u=O.get(h),void 0!=E.get(h)&&(p=E.get(h));else{if(!(l.search(/\(\s*\)$/m)>-1))return l;u=""}u=A(u),u=$(u,"*_");var f='<a href="'+u+'"';return""!=p&&(p=d(p),p=$(p,"*_"),f+=' title="'+p+'"'),f+=">"+c+"</a>"}function h(t){return t=t.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,u),t=t.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,u)}function d(t){return t.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}function u(t,e,i,n,r,o,a,s){var l=e,c=i,h=n.toLowerCase(),u=r,p=s;if(p||(p=""),""==u){if(""==h&&(h=c.toLowerCase().replace(/ ?\n/g," ")),u="#"+h,void 0==O.get(h))return l;u=O.get(h),void 0!=E.get(h)&&(p=E.get(h))}c=$(d(c),"*_[]()"),u=$(u,"*_");var f='<img src="'+u+'" alt="'+c+'"';return p=d(p),p=$(p,"*_"),f+=' title="'+p+'"',f+=" />"}function p(t){return t=t.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(t,e){return"<h1>"+a(e)+"</h1>\n\n"}),t=t.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(t,e){return"<h2>"+a(e)+"</h2>\n\n"}),t=t.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(t,e,i){var n=e.length;return"<h"+n+">"+a(i)+"</h"+n+">\n\n"})}function f(t){t+="~0";var e=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return z?t=t.replace(e,function(t,e,i){var n=e,r=i.search(/[*+-]/g)>-1?"ul":"ol",o=g(n,r);return o=o.replace(/\s+$/,""),o="<"+r+">"+o+"</"+r+">\n"}):(e=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,t=t.replace(e,function(t,e,i,n){var r=e,o=i,a=n.search(/[*+-]/g)>-1?"ul":"ol",s=g(o,a);return s=r+"<"+a+">\n"+s+"</"+a+">\n"})),t=t.replace(/~0/,"")}function g(t,e){z++,t=t.replace(/\n{2,}$/,"\n"),t+="~0";var i=I[e],n=new RegExp("(^[ \\t]*)("+i+")[ \\t]+([^\\r]+?(\\n+))(?=(~0|\\1("+i+")[ \\t]+))","gm"),r=!1;return t=t.replace(n,function(t,e,i,n){var s=n,l=/\n\n$/.test(s),c=l||s.search(/\n{2,}/)>-1;return c||r?s=o(L(s),!0):(s=f(L(s)),s=s.replace(/\n$/,""),s=a(s)),r=l,"<li>"+s+"</li>\n"}),t=t.replace(/~0/g,""),z--,t}function m(t){return t+="~0",t=t.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(t,e,i){var n=e,r=i;return n=y(L(n)),n=M(n),n=n.replace(/^\n+/g,""),n=n.replace(/\n+$/g,""),n='<pre class="prettyprint"><code>'+n+"\n</code></pre>","\n\n"+n+"\n\n"+r}),t=t.replace(/~0/,"")}function v(t){return t=t.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(H.push(t)-1)+"K\n\n"}function b(t){return t=t.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(t,e,i,n){var r=n;return r=r.replace(/^([ \t]*)/g,""),r=r.replace(/[ \t]*$/g,""),r=y(r),r=r.replace(/:\/\//g,"~P"),e+"<code>"+r+"</code>"})}function y(t){return t=t.replace(/&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=$(t,"*_{}[]\\",!1)}function x(t){return t=t.replace(/([\W_]|^)(\*\*|__)(?=\S)([^\r]*?\S[\*_]*)\2([\W_]|$)/g,"$1<strong>$3</strong>$4"),t=t.replace(/([\W_]|^)(\*|_)(?=\S)([^\r\*_]*?\S)\2([\W_]|$)/g,"$1<em>$3</em>$4")}function _(t){return t=t.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(t,e){var i=e;return i=i.replace(/^[ \t]*>[ \t]?/gm,"~0"),i=i.replace(/~0/g,""),i=i.replace(/^[ \t]+$/gm,""),i=o(i),i=i.replace(/(^|\n)/g,"$1  "),i=i.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(t,e){var i=e;return i=i.replace(/^  /gm,"~0"),i=i.replace(/~0/g,"")}),v("<blockquote>\n"+i+"\n</blockquote>")})}function w(t,e){t=t.replace(/^\n+/g,""),t=t.replace(/\n+$/g,"");for(var i=t.split(/\n{2,}/g),n=[],r=/~K(\d+)K/,o=i.length,s=0;o>s;s++){var l=i[s];r.test(l)?n.push(l):/\S/.test(l)&&(l=a(l),l=l.replace(/^([ \t]*)/g,"<p>"),l+="</p>",n.push(l))}if(!e){o=n.length;for(var s=0;o>s;s++)for(var c=!0;c;)c=!1,n[s]=n[s].replace(/~K(\d+)K/g,function(t,e){return c=!0,H[e]})}return n.join("\n\n")}function k(t){return t=t.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),t=t.replace(/<(?![a-z\/?\$!])/gi,"&lt;")}function C(t){return t=t.replace(/\\(\\)/g,P),t=t.replace(/\\([`*_{}\[\]()>#+-.!])/g,P)}function T(t){t=t.replace(/(^|\s)(https?|ftp)(:\/\/[-A-Z0-9+&@#\/%?=~_|\[\]\(\)!:,\.;]*[-A-Z0-9+&@#\/%=~_|\[\]])($|\W)/gi,"$1<$2$3>$4");var e=function(t,e){return'<a href="'+e+'">'+D.plainLinkText(e)+"</a>"};t=t.replace(/<((https?|ftp):[^'">\s]+)>/gi,e);var i=function(t,e){var i,n,r="mailto:";return e.substring(0,r.length)!=r?(i=r+e,n=e):(i=e,n=e.substring(r.length,e.length)),'<a href="'+i+'">'+D.plainLinkText(n)+"</a>"};return t=t.replace(/<((?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+))>/gi,i)}function S(t){return t=t.replace(/~E(\d+)E/g,function(t,e){var i=parseInt(e);return String.fromCharCode(i)})}function L(t){return t=t.replace(/^(\t|[ ]{1,4})/gm,"~0"),t=t.replace(/~0/g,"")}function M(t){if(!/\t/.test(t))return t;var e,i=["    ","   ","  "," "],n=0;return t.replace(/[\n\t]/g,function(t,r){return"\n"===t?(n=r+1,t):(e=(r-n)%4,n=r+1,i[e])})}function A(t){if(!t)return"";var e=t.length;return t.replace(W,function(i,n){if("~D"==i)return"%24";if(":"==i){if(n==e-1||/[0-9\/]/.test(t.charAt(n+1)))return":";if("mailto:"===t.substring(0,"mailto:".length))return":";if("magnet:"===t.substring(0,"magnet:".length))return":"}return"%"+i.charCodeAt(0).toString(16)})}function $(t,e,i){var n="(["+e.replace(/([\[\]\\])/g,"\\$1")+"])";i&&(n="\\\\"+n);var r=new RegExp(n,"g");return t=t.replace(r,P)}function P(t,e){var i=e.charCodeAt(0);return"~E"+i+"E"}var D=this.hooks=new i;D.addNoop("plainLinkText"),D.addNoop("preConversion"),D.addNoop("postConversion");var O,E,H,z;this.makeHtml=function(i){if(O)throw new Error("Recursive call to converter.makeHtml");return O=new n,E=new n,H=[],z=0,i=D.preConversion(i),i=i.replace(/~/g,"~T"),i=i.replace(/\$/g,"~D"),i=i.replace(/\r\n/g,"\n"),i=i.replace(/\r/g,"\n"),i="\n\n"+i+"\n\n",i=M(i),i=i.replace(/^[ \t]+$/gm,""),i=e(i),i=t(i),i=o(i),i=S(i),i=i.replace(/~D/g,"$$"),i=i.replace(/~T/g,"~"),i=D.postConversion(i),H=E=O=null,i};var I={ol:"\\d+[.]",ul:"[*+-]"},W=/(?:["'*()[\]:]|~D)/g}}(),function(){function t(){}function e(t){this.buttonBar=d.getElementById("wmd-button-bar"+t),this.preview=d.getElementById("wmd-preview"+t),this.input=d.getElementById("wmd-input"+t)}function i(t,e){var i,r,o,a=this,s=[],c=0,h="none",d=function(t,e){h!=t&&(h=t,e||p()),g.isIE&&"moving"==h?o=null:r=setTimeout(u,1)},u=function(t){o=new n(e,t),r=void 0};this.setCommandMode=function(){h="command",p(),r=setTimeout(u,0)},this.canUndo=function(){return c>1},this.canRedo=function(){return s[c+1]?!0:!1},this.undo=function(){a.canUndo()&&(i?(i.restore(),i=null):(s[c]=new n(e),s[--c].restore(),t&&t())),h="none",e.input.focus(),u()},this.redo=function(){a.canRedo()&&(s[++c].restore(),t&&t()),h="none",e.input.focus(),u()};var p=function(){var r=o||new n(e);return r?"moving"==h?(i||(i=r),void 0):(i&&(s[c-1].text!=i.text&&(s[c++]=i),i=null),s[c++]=r,s[c+1]=null,t&&t(),void 0):!1},f=function(t){var e=!1;if(t.ctrlKey||t.metaKey){var i=t.charCode||t.keyCode,n=String.fromCharCode(i);switch(n){case"y":a.redo(),e=!0;break;case"z":t.shiftKey?a.redo():a.undo(),e=!0}}return e?(t.preventDefault&&t.preventDefault(),window.event&&(window.event.returnValue=!1),void 0):void 0},m=function(t){if(!t.ctrlKey&&!t.metaKey){var e=t.keyCode;e>=33&&40>=e||e>=63232&&63235>=e?d("moving"):8==e||46==e||127==e?d("deleting"):13==e?d("newlines"):27==e?d("escape"):(16>e||e>20)&&91!=e&&d("typing")}},v=function(){l.addEvent(e.input,"keypress",function(t){!t.ctrlKey&&!t.metaKey||89!=t.keyCode&&90!=t.keyCode||t.preventDefault()});var t=function(){(g.isIE||o&&o.text!=e.input.value)&&void 0==r&&(h="paste",p(),u())};l.addEvent(e.input,"keydown",f),l.addEvent(e.input,"keydown",m),l.addEvent(e.input,"mousedown",function(){d("moving")}),e.input.onpaste=t,e.input.ondrop=t},b=function(){v(),u(!0),p()};b()}function n(e,i){var n=this,r=e.input;this.init=function(){l.isVisible(r)&&(i||!d.activeElement||d.activeElement===r)&&(this.setInputAreaSelectionStartEnd(),this.scrollTop=r.scrollTop,(!this.text&&r.selectionStart||0===r.selectionStart)&&(this.text=r.value))},this.setInputAreaSelection=function(){if(l.isVisible(r))if(void 0===r.selectionStart||g.isOpera){if(d.selection){if(d.activeElement&&d.activeElement!==r)return;r.focus();var t=r.createTextRange();t.moveStart("character",-r.value.length),t.moveEnd("character",-r.value.length),t.moveEnd("character",n.end),t.moveStart("character",n.start),t.select()}}else r.focus(),r.selectionStart=n.start,r.selectionEnd=n.end,r.scrollTop=n.scrollTop},this.setInputAreaSelectionStartEnd=function(){if(e.ieCachedRange||!r.selectionStart&&0!==r.selectionStart){if(d.selection){n.text=l.fixEolChars(r.value);var t=e.ieCachedRange||d.selection.createRange(),i=l.fixEolChars(t.text),o="",a=o+i+o;t.text=a;var s=l.fixEolChars(r.value);t.moveStart("character",-a.length),t.text=i,n.start=s.indexOf(o),n.end=s.lastIndexOf(o)-o.length;var c=n.text.length-l.fixEolChars(r.value).length;if(c){for(t.moveStart("character",-i.length);c--;)i+="\n",n.end+=1;t.text=i}e.ieCachedRange&&(n.scrollTop=e.ieCachedScrollTop),e.ieCachedRange=null,this.setInputAreaSelection()}}else n.start=r.selectionStart,n.end=r.selectionEnd},this.restore=function(){void 0!=n.text&&n.text!=r.value&&(r.value=n.text),this.setInputAreaSelection(),r.scrollTop=n.scrollTop},this.getChunks=function(){var e=new t;return e.before=l.fixEolChars(n.text.substring(0,n.start)),e.startTag="",e.selection=l.fixEolChars(n.text.substring(n.start,n.end)),e.endTag="",e.after=l.fixEolChars(n.text.substring(n.end)),e.scrollTop=n.scrollTop,e},this.setChunks=function(t){t.before=t.before+t.startTag,t.after=t.endTag+t.after,this.start=t.before.length,this.end=t.before.length+t.selection.length,this.text=t.before+t.selection+t.after,this.scrollTop=t.scrollTop},this.init()}function r(t,e,i){var n,r,o,a=3e3,s="delayed",h=function(t,e){l.addEvent(t,"input",e),t.onpaste=e,t.ondrop=e,l.addEvent(t,"keypress",e),l.addEvent(t,"keydown",e)},u=function(){var t=0;return window.innerHeight?t=window.pageYOffset:d.documentElement&&d.documentElement.scrollTop?t=d.documentElement.scrollTop:d.body&&(t=d.body.scrollTop),t},p=function(){if(e.preview){var i=e.input.value;if(!i||i!=o){o=i;var n=(new Date).getTime();i=t.makeHtml(i);var a=(new Date).getTime();r=a-n,k(i)}}},f=function(){if(n&&(clearTimeout(n),n=void 0),"manual"!==s){var t=0;"delayed"===s&&(t=r),t>a&&(t=a),n=setTimeout(p,t)}},m=function(t){return t.scrollHeight<=t.clientHeight?1:t.scrollTop/(t.scrollHeight-t.clientHeight)},v=function(){e.preview&&(e.preview.scrollTop=(e.preview.scrollHeight-e.preview.clientHeight)*m(e.preview))};this.refresh=function(t){t?(o="",p()):f()},this.processingTime=function(){return r};var b,y=!0,x=function(t){var i=e.preview,n=i.parentNode,r=i.nextSibling;n.removeChild(i),i.innerHTML=t,r?n.insertBefore(i,r):n.appendChild(i)},_=function(t){e.preview.innerHTML=t},w=function(t){if(b)return b(t);try{_(t),b=_}catch(e){b=x,b(t)}},k=function(t){var n=c.getTop(e.input)-u();if(e.preview&&(w(t),i()),v(),y)return y=!1,void 0;var r=c.getTop(e.input)-u();g.isIE?setTimeout(function(){window.scrollBy(0,r-n)},0):window.scrollBy(0,r-n)},C=function(){h(e.input,f),p(),e.preview&&(e.preview.scrollTop=0)};C()}function o(t,e,i,r,o){function a(t){if(u.focus(),t.textOp){i&&i.setCommandMode();var o=new n(e);if(!o)return;var a=o.getChunks(),s=function(){u.focus(),a&&o.setChunks(a),o.restore(),r.refresh()},l=t.textOp(a,s);l||s()}t.execute&&t.execute(i)}function s(t,e){e?(t.disabled=!1,t.isHelp||(t.onclick=function(){return this.onmouseout&&this.onmouseout(),a(this),!1})):t.disabled=!0}function c(t){return"string"==typeof t&&(t=o[t]),function(){t.apply(o,arguments)}}function h(e){var i=e.buttonBar,n=document.createElement("div");n.id="wmd-button-row"+t,n.className="btn-toolbar",n=i.appendChild(n);var r=function(e,i,r){var o=document.createElement("button");return o.className="btn "+e,o.id=e+t,i&&(o.textOp=i),s(o,!0),r?r.appendChild(o):n.appendChild(o),o},o=function(e){var i=document.createElement("div");return i.className="btn-group wmd-button-group"+e,i.id="wmd-button-group"+e+t,n.appendChild(i),i};group1=o(1),p.bold=r("wmd-bold-button",c("doBold"),group1),p.italic=r("wmd-italic-button",c("doItalic"),group1),group2=o(2),p.link=r("wmd-link-button",c(function(t,e){return this.doLinkOrImage(t,e,!1)}),group2),p.code=r("wmd-code-button",c("doCode"),group2),p.quote=r("wmd-quote-button",c("doBlockquote"),group2),group3=o(3),p.olist=r("wmd-olist-button",c(function(t,e){this.doList(t,e,!0)}),group3),p.ulist=r("wmd-ulist-button",c(function(t,e){this.doList(t,e,!1)}),group3),group4=o(4),p.undo=r("wmd-undo-button",null,group4),p.undo.execute=function(t){t&&t.undo()},p.redo=r("wmd-redo-button",null,group4),p.redo.execute=function(t){t&&t.redo()},group5=o("-add-backtest"),$(e.buttonBar).find(".wmd-button-group-add-backtest").append('<div class="dropdown quanto-dropdown"><button class="dropdown-toggle btn btn-default attach-button" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"><span class="quanto-icon attachment-icon"><span class="attach-label">Attach</span></span></button><ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenu1"><li><a class="attach-backtest" href="#"></span>Backtest</a></li><li><a class="attach-notebook" href="#"></span>Notebook</a></li></ul></div>'),$(document).on("click",".attach-notebook",function(){return $(document).trigger("insert_notebook_in_reply"),!1}),$(document).on("click",".attach-backtest",function(){return $(document).trigger("insert_backtest_in_reply"),!1}),d()}function d(){i&&(s(p.undo,i.canUndo()),s(p.redo,i.canRedo()))}var u=e.input,p={};h(e);var f="keydown";g.isOpera&&(f="keypress"),l.addEvent(u,f,function(t){if((t.ctrlKey||t.metaKey)&&!t.altKey&&!t.shiftKey){var e=t.charCode||t.keyCode,i=String.fromCharCode(e).toLowerCase();switch(i){case"b":a(p.bold);break;case"i":a(p.italic);break;case"l":a(p.link);break;case"q":a(p.quote);break;case"k":a(p.code);break;case"o":a(p.olist);break;case"u":a(p.ulist);break;case"y":a(p.redo);break;case"z":t.shiftKey?a(p.redo):a(p.undo);break;default:return}t.preventDefault&&t.preventDefault(),window.event&&(window.event.returnValue=!1)}}),l.addEvent(u,"keyup",function(t){if(t.shiftKey&&!t.ctrlKey&&!t.metaKey){var e=t.charCode||t.keyCode;if(13===e){var i={};i.textOp=c("doAutoindent"),a(i)}}}),g.isIE&&l.addEvent(u,"keydown",function(t){var e=t.keyCode;return 27===e?!1:void 0}),this.setUndoRedoButtonStates=d}function a(t){this.hooks=t}function s(t){return t.replace(/^\s*(.*?)(?:\s+"(.+)")?\s*$/,function(t,e,i){return e=e.replace(/\?.*$/,function(t){return t.replace(/\+/g," ")}),e=decodeURIComponent(e),e=encodeURI(e).replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29"),e=e.replace(/\?.*$/,function(t){return t.replace(/\+/g,"%2b")}),i&&(i=i.trim?i.trim():i.replace(/^\s*/,"").replace(/\s*$/,""),i=$.trim(i).replace(/"/g,"quot;").replace(/\(/g,"&#40;").replace(/\)/g,"&#41;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),i?e+' "'+i+'"':e})}var l={},c={},h={},d=window.document,u=window.RegExp,p=window.navigator,f={lineLength:72},g={isIE:/msie/.test(p.userAgent.toLowerCase()),isIE_5or6:/msie 6/.test(p.userAgent.toLowerCase())||/msie 5/.test(p.userAgent.toLowerCase()),isOpera:/opera/.test(p.userAgent.toLowerCase())},m="",v='<p>http://example.com/images/diagram.jpg "optional title"</p>',b="http://",y="http://";Markdown.Editor=function(t,n,s){n=n||"";var l=this.hooks=new Markdown.HookCollection;l.addNoop("onPreviewRefresh"),l.addNoop("postBlockquoteCreation"),l.addFalse("insertImageDialog"),this.getConverter=function(){return t};var c,h=this;this.run=function(){if(!c){c=new e(n);var u,p,f=new a(l),g=new r(t,c,function(){l.onPreviewRefresh()});/\?noundo/.test(d.location.href)||(u=new i(function(){g.refresh(),p&&p.setUndoRedoButtonStates()},c),this.textOperation=function(t){u.setCommandMode(),t(),h.refreshPreview()}),p=new o(n,c,u,g,f,s),p.setUndoRedoButtonStates();var m=h.refreshPreview=function(){g.refresh(!0)};m()}}},t.prototype.findTags=function(t,e){var i,n=this;t&&(i=l.extendRegExp(t,"","$"),this.before=this.before.replace(i,function(t){return n.startTag=n.startTag+t,""}),i=l.extendRegExp(t,"^",""),this.selection=this.selection.replace(i,function(t){return n.startTag=n.startTag+t,""})),e&&(i=l.extendRegExp(e,"","$"),this.selection=this.selection.replace(i,function(t){return n.endTag=t+n.endTag,""}),i=l.extendRegExp(e,"^",""),this.after=this.after.replace(i,function(t){return n.endTag=t+n.endTag,""}))},t.prototype.trimWhitespace=function(t){var e,i,n=this;t?e=i="":(e=function(t){return n.before+=t,""},i=function(t){return n.after=t+n.after,""}),this.selection=this.selection.replace(/^(\s*)/,e).replace(/(\s*)$/,i)},t.prototype.skipLines=function(t,e,i){void 0===t&&(t=1),void 0===e&&(e=1),t++,e++;var n,r;if(navigator.userAgent.match(/Chrome/)&&"X".match(/()./),this.selection=this.selection.replace(/(^\n*)/,""),this.startTag=this.startTag+u.$1,this.selection=this.selection.replace(/(\n*$)/,""),this.endTag=this.endTag+u.$1,this.startTag=this.startTag.replace(/(^\n*)/,""),this.before=this.before+u.$1,this.endTag=this.endTag.replace(/(\n*$)/,""),this.after=this.after+u.$1,this.before){for(n=r="";t--;)n+="\\n?",r+="\n";i&&(n="\\n*"),this.before=this.before.replace(new u(n+"$",""),r)}if(this.after){for(n=r="";e--;)n+="\\n?",r+="\n";i&&(n="\\n*"),this.after=this.after.replace(new u(n,""),r)}},l.isVisible=function(t){return window.getComputedStyle?"none"!==window.getComputedStyle(t,null).getPropertyValue("display"):t.currentStyle?"none"!==t.currentStyle.display:void 0},l.addEvent=function(t,e,i){t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener(e,i,!1)},l.removeEvent=function(t,e,i){t.detachEvent?t.detachEvent("on"+e,i):t.removeEventListener(e,i,!1)},l.fixEolChars=function(t){return t=t.replace(/\r\n/g,"\n"),t=t.replace(/\r/g,"\n")},l.extendRegExp=function(t,e,i){(null===e||void 0===e)&&(e=""),(null===i||void 0===i)&&(i="");var n,r=t.toString();return r=r.replace(/\/([gim]*)$/,function(t,e){return n=e,""}),r=r.replace(/(^\/|\/$)/g,""),r=e+r+i,new u(r,n)},c.getTop=function(t,e){var i=t.offsetTop;if(!e)for(;t=t.offsetParent;)i+=t.offsetTop;return i},c.getHeight=function(t){return t.offsetHeight||t.scrollHeight},c.getWidth=function(t){return t.offsetWidth||t.scrollWidth},c.getPageSize=function(){var t,e,i,n;self.innerHeight&&self.scrollMaxY?(t=d.body.scrollWidth,e=self.innerHeight+self.scrollMaxY):d.body.scrollHeight>d.body.offsetHeight?(t=d.body.scrollWidth,e=d.body.scrollHeight):(t=d.body.offsetWidth,e=d.body.offsetHeight),self.innerHeight?(i=self.innerWidth,n=self.innerHeight):d.documentElement&&d.documentElement.clientHeight?(i=d.documentElement.clientWidth,n=d.documentElement.clientHeight):d.body&&(i=d.body.clientWidth,n=d.body.clientHeight);var r=Math.max(t,i),o=Math.max(e,n);return[r,o,i,n]},h.prompt=function(t,e,i,n){var r,o;void 0===i&&(i="");var a=function(t){var e=t.charCode||t.keyCode;27===e&&s(!0)},s=function(t){l.removeEvent(d.body,"keydown",a);var e=o.value;return t?e=null:(e=e.replace(/^http:\/\/(https?|ftp):\/\//,"$1://"),/^(?:https?|ftp):\/\//.test(e)||(e="http://"+e)),$(r).modal("hide"),n(e),!1},c=function(){r=d.createElement("div"),r.className="fade modal linkmodal quanto-modal",dialog_container=d.createElement("div"),dialog_container.className="modal-dialog",r.appendChild(dialog_container),content_container=d.createElement("div"),content_container.className="modal-content",dialog_container.appendChild(content_container);var e=d.createElement("div");e.className="modal-header",e.innerHTML='<a class="close" data-dismiss="modal">Ã—</a>'+t,content_container.appendChild(e);var n=d.createElement("div");n.className="modal-body",content_container.appendChild(n);var c=d.createElement("form"),h=c.style;c.className="quanto-form",c.onsubmit=function(){return s(!1)},h.padding="0",h.margin="0",n.appendChild(c);var u=d.createElement("div");u.className="form-group",c.appendChild(u),o=d.createElement("input"),o.className=o.type="text",o.value=i,h=o.style,h.display="block",u.appendChild(o);var p=d.createElement("button");p.className="btn new-btn blue",p.type="button",p.onclick=function(){return s(!1)},p.innerHTML="Insert",u.appendChild(p),l.addEvent(d.body,"keydown",a),d.body.appendChild(r)};setTimeout(function(){c();var t=i.length;if(void 0!==o.selectionStart)o.selectionStart=0,o.selectionEnd=t;else if(o.createTextRange){var e=o.createTextRange();e.collapse(!1),e.moveStart("character",-t),e.moveEnd("character",t),e.select()}$(r).on("shown",function(){o.focus()}),$(r).on("hidden",function(){r.parentNode.removeChild(r)}),$(r).modal("show")},0)};var x=a.prototype;x.prefixes="(?:\\s{4,}|\\s*>|\\s*-\\s+|\\s*\\d+\\.|=|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)",x.unwrap=function(t){var e=new u("([^\\n])\\n(?!(\\n|"+this.prefixes+"))","g");t.selection=t.selection.replace(e,"$1 $2")},x.wrap=function(t,e){this.unwrap(t);var i=new u("(.{1,"+e+"})( +|$\\n?)","gm"),n=this;t.selection=t.selection.replace(i,function(t,e){return new u("^"+n.prefixes,"").test(t)?t:e+"\n"}),t.selection=t.selection.replace(/\s+$/,"")},x.doBold=function(t,e){return this.doBorI(t,e,2,"strong text")},x.doItalic=function(t,e){return this.doBorI(t,e,1,"emphasized text")},x.doBorI=function(t,e,i,n){t.trimWhitespace(),t.selection=t.selection.replace(/\n{2,}/g,"\n");var r=/(\**$)/.exec(t.before)[0],o=/(^\**)/.exec(t.after)[0],a=Math.min(r.length,o.length);if(a>=i&&(2!=a||1!=i))t.before=t.before.replace(u("[*]{"+i+"}$",""),""),t.after=t.after.replace(u("^[*]{"+i+"}",""),"");else if(!t.selection&&o){t.after=t.after.replace(/^([*_]*)/,""),t.before=t.before.replace(/(\s?)$/,"");var s=u.$1;t.before=t.before+o+s}else{t.selection||o||(t.selection=n);var l=1>=i?"*":"**";t.before=t.before+l,t.after=l+t.after}},x.stripLinkDefs=function(t,e){return t=t.replace(/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(t,i,n,r,o){return e[i]=t.replace(/\s*$/,""),r?(e[i]=t.replace(/["(](.+?)[")]$/,""),r+o):""})},x.addLinkDef=function(t,e){var i=0,n={};t.before=this.stripLinkDefs(t.before,n),t.selection=this.stripLinkDefs(t.selection,n),t.after=this.stripLinkDefs(t.after,n);var r="",o=/(\[)((?:\[[^\]]*\]|[^\[\]])*)(\][ ]?(?:\n[ ]*)?\[)(\d+)(\])/g,a=function(t){i++,t=t.replace(/^[ ]{0,3}\[(\d+)\]:/,"  ["+i+"]:"),r+="\n"+t},s=function(t,e,r,l,c,h){return r=r.replace(o,s),n[c]?(a(n[c]),e+r+l+i+h):t};t.before=t.before.replace(o,s),e?a(e):t.selection=t.selection.replace(o,s);var l=i;return t.after=t.after.replace(o,s),t.after&&(t.after=t.after.replace(/\n*$/,"")),t.after||(t.selection=t.selection.replace(/\n*$/,"")),t.after+="\n\n"+r,l},x.doLinkOrImage=function(t,e,i){if(t.trimWhitespace(),t.findTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/),!(t.endTag.length>1&&t.startTag.length>0)){if(t.selection=t.startTag+t.selection+t.endTag,t.startTag=t.endTag="",/\n\n/.test(t.selection))return this.addLinkDef(t,null),void 0;var n=this,r=function(r){if(null!==r){t.selection=(" "+t.selection).replace(/([^\\](?:\\\\)*)(?=[[\]])/g,"$1\\").substr(1);var o=" [999]: "+s(r),a=n.addLinkDef(t,o);t.startTag=i?"![":"[",t.endTag="]["+a+"]",t.selection||(t.selection=i?"enter image description here":"enter link description here")}e()};return i?this.hooks.insertImageDialog(r)||h.prompt("Insert Image",v,b,r):h.prompt("Insert Link",m,y,r),!0}t.startTag=t.startTag.replace(/!?\[/,""),t.endTag="",this.addLinkDef(t,null)},x.doAutoindent=function(t){var e=this,i=!1;t.before=t.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n"),t.before=t.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,"\n\n"),t.before=t.before.replace(/(\n|^)[ \t]+\n$/,"\n\n"),t.selection||/^[ \t]*(?:\n|$)/.test(t.after)||(t.after=t.after.replace(/^[^\n]*/,function(e){return t.selection=e,""}),i=!0),/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]+.*\n$/.test(t.before)&&e.doList&&e.doList(t),/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(t.before)&&e.doBlockquote&&e.doBlockquote(t),/(\n|^)(\t|[ ]{4,}).*\n$/.test(t.before)&&e.doCode&&e.doCode(t),i&&(t.after=t.selection+t.after,t.selection="")},x.doBlockquote=function(t){t.selection=t.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,function(e,i,n,r){return t.before+=i,t.after=r+t.after,n}),t.before=t.before.replace(/(>[ \t]*)$/,function(e,i){return t.selection=i+t.selection,""}),t.selection=t.selection.replace(/^(\s|>)+$/,""),t.selection=t.selection||"Blockquote";var e,i="",n="";if(t.before){for(var r=t.before.replace(/\n$/,"").split("\n"),o=!1,a=0;a<r.length;a++){var s=!1;e=r[a],o=o&&e.length>0,/^>/.test(e)?(s=!0,!o&&e.length>1&&(o=!0)):s=/^[ \t]*$/.test(e)?!0:o,s?i+=e+"\n":(n+=i+e,i="\n")}/(^|\n)>/.test(i)||(n+=i,i="")}t.startTag=i,t.before=n,t.after&&(t.after=t.after.replace(/^\n?/,"\n")),t.after=t.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/,function(e){return t.endTag=e,""});var l=function(e){var i=e?"> ":"";t.startTag&&(t.startTag=t.startTag.replace(/\n((>|\s)*)\n$/,function(t,e){return"\n"+e.replace(/^[ ]{0,3}>?[ \t]*$/gm,i)+"\n"})),t.endTag&&(t.endTag=t.endTag.replace(/^\n((>|\s)*)\n/,function(t,e){return"\n"+e.replace(/^[ ]{0,3}>?[ \t]*$/gm,i)+"\n"}))};/^(?![ ]{0,3}>)/m.test(t.selection)?(this.wrap(t,f.lineLength-2),t.selection=t.selection.replace(/^/gm,"> "),l(!0),t.skipLines()):(t.selection=t.selection.replace(/^[ ]{0,3}> ?/gm,""),this.unwrap(t),l(!1),!/^(\n|^)[ ]{0,3}>/.test(t.selection)&&t.startTag&&(t.startTag=t.startTag.replace(/\n{0,2}$/,"\n\n")),!/(\n|^)[ ]{0,3}>.*$/.test(t.selection)&&t.endTag&&(t.endTag=t.endTag.replace(/^\n{0,2}/,"\n\n"))),t.selection=this.hooks.postBlockquoteCreation(t.selection),/\n/.test(t.selection)||(t.selection=t.selection.replace(/^(> *)/,function(e,i){return t.startTag+=i,""}))},x.doCode=function(t){/\S[ ]*$/.test(t.before),/^[ ]*\S/.test(t.after),_.str.endsWith(t.before,"```\n")||(t.before+="```\n"),0!=t.after.indexOf("\n```")&&(t.after="\n```"+t.after)},x.doList=function(t,e,i){var n=/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/,r=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/,o="-",a=1,s=function(){var t;return i?(t=" "+a+". ",a++):t=" "+o+" ",t},l=function(t){return void 0===i&&(i=/^\s*\d/.test(t)),t=t.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(){return s()})};if(t.findTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,null),!t.before||/\n$/.test(t.before)||/^\n/.test(t.startTag)||(t.before+=t.startTag,t.startTag=""),t.startTag){var c=/\d+[.]/.test(t.startTag);if(t.startTag="",t.selection=t.selection.replace(/\n[ ]{4}/g,"\n"),this.unwrap(t),t.skipLines(),c&&(t.after=t.after.replace(r,l)),i==c)return}var h=1;t.before=t.before.replace(n,function(t){return/^\s*([*+-])/.test(t)&&(o=u.$1),h=/[^\n]\n\n[^\n]/.test(t)?1:0,l(t)});var d=s(),p=1;t.after=t.after.replace(r,function(t){return p=/[^\n]\n\n[^\n]/.test(t)?1:0,l(t)}),t.trimWhitespace(!0),t.skipLines(h,p,!0),t.startTag=d;var g=d.replace(/./g," ");this.wrap(t,f.lineLength-g.length),t.selection=t.selection.replace(/\n/g,"\n"+g)},x.doHeading=function(t){if(t.selection=t.selection.replace(/\s+/g," "),t.selection=t.selection.replace(/(^\s+|\s+$)/g,""),!t.selection)return t.startTag="## ",t.selection="Heading",t.endTag=" ##",void 0;var e=0;t.findTags(/#+[ ]*/,/[ ]*#+/),/#+/.test(t.startTag)&&(e=u.lastMatch.length),t.startTag=t.endTag="",t.findTags(null,/\s?(-+|=+)/),/=+/.test(t.endTag)&&(e=1),/-+/.test(t.endTag)&&(e=2),t.startTag=t.endTag="",t.skipLines(1,1);var i=0==e?2:e-1;if(i>0){var n=i>=2?"-":"=",r=t.selection.length;for(r>f.lineLength&&(r=f.lineLength),t.endTag="\n";r--;)t.endTag+=n}},x.doHorizontalRule=function(t){t.startTag="----------\n",t.selection="",t.skipLines(2,1,!0)}}(),function(){function t(t){return t.replace(/<[^>]*>?/gi,e)}function e(t){return t.match(o)||t.match(a)||t.match(s)||t.match(l)?t:"<div class='backtest-marker'>"==t?(window.match_start=!0,t):"undefined"!=typeof window.match_start&&window.match_start&&"</div>"==t?(this.match_start=!1,t):""}function i(t){if(""==t)return"";var e=/<\/?\w+[^>]*(\s|$|>)/g,i=t.toLowerCase().match(e),n=(i||[]).length;if(0==n)return t;for(var r,o,a,s="<p><img><br><li><hr>",l=[],c=[],h=!1,d=0;n>d;d++)if(r=i[d].replace(/<\/?(\w+).*/,"$1"),!(l[d]||s.search("<"+r+">")>-1)){if(o=i[d],a=-1,!/^<\//.test(o))for(var u=d+1;n>u;u++)if(!l[u]&&i[u]=="</"+r+">"){a=u;break}-1==a?h=c[d]=!0:l[a]=!0}if(!h)return t;var d=0;return t=t.replace(e,function(t){var e=c[d]?"":t;return d++,e})}var n,r;"object"==typeof exports&&"function"==typeof require?(n=exports,r=require("./Markdown.Converter").Converter):(n=window.Markdown,r=n.Converter),n.getSanitizingConverter=function(){var e=new r;return e.hooks.chain("postConversion",t),e.hooks.chain("postConversion",i),e};var o=/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i,a=/^(<a\shref="(https?:(\/\/|\/)|ftp:(\/\/|\/)|mailto:|magnet:)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i,s=/^(<img\ssrc="(https?:\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i,l=/^(<pre(\sclass="prettyprint linenums")?>|<\/pre>)$/i}(),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};quanto.PostManagerBase=t=function(){function t(){this.get_validation_tooltip_text=e(this.get_validation_tooltip_text,this),this.get_preview_link_text=e(this.get_preview_link_text,this),this.reset_path=e(this.reset_path,this),this.remove_attachment=e(this.remove_attachment,this),this.add_attached_backtest=e(this.add_attached_backtest,this),this.preview_post=e(this.preview_post,this),this.receive_iframe_message=e(this.receive_iframe_message,this),this.before_submit=e(this.before_submit,this),this.enable_controls=e(this.enable_controls,this),this.disable_controls=e(this.disable_controls,this),this.add_attached_notebook=e(this.add_attached_notebook,this),this.initialize_attachments=e(this.initialize_attachments,this),this.validate=e(this.validate,this),this.initialize_validation=e(this.initialize_validation,this),this.use_title=$("#titlebox").length>0,this.submit_text="Submit Post",this.submitting_text="Submitting...",this.initialize_attachments(),window.addEventListener("message",this.receive_iframe_message,!1),this.$preview_reply_link=$(".preview-reply-link"),quanto.on_click(".preview-reply-link",function(t){return function(){return t.preview_post()}}(this)),this.$preview_link=$(".preview-post-link"),this.initialize_validation()
}return t.prototype.initialize_validation=function(){return this.$submit_button=$("#reply-button"),this.tooltip_data={title:this.get_validation_tooltip_text(),placement:"left"},$("#wmd-input").bind("input change",this.validate),$("#titlebox").bind("input change",this.validate),this.$submit_button.hasClass("disabled")&&(this.$submit_button.tooltip(this.tooltip_data),this.$preview_link.tooltip(this.tooltip_data)),this.validate()},t.prototype.validate=function(){var t,e;return e=_.str.trim($("#titlebox").val()),t=_.str.trim($("#wmd-input").val()),this.use_title&&0===e.length||0===t.length?this.$submit_button.hasClass("disabled")?void 0:(this.$submit_button.tooltip(this.tooltip_data),this.$preview_link.tooltip(this.tooltip_data),this.$submit_button.addClass("disabled"),this.$preview_link.addClass("disabled")):(this.$submit_button.tooltip("destroy"),this.$submit_button.removeClass("disabled"),this.$preview_link.tooltip("destroy"),this.$preview_link.removeClass("disabled"))},t.prototype.initialize_attachments=function(){var t,e,i,n;return quanto.instances.attach_backtest_manager=new quanto.AttachBacktestModalManager,quanto.instances.attach_notebook_manager=new quanto.AttachNotebookModalManager,$(document).bind("insert_backtest_in_reply",function(){return function(){return quanto.instances.attach_backtest_manager.show_modal()}}(this)),$(document).bind("insert_notebook_in_reply",function(){return function(){return quanto.instances.attach_notebook_manager.show_modal()}}(this)),this.attached_backtest_id=null,this.attached_backtest_template=Handlebars.compile("<div class='attachment-container'> <span class='attachment-label backtest-label'> <strong>{{backtest_name}}</strong> of <strong>{{algo_name}}</strong> </span> <span class='remove-attachment-link'> </div>"),this.attached_notebook_template=Handlebars.compile("<div class='attachment-container'> <span class='attachment-label'> <strong>{{notebook_name}}</strong> </span> <span class='remove-attachment-link'> </div>"),$(document).bind("attach_backtest",function(t){return function(e,i){var n,r;return n=i.algo,r=i.backtest,t.add_attached_backtest(r.id,r.title,n.title,r.q2_equivalent_bt),$("#backtest-id").val(r.id)}}(this)),$(document).bind("attach_notebook",function(t){return function(e,i){return t.research_host_url=i.research_host_url,t.attached_notebook=i.notebook,t.add_attached_notebook(t.attached_notebook.name)}}(this)),$(document).on("click",".remove-attachment-link",this.remove_attachment),$("#backtest-id").length>0&&""!==$("#backtest-id").val()&&(this.sharing_backtest=!0,e=$("#backtest-id").val(),t=$("#algorithm-title").val(),i="Backtest "+$("#backtest-title").val(),this.add_attached_backtest(e,i,t)),$("#nb-preview-data").length>0?(this.existing_notebook=$("#nb-preview-data").data(),n=this.existing_notebook.notebook_path.split("/"),this.add_attached_notebook(n[n.length-1])):void 0},t.prototype.add_attached_notebook=function(t){return $(".attach-button").addClass("hidden"),$(".wmd-button-group-add-backtest").append(this.attached_notebook_template({notebook_name:quanto.escapeHTML(t)})),$("#wmd-button-group-add-backtest").find(".quanto-dropdown").hide()},t.prototype.disable_controls=function(){return this.$text_editor.attr("disabled","disabled").addClass("disabled"),this.$submit_button.attr("disabled","disabled").addClass("disabled").html(this.submitting_text)},t.prototype.enable_controls=function(){return this.$text_editor.attr("disabled",!1).removeClass("disabled"),this.$submit_button.attr("disabled",!1).removeClass("disabled").html(this.submit_text)},t.prototype.before_submit=function(){var t;return null==this.attached_notebook&&!this.shared_from_notebook||null==this.research_host_url?(null!=this.existing_notebook?this.post_data.keep_existing_nb=!0:null!=this.attached_backtest_id&&(this.post_data.backtest_id=this.attached_backtest_id),this.finish_submit()):(t={event:"attach_notebook"},$("#notebook-list-iframe")[0].contentWindow.postMessage(t,this.research_host_url),this.cur_timeout_id=setTimeout(function(t){return function(){return t.enable_controls(),quanto.show_error_popup("Error","There was a problem attaching your notebook to this post.  Try again or contact us by <a href='#' class='open-feedback-link'>sending feedback</a>."),t.cur_timeout_id=null}}(this),6e4))},t.prototype.receive_iframe_message=function(t){if(null!=this.cur_timeout_id&&t.origin===this.research_host_url&&null!=t.data){if(clearTimeout(this.cur_timeout_id),this.cur_timeout_id=null,"attach_notebook_succeeded"===t.data.event)return this.post_data.nb_id=t.data.upload_id,this.post_data.nb_path=t.data.nb_path,this.finish_submit();"attach_notebook_failed"===t.data.event&&(this.enable_controls(),quanto.show_error_popup("Error","There was a problem attaching your notebook to this post.  Try again or contact us by <a href='#' class='open-feedback-link'>sending feedback</a>."))}},t.prototype.preview_post=function(){var t,e,i;if(!this.$preview_reply_link.hasClass("disabled")){if(i=_.str.trim($("#titlebox").val()),t=_.str.trim($("#wmd-input").val()),this.use_title&&0===i.length||0===t.length)return quanto.show_error_popup("Error","Enter a body for this post."),void 0;if(!this.$preview_reply_link.hasClass("disabled"))return this.$preview_reply_link.html("Generating...").addClass("disabled"),e={markdown:t,backtest_id:this.attached_backtest_id},$.post("/posts/generate_preview",e,function(t){return function(e){var n,r,o,a,s,l,c;return l=new quanto.JsonResponse(e),l.ok()?(t.$preview_reply_link.html(t.get_preview_link_text()).removeClass("disabled"),n=$("#preview_reply_modal .preview-data"),s=l.data().html,n.html(s),r=$("#preview_reply_modal .preview-title"),t.use_title?(r.removeClass("hidden"),i=quanto.escapeHTML($("#titlebox").val()),0===$.trim(i).length&&(i="(no title)"),$("#preview_reply_modal .preview-title").html(i)):r.addClass("hidden"),n.find("code").addClass("prettyprint"),window.prettyPrint(),$("#preview_reply_modal").modal("show"),a=l.data().backtest_html,null!=a&&(n.append(a),o=n.find(".backtest-widget"),setTimeout(function(){var e;return e=new quanto.BacktestSummaryManager(o,t.attached_backtest_id,t.attached_backtest_migrated_id)},10)),null!=(c=quanto.chart)?c.setSize(850,300):void 0):void 0}}(this))}},t.prototype.add_attached_backtest=function(t,e,i,n){return null==n&&(n=null),this.attached_backtest_id=t,this.attached_backtest_migrated_id=n,$(".attach-button").addClass("hidden"),$(".wmd-button-group-add-backtest").append(this.attached_backtest_template({backtest_name:e,algo_name:quanto.escapeHTML(i)})),$("#wmd-button-group-add-backtest").find(".quanto-dropdown").hide()},t.prototype.remove_attachment=function(){return this.attached_notebook=null,this.existing_notebook=null,this.attached_backtest_id=null,this.attached_backtest_migrated_id=null,this.sharing_backtest=!1,$(".attachment-container").remove(),$(".attach-button").removeClass("hidden"),$("#backtest-id").val(""),$("#wmd-button-group-add-backtest").find(".quanto-dropdown").show()},t.prototype.reset_path=function(){return window.history.pushState({},"","/posts/new")},t.prototype.get_preview_link_text=function(){return"Preview Post"},t.prototype.get_validation_tooltip_text=function(){return"Enter a title and body for this post"},t}()}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};quanto.AttachBacktestModalManager=t=function(){function t(){this.select_backtest=e(this.select_backtest,this),this.handle_backtest_clicked=e(this.handle_backtest_clicked,this),this.handle_algo_clicked=e(this.handle_algo_clicked,this),this.select_algo=e(this.select_algo,this),this.render_ui=e(this.render_ui,this),this.load_data=e(this.load_data,this),this.reset_backtest_dropdown_label=e(this.reset_backtest_dropdown_label,this),this.reset_ui=e(this.reset_ui,this),this.show_modal=e(this.show_modal,this),this.algo_list=[],this.algo_cache={},this.backtest_cache={},this.selected_algo=null,this.selected_backtest=null,this.$modal=$("#attach-backtest-modal"),$("#attach-backtest-modal").on("click",".select-algo .dropdown-menu",this.handle_algo_clicked),$("#attach-backtest-modal").on("click",".select-backtest .dropdown-menu",this.handle_backtest_clicked),$("#attach-backtest-button").on("click",function(t){return function(){return $(document).trigger("attach_backtest",[{algo:t.selected_algo,backtest:t.selected_backtest}]),t.$modal.modal("hide")}}(this))}return t.prototype.show_modal=function(){return $("#attach-backtest-modal").modal("show"),this.reset_ui(),this.load_data()},t.prototype.reset_ui=function(){return this.$modal.find(".loading").removeClass("hidden"),this.$modal.find(".no-algos").addClass("hidden"),this.$modal.find(".select-algo").addClass("hidden"),this.$modal.find(".select-backtest").addClass("hidden").addClass("disabled"),this.$modal.find(".dropdown-menu").html(""),this.$modal.find(".select-algo .dropdown-label").addClass("empty").removeClass("bold").html("(Select an algorithm)"),this.reset_backtest_dropdown_label(),$("#attach-backtest-button").addClass("disabled"),this.algo_list=[],this.algo_cache={},this.backtest_cache={}},t.prototype.reset_backtest_dropdown_label=function(){return this.$modal.find(".select-backtest .dropdown-label").addClass("empty").removeClass("bold").html("(Select a backtest)")},t.prototype.load_data=function(){return $.get("/algorithms/get_attachment_info",{},function(t){return function(e){var i,n,r,o,a,s,l,c,h;if(o=new quanto.JsonResponse(e),o.ok()){for(r=o.data(),a=0,l=r.length;l>a;a++)if(i=r[a],t.algo_list.push(i),t.algo_cache[i.id]=i,null!=i.backtests)for(h=i.backtests,s=0,c=h.length;c>s;s++)n=h[s],t.backtest_cache[n.id]=n;return t.render_ui()}}}(this))},t.prototype.render_ui=function(){var t,e,i,n,r;if(this.$modal.find(".loading").addClass("hidden"),0===this.algo_list.length)return this.$modal.find(".no-algos").show();for(this.$modal.find(".select-algo").show(),this.$modal.find(".select-backtest").show(),t=this.$modal.find(".select-algo .dropdown-menu"),this.algo_list=_.sortBy(this.algo_list,function(){return function(t){return t.updated_at}}(this)),r=this.algo_list.reverse(),i=0,n=r.length;n>i;i++)e=r[i],t.append("<li><a data-algo-id='"+e.id+"'>"+quanto.escapeHTML(e.title)+"</a></li>");return this.$modal.find(".select-algo").removeClass("hidden"),1===this.algo_cache.length?this.select_algo(this.algo_cache[0].id):void 0},t.prototype.select_algo=function(t){var e,i,n,r,o,a;if(i=this.algo_cache[t],this.selected_algo=i,this.$modal.find(".select-backtest").removeClass("hidden"),this.$modal.find(".select-algo .dropdown-label").html(quanto.escapeHTML(i.title)).removeClass("empty"),0===i.backtests.length)this.$modal.find(".select-backtest .dropdown-toggle").addClass("disabled"),this.$modal.find(".select-backtest .dropdown-toggle .dropdown-label").html("No backtests for this algorithm.");else{for(this.$modal.find(".select-backtest .dropdown-toggle").removeClass("disabled"),e=this.$modal.find(".select-backtest .dropdown-menu"),e.html(""),a=i.backtests.reverse(),r=0,o=a.length;o>r;r++)n=a[r],e.append("<li><a data-backtest-id='"+n.id+"'>"+n.title+"</a><li>");this.$modal.find(".select-backtest").removeClass("disabled"),this.reset_backtest_dropdown_label(),quanto.date.render_all_date_values()}return $("#attach-backtest-button").addClass("disabled"),1===i.backtests.length?this.select_backtest(i.backtests[0].id):void 0},t.prototype.handle_algo_clicked=function(t){var e,i;return e=$(quanto.get_src_element(t)).closest("a"),i=e.data("algo-id"),null!=i?this.select_algo(i):void 0},t.prototype.handle_backtest_clicked=function(t){var e,i;return e=$(quanto.get_src_element(t)).closest("a"),i=e.data("backtest-id"),null!=i?this.select_backtest(i):void 0},t.prototype.select_backtest=function(t){var e;return e=this.backtest_cache[t],this.selected_backtest=e,this.$modal.find(".select-backtest .dropdown-label").html(e.title).removeClass("empty"),$("#attach-backtest-button").removeClass("disabled"),quanto.date.render_all_date_values()},t}()}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};quanto.AttachNotebookModalManager=t=function(){function t(){this.receive_iframe_message=e(this.receive_iframe_message,this),this.show_select_cell_step=e(this.show_select_cell_step,this),this.handle_iframe_loaded=e(this.handle_iframe_loaded,this),this.navigate_iframe=e(this.navigate_iframe,this),this.open_folder=e(this.open_folder,this),this.handle_attach_notebook_clicked=e(this.handle_attach_notebook_clicked,this),this.reset_attach_button=e(this.reset_attach_button,this),this.initialize_modal=e(this.initialize_modal,this),this.show_modal=e(this.show_modal,this),this.$modal=$("#attach-notebook-modal"),this.$attach_notebook_btn=$("#attach-notebook-button"),this.$progress_area=this.$modal.find(".progress-area"),this.$notebook_iframe=$("#notebook-list-iframe"),this.$notebook_name=this.$modal.find(".nb-name"),this.$attach_notebook_btn.on("click",this.handle_attach_notebook_clicked),this.$notebook_iframe.load(this.handle_iframe_loaded),window.addEventListener("message",this.receive_iframe_message,!1),$("#show-attach-nb").length>0&&($("#attach-notebook-modal").removeClass("fade"),this.show_modal(),$("#attach-notebook-modal").addClass("fade"))}return t.prototype.show_modal=function(){var t,e;return e={path:window.location.pathname,body:_.str.trim($("#wmd-input").val())},t=$("#titlebox"),t.length>0&&(e.title=_.str.trim(t.val())),null==this.notebook_host_url?$.post("/research/host_url",e,function(t){return function(e){return"ok"===e.status?(t.notebook_host_url=e.notebook_url,t.research_host_url=e.research_url,t.initialize_modal()):"redirect"===e.status?window.location.href=e.to:t.$modal.addClass("maintenance-step")}}(this)).fail(function(t){return function(){return t.$modal.addClass("maintenance-step")}}(this)):this.initialize_modal(),this.$modal.modal("show")},t.prototype.initialize_modal=function(){return this.reset_attach_button(),this.$modal.removeClass("select-cell maintenance-step error-step"),this.navigate_iframe(this.notebook_host_url+"/notebook_finder","Loading notebooks...")},t.prototype.reset_attach_button=function(){return this.$attach_notebook_btn.text("Next"),this.$attach_notebook_btn.addClass("disabled")},t.prototype.handle_attach_notebook_clicked=function(){var t;switch(t=this.$attach_notebook_btn.text()){case"Open":return this.open_folder(this.selected_row.url);case"Next":return this.show_select_cell_step(this.selected_row.url);case"Attach":return $(document).trigger("attach_notebook",{research_host_url:this.research_host_url,notebook:this.selected_row}),this.$modal.modal("hide")}},t.prototype.open_folder=function(t){return this.$attach_notebook_btn.text("Opening..."),this.$attach_notebook_btn.addClass("disabled"),this.navigate_iframe(this.research_host_url+t,"Loading folder...",function(t){return function(){return t.$attach_notebook_btn.text("Next")}}(this))},t.prototype.navigate_iframe=function(t,e,i){return null!=t&&(null!=this.cur_timeout_id&&(clearTimeout(this.cur_timeout_id),this.cur_timeout_id=null),this.$notebook_iframe.attr("src",t)),this.$notebook_iframe.removeClass("in"),this.$progress_area.find(".progress-title span").text(e),this.$progress_area.addClass("in"),this.after_navigate=i},t.prototype.handle_iframe_loaded=function(){return this.cur_timeout_id=setTimeout(function(t){return function(){return t.$notebook_iframe.hasClass("in")?void 0:(t.$progress_area.removeClass("in"),t.$modal.addClass("error-step"))}}(this),1e4)},t.prototype.show_select_cell_step=function(t){return this.$attach_notebook_btn.addClass("disabled"),this.navigate_iframe(this.research_host_url+t,"Loading notebook...",function(t){return function(){return t.$modal.addClass("select-cell"),t.$attach_notebook_btn.text("Attach"),t.$attach_notebook_btn.removeClass("disabled")}}(this))},t.prototype.receive_iframe_message=function(t){var e;if(t.origin===this.research_host_url&&null!=t.data){if("selection_changed"===t.data.event)return this.selected_row=t.data.selected_row,"notebook"===this.selected_row.type?(this.$notebook_name.text(this.selected_row.name),this.$attach_notebook_btn.text("Next"),this.$attach_notebook_btn.removeClass("disabled")):"directory"===this.selected_row.type?(this.$attach_notebook_btn.text("Open"),this.$attach_notebook_btn.removeClass("disabled")):this.reset_attach_button();if("row_dbl_clicked"===t.data.event)switch(e=t.data.clicked_row,e.type){case"notebook":return this.show_select_cell_step(e.url);case"directory":return this.open_folder(e.url)}else if(("list_loaded"===t.data.event||"notebook_loaded"===t.data.event)&&(this.$notebook_iframe.addClass("in"),this.$progress_area.removeClass("in"),null!=this.after_navigate))return this.after_navigate()}},t}()}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};quanto.BacktestSummaryManager=t=function(){function t(t,i,n){var r,o,a,s,l,c,h,d,u;null==n&&(n=null),this.initialize_chart=e(this.initialize_chart,this),this.add_custom_data_to_charts=e(this.add_custom_data_to_charts,this),this.add_data_to_charts=e(this.add_data_to_charts,this),this.resize_chart=e(this.resize_chart,this),this.populate_summary=e(this.populate_summary,this),this.populate_metrics=e(this.populate_metrics,this),this.populate_error_data=e(this.populate_error_data,this),this.consume=e(this.consume,this),this.dispose=e(this.dispose,this),this.bind_websocket=e(this.bind_websocket,this),this.initialize_codemirror=e(this.initialize_codemirror,this),this.handle_failure=e(this.handle_failure,this),this.handle_url=e(this.handle_url,this),this.find_series_by_name=e(this.find_series_by_name,this),this.$container=t,this.backtest_id=i,this.q2_backtest_id=n,this.percentage_fields={total_returns:"tr",benchmark_returns:"br",max_drawdown:"md"},this.cumulative_fields={alpha:"al",volatility:"vo",beta:"be",benchmark_volatility:"bv",sharpe:"sh",sortino:"so",benchmark_returns:"br",total_returns:"tr",max_drawdown:"md",information:"in"},this.$code_container=this.$container.find(".code-container"),this.$container.find(".codelink").on("shown.bs.tab",function(t){return function(){return setTimeout(function(){var e;return t.initialize_codemirror(t.$container.find(".code-snapshot-textbox"),t.backtest_id),null!=(e=quanto.editor_snapshot)&&e.refresh(),$(".code-sidebar-filler").width($(".CodeMirror-gutter-wrapper").width())},10)}}(this)),this.$container.find(".migrated-codelink").on("shown.bs.tab",function(t){return function(){return setTimeout(function(){var e;return t.initialize_codemirror(t.$container.find(".migrated-code-snapshot-textbox"),t.q2_backtest_id),null!=(e=quanto.editor_snapshot)?e.refresh():void 0},10)}}(this)),d=new Date(parseInt(this.$container.find(".data_backtest_start_date_ms").val())),d=quanto.date.adjust_date_for_UTC(d),u=quanto.date.format_date("%Y-%m-%d",d),l=new Date(parseInt(this.$container.find(".data_backtest_end_date_ms").val())),l=quanto.date.adjust_date_for_UTC(l),c=quanto.date.format_date("%Y-%m-%d",l),this.$container.find(".backtest_start_date_display").html(u),this.$container.find(".backtest_end_date_display").html(c),a=parseInt(this.$container.find(".data_backtest_capital_base").val()),s=new Number(a).toMoney(0),this.$container.find(".backtest_capitalbase_display").html(""+s),this.$container.find(".retry-backtest-widget-load").on("click",function(t){return function(){return $(".backtest-loading").show(),$(".backtest-loading-error").hide(),quanto.get_server({success_callback:t.handle_url,failure_callback:t.handle_failure,task_id:t.backtest_id})}}(this)),"1"===quanto.get_query_variable("c")&&(this.$container.find(".clone-backtest-button").tooltip("show"),$(".tooltip-inner").on("mouseover",function(t){return function(){return t.$container.find(".clone-backtest-button").tooltip("hide")}}(this))),this.$container.addClass("backtest-loaded"),r=this.$container.find(".backtest-cached-data-url"),h=!1,r.length>0&&"1"!==quanto.get_query_variable("w")?(o=r.val(),$.get(o,function(t){return function(e){var i;if(null!=e)try{t.data_buffer=JSON.parse(e),t.received_perf_data=[],t.consume()}catch(n){return i=n,console.log(i),h=!0}}}(this))):h=!0,h&&quanto.get_server({success_callback:this.handle_url,failure_callback:this.handle_failure,task_id:this.backtest_id})}return t.prototype.find_series_by_name=function(t){return null==this.chart||null==this.chart.series?null:_.find(this.chart.series,function(){return function(e){return e.name===t}}(this))},t.prototype.handle_url=function(t,e,i){return this.server_ip=t,this.server_port=e,this.ws_url="wss://"+this.server_ip+":"+this.server_port+"/backtests/"+this.backtest_id,this.bind_websocket(this.ws_url,i)},t.prototype.handle_failure=function(){return $(".backtest-loading").hide(),$(".backtest-loading-error").show()},t.prototype.initialize_codemirror=function(t,e){var i,n;return i=t,i.length>0&&!i.hasClass("codemirror-done")?(quanto.widget_editors||(quanto.widget_editors={}),n=CodeMirror.fromTextArea(i[0],{lineNumbers:!0,mode:"python",indentUnit:4,readOnly:!0}),quanto.widget_editors[e]=n,i.addClass("codemirror-done")):void 0},t.prototype.bind_websocket=function(t,e){return this.ws=new WebSocket(t),this.received_perf_data=[],this.data_buffer=[],this.consume(),this.ws.onopen=function(t){return function(){return console.log("summary ws open"),t.ws.send(JSON.stringify({e:"open",p:{cursor:0,include_txn:!1,a:e}}))}}(this),this.ws.onerror=function(){return function(){}}(this),this.ws.onmessage=function(t){return function(e){return t.data_buffer.push(JSON.parse(e.data))}}(this),this.ws.onclose=function(){return function(){return console.log("summary ws closed")}}(this)},t.prototype.dispose=function(){return null!=this.ws&&(this.ws.send("ACK"),this.ws.onmessage=function(){},this.ws.onclose=function(){},this.ws.close(),this.ws=null),this.force_end=!0},t.prototype.consume=function(){var t,e,i,n,r,o,a,s,l,c,h,d;return i=this.data_buffer,this.data_buffer=[],r=!1,null!=this.force_end&&this.force_end?void 0:(i.length>0&&(e=_.groupBy(i,function(t){return t.e}),n=e.performance,null!=n&&n.length>0&&(this.received_perf_data=this.received_perf_data.concat(n),l=_.first(n).p,t=l.daily[0].bm,null!=t&&-1!==t&&quanto.set_benchmark(t,".red."+this.backtest_id),c=_.last(n).p,null!=c&&(h=quanto.pick_property(c,"percent_complete","pc"),null==h||isNaN(h)||(this.progress=Math.floor(1e3*h)/10,null!=this.progress&&!isNaN(this.progress)&&this.progress>=0&&this.progress<=100&&this.$container.find(".backtest-progress-bar").css("width",""+this.progress+"%")))),r=!1,s=!1,d=e.risk_report||[],d.length>0&&(this.received_risk_data=d[0]),o=e.done,null!=o&&o.length>0&&(this.received_done_data=o[0].p,r=!0),a=e.exception,null!=a&&a.length>0&&(this.received_error_data=a[0].p,this.populate_error_data(),r=!0)),r?(this.$container.find(".loading-overlay").addClass("hidden"),this.populate_summary(),this.populate_metrics(),null!=this.ws?this.ws.send("ACK"):void 0):setTimeout(function(t){return function(){return t.consume()}}(this),1e3))},t.prototype.populate_error_data=function(){return this.$container.find(".error-tab-header").show(),this.$container.find(".error-tab-header a").trigger("click"),this.error=!0,quanto.instances.error_renderer=new quanto.ErrorRenderer(this.$container.find(".backtest-widget-errors"),this.received_error_data,!1,null,this.backtest_id)},t.prototype.populate_metrics=function(){var t,e,i,n,r,o,a,s,l,c,h,d,u,p,f,g,m,v,b,y,x,w,k,C,T,S,L;if(c=_.last(this.received_perf_data),null!=c){l=_.last(c.p.daily),u=quanto.pick_property(l,"cumulative","c"),w=this.cumulative_fields;for(h in w)i=w[h],g=quanto.pick_property(u,h,i),null==g||isNaN(g)||(_.indexOf(this.percentage_fields,h)>=0?(o=Math.floor(1e4*g)/100,this.$container.find(".stat-value[datafield='"+h+"']").html(""+o+"%")):(o=g.toFixed(2),this.$container.find(".stat-value[datafield='"+h+"']").html(""+o)));if(p=Handlebars.compile("<tr><td class='date'>{{date}}</td><td class='text-right'>{{{one_month}}}</td><td class='text-right'>{{{three_month}}}</td><td class='text-right'>{{{six_month}}}</td><td class='text-right'>{{{twelve_month}}}</td></tr>"),null!=this.received_risk_data){k=this.received_risk_data.p.metrics;for(h in k)if(m=k[h],e=this.$container.find("table[data-riskmetric='"+h+"']"),e.length>0)for(f=_.keys(m).sort(),v=0,y=f.length;y>v;v++){if(r=f[v],n=m[r],_.indexOf(this.percentage_fields,h)>=0){C=quanto.risk_window_sizes;for(s in C)a=C[s],g=quanto.pick_property(n,s,a),null!=g&&(n[a]=Math.floor(1e4*g)/100+"%")}else{T=quanto.risk_window_sizes;for(s in T)a=T[s],g=quanto.pick_property(n,s,a),null!=g&&(n[a]=Math.floor(1e4*g)/1e4)}S=quanto.risk_window_sizes;for(s in S)a=S[s],g=quanto.pick_property(n,s,a),null==g&&(n[a]="<span class='gray small'>N/A</span>");n.date=this.translate_date_string(r),t=p(n),e.find("tbody").append(t)}}for(L=["sortino","information"],b=0,x=L.length;x>b;b++)d=L[b],null==u[d]&&this.$container.find("li[data-metric="+d+"]").addClass("hidden");return $(".optional-metric-field").tooltip()}},t.prototype.translate_date_string=function(t){var e,i,n;return i=t.split("-"),n=parseInt(i[0],10),e=parseInt(i[1],10),""+quanto.date.months_list[e-1]+" "+i[0]},t.prototype.populate_summary=function(){var t,e,i,n,r,o,a,s,l,c,h,d,u,p,f,g,m,v,b,y,x,w,k,C,T;for(r=[],C=this.received_perf_data,g=0,y=C.length;y>g;g++)if(h=C[g],c=h.p,null!=c)for(T=c.daily,m=0,x=T.length;x>m;m++)n=T[m],r.push(n);for(s=_.last(r),o=new Date(quanto.pick_property(s,"date","d")),l=new Date(o.getFullYear(),o.getMonth(),o.getDate()),this.backtest_end_date=quanto.date.adjust_date_for_UTC_reverse(l),this.received_custom_series={},v=0,w=r.length;w>v;v++)if(n=r[v],u=quanto.pick_property(n,"recorded_vars","rv"),null!=u)for(a in u)f=u[a],this.received_custom_series[a]=!0;for(this.initialize_chart(this.received_custom_series),b=0,k=r.length;k>b;b++)n=r[b],p=quanto.pick_property(n,"date","d"),o=new Date(p),l=new Date(o.getFullYear(),o.getMonth(),o.getDate()),t=quanto.date.adjust_date_for_UTC_reverse(l).getTime(),i=quanto.pick_property(n,"cumulative","c"),d=quanto.pick_property(i,"total_returns","tr"),e=quanto.pick_property(i,"benchmark_returns","br"),this.add_data_to_charts(t,d,e),u=quanto.pick_property(n,"recorded_vars","rv"),null!=u&&this.add_custom_data_to_charts(t,u);return this.chart.redraw(),this.$container.find(".nav-tabs a.disabled").removeClass("disabled"),this.$container.find(".loading-tab").remove(),null!=this.error&&this.error||this.$container.find(".tab-pane.perf").addClass("active"),$(window).on("resize",function(t){return function(){return null!=t.resizeTimer&&clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout(t.resize_chart,100)}}(this)),this.resize_chart(),this.$container.find(".legend-item").bind("click",function(t){return function(e){var i,n,r;return i=$(quanto.get_src_element(e)).closest(".legend-item"),r=i.data("key"),null!=r&&(n=t.find_series_by_name(r),null!=n)?i.hasClass("unselected")?(i.removeClass("unselected"),n.show()):(i.addClass("unselected"),n.hide()):void 0}}(this))},t.prototype.resize_chart=function(){var t;return t=20,_.keys(this.received_custom_series).length>0?this.chart.setSize(this.$container.width()-t,433):this.chart.setSize(this.$container.width()-t,300)},t.prototype.add_data_to_charts=function(t,e,i){return this.chart.series[0].addPoint([t,e],!1),this.chart.series[1].addPoint([t,i],!1)},t.prototype.add_custom_data_to_charts=function(t,e){var i,n,r,o;o=[];for(i in e)r=e[i],n=_.find(this.chart.series,function(){return function(t){return t.name===i}}(this)),o.push(n.addPoint([t,r],!1));return o},t.prototype.initialize_chart=function(t){var e,i,n,r,o,a,s,l;if(null==t&&(t={}),a={global:{useUTC:!0},chart:{renderTo:"perf-summary-chart-"+this.backtest_id,alignTicks:!0},credits:{enabled:!1},navigator:{series:{color:"transparent",lineWidth:0},height:20,maskFill:"rgba(180, 198, 220, 0.75)",xAxis:{type:"datetime",dateTimeLabelFormats:{day:"%b %e",week:"%b %e",month:"%b %Y"}}},rangeSelector:{enabled:!1},title:{text:null},series:[{type:"area",name:"Returns",data:[],dataGrouping:quanto.global_grouping_options,yAxis:0,color:"#4572A7",fillOpacity:.2},{type:"line",name:"Benchmark",data:[],dataGrouping:quanto.global_grouping_options,yAxis:0,lineWidth:1,color:"#aa4643"}],yAxis:[{title:{text:null},height:192,offset:0,labels:{formatter:function(){return 100*this.value+"%"}},minorGridLineWidth:1,minorTickInterval:"auto",minorTickWidth:0,opposite:!0,lineWidth:1,plotLines:[{value:0,color:"black",width:2}]}],xAxis:{ordinal:!1,dateTimeLabelFormats:{day:"%b %e",week:"%b %e",month:"%b %Y"},gridLineWidth:1,gridLineColor:"lightgray"},plotOptions:quanto.global_plotOptions,tooltip:{hideCallback:function(t){var e,i,n,r,o,a,s,l,c;if(e=$(t.container).closest(".backtest-widget"),$(".date-chart-label").html("").hide(),null!=t.hoverPoints&&$.each(t.hoverPoints,function(t,e){return e.setState("")}),null!=t.series&&t.series.length>2){if(a=t.series[0].points,null==a||a.length<=2||null==a[0])return;c=a[0].y,l=_.last(a).y,s=l-c,r=t.series[1].points,i=null,null!=r&&r.length>=2&&(o=r[0].y,n=_.last(r).y,i=n-o),quanto.BacktestSummaryManager.display_perf_chart_values(e,s,i)}return e.find(".custom-variable-legend .payload .chart-value").html("")},formatter:function(){var t,e,i,n,r,o,a,s,l,c,h;if(null==this.points||0===this.points.length)return!1;for(r=this.points[0].series.currentDataGrouping,n=null!=r&&"week"===(null!=r?r.unitName:void 0)?"Week of "+Highcharts.dateFormat("%b %e, %Y",this.x,!1):Highcharts.dateFormat("%b %e, %Y",this.x,!1),t=$(this.points[0].series.chart.container).closest(".backtest-widget"),t.find(".date-chart-label").html(n).show(),o=null,e=null,i=[],h=this.points,l=0,c=h.length;c>l;l++)a=h[l],s=a.series.name,"End"!==s&&("Returns"===s?o=a.y:"Benchmark"===s?e=a.y:i.push(a));return quanto.BacktestSummaryManager.display_perf_chart_values(t,o,e),i.length>0&&quanto.BacktestSummaryManager.display_custom_var_values(t,i),!1}}},null!=t&&_.keys(t).length>0){this.$container.find(".tab-pane.perf").addClass("showing-custom"),o={title:{text:null},height:100,top:260,opposite:!0,lineWidth:1,startOnTick:!0,endOnTick:!0,minPadding:.05,maxPadding:.05,forceTickRecalculate:!0,plotLines:[{value:0,color:"black",width:2}]},a.yAxis.push(o),i=Handlebars.compile("<div class='payload legend-item' custom-chart-label legend-item inline-block payload' data-key='{{key}}'><span class='square' style='background-color: {{color}}'></span><span style='color: {{color}}'>{{key}}</span><span class='chart-value' style='color: {{color}}' data-key='{{key}}'></span></div>");for(n in t)l=t[n],e=quanto.custom_chart_colors[(a.series.length-2)%quanto.custom_chart_colors.length],s={type:"line",name:n,data:[],dataGrouping:quanto.global_grouping_options,yAxis:1,lineWidth:1,color:e},a.series.push(s),r=i({key:n,color:e}),this.$container.find(".custom-vars-legend-container").append(r),this.$container.find(".custom-variable-legend").show()}return this.chart=new Highcharts.StockChart(a),null==this.backtest_end_date||isNaN(this.backtest_end_date.getTime())?void 0:this.chart.addSeries({name:"End",data:[[this.backtest_end_date.getTime(),0]]})},t.display_custom_var_values=function(t,e){var i,n,r,o;for(o=[],n=0,r=e.length;r>n;n++)i=e[n],o.push(t.find(".custom-variable-legend .payload[data-key="+i.series.name+"] .chart-value").html(Math.round(100*i.y)/100));return o},t.display_perf_chart_values=function(t,e,i){var n,r,o,a;return null==i&&(i=0),a=Math.floor(1e4*e)/100,o=Math.floor(1e4*i)/100,r=t.find(".performance-value"),n=t.find(".benchmark-value"),r.html(""+a+"%"),n.html(""+o+"%"),0>a?r.addClass("negative"):r.removeClass("negative"),0>o?n.addClass("negative"):n.removeClass("negative")},t}()}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};quanto.ForumIndexManager=t=function(){function t(){this.see_all_tags=e(this.see_all_tags,this),this.trigger_search=e(this.trigger_search,this),this.set_search_state=e(this.set_search_state,this),this.show_advanced_options=e(this.show_advanced_options,this),this.initialize_search=e(this.initialize_search,this),this.display_listen_ui_for_option=e(this.display_listen_ui_for_option,this),this.send_listen_option=e(this.send_listen_option,this),this.initialize_auto_listening=e(this.initialize_auto_listening,this),this.sidebar_track_redirect_click=e(this.sidebar_track_redirect_click,this),this.handle_paginate_link=e(this.handle_paginate_link,this),this.initialize_paginate_links=e(this.initialize_paginate_links,this);var t,i;this.$content_area=$(".wrapper"),this.$posts_area=this.$content_area.find(".posts-area"),this.$loading_page_area=this.$content_area.find(".show-while-paging"),this.$page_container=this.$content_area.find(".page-container"),this.$main_row=this.$content_area.find(".main-row"),this.$search_area=this.$content_area.find(".search-input-area"),this.$advanced_seach_options_area=this.$content_area.find(".advanced-seach-options-row"),this.$search_icon=this.$content_area.find(".icon-search"),this.$search_box=this.$content_area.find("#search-box"),this.$close_search_area=this.$content_area.find(".icon-close-wrapper"),this.$announcements=this.$content_area.find(".announcement"),i=new quanto.TagManager,this.initialize_search(),this.initialize_auto_listening(),this.initialize_paginate_links(),i.initialize_add_tag_modal(),quanto.on_click(".forum-sidebar-button",function(t){return function(e){return t.sidebar_track_redirect_click(e)
}}(this)),quanto.on_click(".see-all-tags",function(t){return function(){return t.see_all_tags()}}(this)),quanto.on_click(".back-to-community",function(){return function(){return quanto.go_to_community_home()}}(this)),quanto.on_click(".select-tags",function(){return function(){return i.add_tags()}}(this)),quanto.on_click(".addable",function(){return function(t){return i.add_remove_tag(t)}}(this)),quanto.on_click("#save-tags-button",function(t){return function(){return i.select_tags_for_search("#add-tags-to-post-modal"),setTimeout(function(){return t.trigger_search()},100)}}(this)),quanto.on_click(".mobile-advanced-search-button",function(t){return function(){return $(".mobile-advanced-search-options").addClass("hidden"),$(".hide-on-mobile-tag-tab").removeClass("hidden"),i.select_tags_for_search(".mobile-advanced-search-options"),setTimeout(function(){return t.trigger_search()},100)}}(this)),quanto.on_click(".advanced-options-mobile-link",function(){return function(){return i.update_add_tags_mobile(),$(".mobile-advanced-search-options").removeClass("hidden"),$(".hide-on-mobile-tag-tab").addClass("hidden"),$(".mobile-tab-row").addClass("hidden")}}(this)),quanto.on_click(".attachment-option",function(t){return function(e){var i;return $(".attachment-option").removeClass("selected"),i=$(e.target),i.addClass("selected"),i.hasClass("mobile")?void 0:setTimeout(function(){return t.trigger_search()},100)}}(this)),quanto.on_click(".close-advanced-search",function(){return function(){return $(".mobile-advanced-search-options").addClass("hidden"),$(".hide-on-mobile-tag-tab").removeClass("hidden"),$(".mobile-tab-row").removeClass("hidden")}}(this)),quanto.on_click(".mobile-tab",function(){return function(){return $(".mobile-advanced-search-options").addClass("hidden"),$(".mobile-tab").toggleClass("active"),$(".tags-tab").hasClass("active")?($(".mobile-see-all-tags").removeClass("hidden"),$(".hide-on-mobile-tag-tab").addClass("hidden")):($(".mobile-see-all-tags").addClass("hidden"),$(".hide-on-mobile-tag-tab").removeClass("hidden"))}}(this)),$(".backtest-icon").tooltip({title:"This post has an attached backtest.",container:".posts-area"}),$(".notebook-icon").tooltip({title:"This post has an attached research notebook.",container:".posts-area"}),t=window.location.pathname,"/posts/newest"===t?quanto.set_community_home_page_cookie("newest"):quanto.set_community_home_page_cookie("interesting")}return t.prototype.initialize_paginate_links=function(){return this.$paginate_links=this.$page_container.find(".quanto-paginate a"),this.$paginate_links.click(this.handle_paginate_link)},t.prototype.handle_paginate_link=function(t){var e,i,n,r;return e=$(t.target),n=e.attr("href"),this.$paginate_links.off("click"),i=$(".paging-placeholder"),i.html(this.$posts_area.html()),r=$(".pagination").offset().top,this.$main_row.css("min-height",this.$posts_area.height()),this.set_search_state("paging"),$("body").animate({scrollTop:0},10),window.location.href=n,!1},t.prototype.sidebar_track_redirect_click=function(t){var e,i,n,r;return e=$(quanto.get_src_element(t)),r=quanto.is_anonymous()?"anonymous":"registered",i=e.data("mixpanel")||e.html(),mixpanel.track("forum sidebar click",{link:i,user_type:r}),n=e.data("url"),_.str.startsWith(n,"http")||(n="http://"+n),window.open(n)},t.prototype.initialize_auto_listening=function(){return this.auto_listen="true"===$("#autolisten-state").val(),this.display_listen_ui_for_option(this.auto_listen),quanto.on_click(".listening-options a",function(t){return function(e){var i,n;return i=$(quanto.get_src_element(e)).closest("a"),n="on"===i.data("listen-option"),t.auto_listen!==n?t.send_listen_option(n):void 0}}(this)),quanto.on_click("#listen-button",function(t){return function(){return t.send_listen_option(!t.auto_listen)}}(this))},t.prototype.send_listen_option=function(t){var e;return e={id:$("#current_user_id").val(),listen_option:t},$(".listening-options button").addClass("disabled"),$.post("/users/toggle_autolisten",e,function(t){return function(e){var i;return $(".listening-options button").removeClass("disabled"),i=new quanto.JsonResponse(e),i.ok()?(t.auto_listen=i.data().new_value,t.display_listen_ui_for_option(t.auto_listen)):void 0}}(this)).error(function(){return function(){return alert("There was a problem updating your preferences."),$(".listening-options button").removeClass("disabled")}}(this))},t.prototype.display_listen_ui_for_option=function(t){return t?($("#listen-off-row").removeClass("selected"),$("#listen-on-row").addClass("selected"),$("#listen-button").html("Stop Auto Listen")):($("#listen-off-row").addClass("selected"),$("#listen-on-row").removeClass("selected"),$("#listen-button").html("Auto Listen"))},t.prototype.initialize_search=function(){var t,e,i;return this.search_mode=!1,this.$close_search_area.addClass("hidden"),this.$search_icon.click(function(t){return function(){return t.$search_box.focus()}}(this)),this.$search_box.focus(function(t){return function(){return t.$search_area.addClass("active"),t.$page_container.addClass("search-active"),t.$advanced_seach_options_area.removeClass("hidden")}}(this)),$(".content-area").mouseup(function(t){return function(e){return 0===$(e.target).closest(".search-input-area, #add-tags-to-post-modal").length&&"all"===$(".attachment-option.selected").data("name")&&""===t.$search_box.val()?(t.$search_area.removeClass("active"),t.$page_container.removeClass("search-active"),t.$advanced_seach_options_area.hasClass("mobile")||t.$advanced_seach_options_area.addClass("hidden"),t.$close_search_area.addClass("hidden"),t.$search_area.removeClass("has-value")):void 0}}(this)),this.$close_search_area.click(function(t){return function(){return t.$search_box.val(""),t.$search_area.removeClass("has-value"),t.set_search_state(""),t.$advanced_seach_options_area.addClass("hidden"),window.location="/posts"}}(this)),this.$search_box.keydown(function(t){return function(e){return""!==t.$search_box.val()?(t.$search_area.addClass("has-value"),t.$close_search_area.removeClass("hidden")):(t.$search_area.removeClass("has-value"),t.$close_search_area.addClass("hidden")),13===e.which?t.trigger_search():void 0}}(this)),t=$(".page-title").data("query"),e=$(".page-title").data("tag"),i="",e&&(i="["+e.replace(/,/g,"][")+"] "),t&&(i+=t),this.$search_box.val(i),(""!==this.$search_box.val()||"all"!==$(".attachment-option.selected").data("name"))&&(this.$search_area.addClass("active"),this.$search_area.addClass("force-open"),this.$page_container.addClass("search-active"),this.show_advanced_options(!0)),""!==this.$search_box.val()?(this.$close_search_area.css("display","block"),this.$close_search_area.removeClass("hidden")):void 0},t.prototype.show_advanced_options=function(t){return t&&this.$advanced_seach_options_area.addClass("force-open"),this.$advanced_seach_options_area.removeClass("hidden")},t.prototype.set_search_state=function(t){return this.$page_container.removeClass("searching search-complete paging"),this.$page_container.addClass(t)},t.prototype.trigger_search=function(){var t,e,i,n,r,o,a,s,l,c,h,d,u;if(this.$search_box.blur(),n=this.$search_box.val(),t=$(".advanced-seach-options-row").find(".selected").data("name"),a=$(".active.sort-by").hasClass("sort-by-newest"),e=a?"/newest":"","all"===t&&$.trim(n).length<1)return window.location.href="/posts"+e,void 0;if(this.set_search_state("searching"),o=/[^[\]]+(?=])/g,l=n.match(o),null!==l)if(c="",r=n,1===l.length)s=l[0],r=r.replace("["+s+"]","").trim(),""===r?(mixpanel.track("forums search query",{query:"",tag:s}),h="/posts/tag/"+s.split("/").join("-and-").split(" ").join("-")+e,"all"!==t&&(h+="?attachment="+t)):(mixpanel.track("forums search query",{query:r,tag:s}),h="/posts/tag/"+s.split("/").join("-and-").split(" ").join("-")+"/search?q="+r,"all"!==t&&(h+="&attachment="+t));else{for(i=[],d=0,u=l.length;u>d;d++)s=l[d],r=r.replace("["+s+"]","").trim(),i.push(s.split(" ").join("-"));""===r?(mixpanel.track("forums search query",{query:"",tag:i.join(",")}),h="/posts/tag"+e+"?tags="+i.join(",")):(mixpanel.track("forums search query",{query:r,tag:i.join(",")}),h="/posts/search?tags="+i.join(",")+"&q="+r),"all"!==t&&(h+="&attachment="+t)}else""===n?(mixpanel.track("forums search query",{query:"",tag:t+"-only"}),h="/posts/"+t+e):(mixpanel.track("forums search query",{query:n,tag:""}),h="/posts/search?q="+n,"all"!==t&&(h+="&attachment="+t));return window.location.href=h},t.prototype.see_all_tags=function(){return $("#see-all-tags-modal").modal("show")},t}()}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,n=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};quanto.NewPostManager=t=function(t){function i(){this.initialize_validation_rules=e(this.initialize_validation_rules,this),this.initialize_tags=e(this.initialize_tags,this),this.update_tags=e(this.update_tags,this),this.add_remove_tag=e(this.add_remove_tag,this),this.add_tags=e(this.add_tags,this),this.initialize_editor=e(this.initialize_editor,this),this.update_hint=e(this.update_hint,this),this.handle_preview_failure=e(this.handle_preview_failure,this),this.handle_preview_success=e(this.handle_preview_success,this),this.reset_path=e(this.reset_path,this),this.finish_submit=e(this.finish_submit,this),this.submit_post_as_draft=e(this.submit_post_as_draft,this),this.$form=$("#new-post"),mixpanel.track("share algo page loaded"),this.tags_added_count=0,this.initialize_editor(),this.initialize_validation_rules(),this.initialize_tags(),""!==$("#titlebox").val()&&$(".preview-post-link").prop("disabled",!1),this.$text_editor=$("#wmd-input"),this.$text_editor.bind("focus",function(t){return function(){return $("#wmd-button-bar").removeClass("disabled"),t.update_hint("body")}}(this)),this.$text_editor.bind("focusout",function(t){return function(){return t.update_hint("focusout")}}(this)),$("#titlebox").bind("focus",function(t){return function(){return t.update_hint("title")}}(this)),$("#titlebox").bind("focusout",function(t){return function(){return t.update_hint("focusout")}}(this)),quanto.on_click(".add-tags",function(t){return function(){return t.add_tags()}}(this)),quanto.on_click(".addable",function(t){return function(e){return t.add_remove_tag(e)}}(this)),quanto.on_click(".current-tags .selected",function(t){return function(e){return t.add_remove_tag(e)}}(this)),quanto.on_click("#save-tags-button",function(t){return function(){return t.update_tags()}}(this)),quanto.on_click(".preview-post-link",function(t){return function(){return t.submit_post_as_draft()}}(this)),this.$text_editor.on("focusout",function(t){var e;return e=$(quanto.get_src_element(t)),""!==e.val()?($(".wmd-button-bar").addClass("white"),$("#wmd-button-group-add-backtest").addClass("white"),e.addClass("white")):($(".wmd-button-bar").removeClass("white"),$("#wmd-button-group-add-backtest").removeClass("white"),e.removeClass("white"))}),i.__super__.constructor.call(this),$("#attach-nb-data").length>0&&(this.shared_from_notebook=!0,this.attach_nb_data=$("#attach-nb-data").data(),this.research_host_url=this.attach_nb_data.research_host_url,this.add_attached_notebook(this.attach_nb_data.attach_nb_name))}return n(i,t),i.prototype.submit_post_as_draft=function(){var t,e,i,n,r;return r=_.str.trim($("#titlebox").val()),e=_.str.trim(this.$text_editor.val()),n=_.str.trim($("#tags-hidden-field").val()),i=_.str.trim($("#existing_post_id").val()),t=_.str.trim($("#backtest-id").val()),this.post_data={title:r,body:e,tags:n,existing_post_id:i,backtest_id:t},this.before_submit(),!1},i.prototype.finish_submit=function(){return $("#post-id").length>0&&(this.post_data.existing_post_id=$("#post-id").val()),$.ajax("/posts/submit",{type:"POST",data:this.post_data,dataType:"html",success:this.handle_preview_success,error:this.handle_preview_failure,async:!1})},i.prototype.reset_path=function(){return window.history.pushState({},"","/posts/new")},i.prototype.handle_preview_success=function(t){var e;return e=new quanto.JsonResponse(t),e.ok()?window.location.href=e.data().post_path:console.log("failure!")},i.prototype.handle_preview_failure=function(){return console.log("failure!")},i.prototype.update_hint=function(t){return"body"===t?$(".body-hint").fadeIn(200):"title"===t?$(".title-hint").fadeIn(200):"focusout"===t?($(".input-hint").fadeOut(100),$(".body-hint").fadeOut(100)):void 0},i.prototype.initialize_editor=function(){return this.wmd_mgr=new quanto.wmdEditor({"show-attach":!0}),this.wmd_mgr.editor.refreshPreview()},i.prototype.add_tags=function(){return $("#add-tags-to-post-modal").modal("show")},i.prototype.add_remove_tag=function(t){var e,i,n;if(e=$(quanto.get_src_element(t)),e.parent().hasClass("current-tags"))return n=e.data("tag-id"),i=$("*[data-tag-id="+n+"]"),i.removeClass("selected"),"Featured"!==e.html()&&(this.tags_added_count-=1),this.update_tags(),void 0;if("Featured"===e.html());else if(e.hasClass("selected"))this.tags_added_count-=1;else{if(e.hasClass("selected")||!(this.tags_added_count<5))return $("#add-tags-to-post-modal").find(".subtitle").toggleClass("shake"),void 0;this.tags_added_count+=1}return e.toggleClass("selected")},i.prototype.update_tags=function(){var t,e,i,n,r,o,a;for($("#add-tags-button").hide(),$(".current-tags").empty(),t=$(".selected"),e=[],o=0,a=t.length;a>o;o++)n=t[o],r=$(n).html(),i=$(n).data("tag-id"),e.push(i),$(".current-tags").append("<div class='tag selected' data-tag-id="+i+">"+r+"</div>");return 0===e.length?($("#add-tags-button").show(),$(".current-tags").hide()):($(".current-tags").append("<div class='tag add-or-edit-tag add-tags'>Add/Edit</div>"),$(".current-tags").show()),e===[]&&(e=""),$("#tags-hidden-field").val(e.toString())},i.prototype.initialize_tags=function(){var t,e,i,n,r,o;if(this.tags_added_count=0,n=$("#tags-hidden-field").val(),n=n.replace(/\"|\[|]|\s/g,""),i=n.split(","),""!==n){for(r=0,o=i.length;o>r;r++)e=i[r],t=$("*[data-tag-id="+e+"]"),t.addClass("selected"),t.data("tag-hidden")||(this.tags_added_count+=1);return this.update_tags()}},i.prototype.initialize_validation_rules=function(){return this.validator=this.$form.validate({onkeyup:function(){return this.checkForm(),this.valid()?$(".preview-post-link").prop("disabled",!1):$(".preview-post-link").prop("disabled",!0)},rules:{title:{required:!0},body:{required:!0}},errorPlacement:function(){return!0}})},i}(quanto.PostManagerBase)}.call(this),function(){var t,e,i,n=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty,o=function(t,e){function i(){this.constructor=t}for(var n in e)r.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};quanto.PostManager=i=function(i){function r(i){this.get_validation_tooltip_text=n(this.get_validation_tooltip_text,this),this.get_preview_link_text=n(this.get_preview_link_text,this),this.clear_controls=n(this.clear_controls,this),this.handle_clone_clicked=n(this.handle_clone_clicked,this),this.finish_submit=n(this.finish_submit,this),this.handle_reply_clicked=n(this.handle_reply_clicked,this),this.handle_reply_from_modal=n(this.handle_reply_from_modal,this),this.add_reply_html=n(this.add_reply_html,this),this.load_reply_html=n(this.load_reply_html,this),this.handle_message=n(this.handle_message,this),this.initialize_reply_control=n(this.initialize_reply_control,this),this.format_code=n(this.format_code,this),this.get_plaintext_for_sharing=n(this.get_plaintext_for_sharing,this),this.initialize_sharing=n(this.initialize_sharing,this),this.initialize_embedded_notebook=n(this.initialize_embedded_notebook,this),this.initialize_embedded_backtest=n(this.initialize_embedded_backtest,this),this.handle_delete_clicked=n(this.handle_delete_clicked,this),this.publish_post=n(this.publish_post,this),this.dont_show_close_confirmation=n(this.dont_show_close_confirmation,this),this.go_back_to_community=n(this.go_back_to_community,this);var o,a,s,l,c,h,d,u,p,f;for(r.__super__.constructor.call(this),this.$reply_placeholder=$(".reply-box-inactive"),this.$replybox=$("#wmd-input"),this.$replybutton=$("#reply-button"),this.thread_id=$("#parent-post-id-val").val(),this.$text_editor=this.$replybox,this.$submit_button=this.$replybutton,this.submit_text="Reply",this.submitting_text="Sending...",quanto.on_click("#reply-button",this.handle_reply_clicked),quanto.on_click("#reply-from-modal-button",this.handle_reply_from_modal),quanto.on_click(".clone-backtest-button",this.handle_clone_clicked),quanto.on_click(".submit-new-post-button",function(t){return function(){return t.publish_post()}}(this)),quanto.on_click(".back-to-community",function(t){return function(){return t.go_back_to_community()}}(this)),quanto.on_click(".edit-post",function(t){return function(){return t.dont_show_close_confirmation()}}(this)),quanto.on_click(".cancel-post",function(t){return function(){return t.dont_show_close_confirmation()}}(this)),quanto.instances.backtest_summary_managers=[],p=$(".backtest-widget"),c=0,d=p.length;d>c;c++)a=p[c],this.initialize_embedded_backtest($(a));for(f=$(".nb-preview-widget"),h=0,u=f.length;u>h;h++)l=f[h],this.initialize_embedded_notebook($(l));this.format_code(),this.listener_control=new e(this.thread_id),this.initialize_sharing(),$("#reply-button").keypress(function(t){return 13===t.keyCode?$("#reply-button").click():void 0}),$(".wmd-panel").length>0&&this.initialize_reply_control(),null!=window.location.hash&&window.location.hash.length>0&&(s=quanto.get_safe_window_hash(),"#"===s[0]&&(s=s.substr(1)),o=$(".container[data-postid="+s+"]"),o.length>0&&setTimeout(function(){return function(){return window.scrollTo(0,o.offset().top-55)}}(this),100)),quanto.on_click(".delete-link",function(t){return function(e){return t.handle_delete_clicked(e)}}(this)),this.inline_editing_control=new t,i&&$(window).bind("beforeunload",function(){return"This post has not been published.  Are you sure you want to leave without publishing?"})}return o(r,i),r.prototype.go_back_to_community=function(){var t;return""===document.referrer?(quanto.go_to_community_home(),void 0):(t=new URL(document.referrer),parent.history.length>1&&document.referrer!==window.location.href&&_.str.include(t.pathname,"post")&&t.hostname===window.location.hostname&&document.referrer.indexOf("/posts/edit/")<0?parent.history.back():quanto.go_to_community_home())},r.prototype.dont_show_close_confirmation=function(){return $(window).unbind("beforeunload")},r.prototype.publish_post=function(){var t;return $(window).unbind("beforeunload"),t={existing_post_id:$("#post-id").val()},$.post("/posts/publish",t,function(t){return function(e){return t.sharing_backtest||t.attached_backtest_id?mixpanel.track("successfully shared algo",{},function(){var t;return t=new quanto.JsonResponse(e)}):mixpanel.track("submitted new non-backtest post",{},function(){var t;return t=new quanto.JsonResponse(e)}),"ok"===e.status?window.location=e.data.post_path:void 0}}(this))},r.prototype.handle_delete_clicked=function(t){var e,i,n,r,o;return e=$(quanto.get_src_element(t)),i=e.closest(".post-container"),o=i.data("post-id"),null!=o?(n=function(){return function(){var t;return t={paprika:$("#paprika").val(),id:o},$.post("/posts/delete_post",t,function(t){var e;return e=new quanto.JsonResponse(t),e.ok()?(mixpanel.track("Post deleted"),i.remove()):void 0}).error(function(){return alert("There was a problem deleting this post.")})}}(this),r=i.hasClass("response-container")?"response":"post",quanto.show_confirmation_popup("Confirm","Delete this "+r+"?","Delete",n)):void 0},r.prototype.initialize_embedded_backtest=function(t){var e,i;return e=t.data("backtest-id"),i=t.data("q2-backtest-id"),null!=e?quanto.instances.backtest_summary_managers.push(new quanto.BacktestSummaryManager(t,e,i)):void 0},r.prototype.initialize_embedded_notebook=function(t){var e,i,n,r,o,a;return a=new quanto.NotebookIframeManager(t.find(".nb-preview-iframe")),o=new quanto.NotebookIframeManager(t.find(".full-notebook-iframe"),!0),e=t.find(".clone-notebook-button"),i=t.find(".full-notebook-button"),r="Make a copy of this research notebook so you can explore and modify it.",e.hasClass("disabled")&&(r="Cloning is not available for this notebook because it was shared before the cloning feature was added."),n=t.find(".clone-notebook-wrapper"),n.tooltip({title:r,trigger:"hover",placement:"top"}),e.click(function(){return function(t){var e;return e=$(quanto.get_src_element(t)),e.html("Cloning...").addClass("disabled")}}(this)),i.click(function(e){return function(){var i,n;return n=t.find(".full-notebook-modal"),i=n.find(".empty-backdrop"),n.modal("show"),o.fit_to_contents(),i.click(function(){return n.modal("hide")}),n.on("shown.bs.modal",function(){var t;return o.fit_to_contents(),t=n.outerWidth(!0)-i.outerWidth(!0),n.find(".nb-reader-navbar").css("right",t),n.find(".close-link").css("right",-t)}),mixpanel.track("view notebook clicked",{thread_id:e.thread_id,post_id:t.data("post_id")})}}(this))},r.prototype.initialize_sharing=function(){return $(".facebook-button").on("click",function(t){return function(){return FB.ui({method:"feed",caption:$("#social_post_author").val(),link:$("#social_fb_post_link").val(),name:$.trim($("title").html()),description:t.get_plaintext_for_sharing(500),picture:$("#social_post_image").val()},function(t){return null!=t&&null!=t.post_id?mixpanel.track("shared thread",{medium:"facebook"}):alert("Sorry, there was a problem sharing this thread on Facebook.")})}}(this)),$(".linkedin-button").on("click",function(t){return function(e){var i,n,r;return r=$(quanto.get_src_element(e)).data("share-url"),n=screen.height/2-200,i=screen.width/2-300,r+="&summary="+t.get_plaintext_for_sharing(500),window.open(r,"linkedin","menubar=no,titlebar=no,height=370,width=600,left="+i+",top="+n)}}(this)),twttr.ready(function(){return function(t){return t.events.bind("tweet",function(){return mixpanel.track("shared thread",{medium:"twitter"})})}}(this))},r.prototype.get_plaintext_for_sharing=function(t){var e,i,n;null==t&&(t=500),n=[],$(".body-text-container").find("p").each(function(){return function(t,e){return n.push($(e).html())}}(this));try{i=n.join(" "),i=i.replace(/<(?:.|\n)*?>/gm,""),i=_.str.truncate(i,t)}catch(r){e=r,i="(Could not get preview)"}return i},r.prototype.format_code=function(){return $("code").addClass("prettyprint"),window.prettyPrint()},r.prototype.initialize_reply_control=function(){return this.wmd_mgr=new quanto.wmdEditor({"show-attach":!0}),this.$panel=$(".wmd-panel"),this.$reply_placeholder.on("mousedown",function(t){return function(){return t.$reply_placeholder.addClass("hidden"),t.$panel.removeClass("hidden"),$(".post-reply .submit").removeClass("hidden"),t.$panel.animate({height:"160px"},350).queue(function(){return t.$replybox.removeClass("hidden").height(128).focus(),t.$panel.css("height","auto")})}}(this)),this.$replybox.val()?this.$reply_placeholder.trigger("mousedown"):void 0},r.prototype.handle_message=function(t){var e,i;if(i=t.origin_id,null!=i&&i!==$("#paprika").val()){if("new_reply"===t.command)return this.load_reply_html(t.reply_id);if("updated_post"===t.command&&null!=t.post_id){if(e=$(".response-container[data-post-id="+t.post_id+"]"),e.length>0&&($.get("/posts/get_post_body",{post_id:t.post_id},function(){return function(t){var i,n;return n=new quanto.JsonResponse(t),n.ok()&&(i=n.data().html,null!=i)?e.find(".response-text-container").html(i):void 0}}(this)),null!=t.new_title))return e.find(".post-title h2").html(t.new_title)}else if("post_deleted"===t.command&&null!=t.post_id&&(e=$(".post-container[data-post-id="+t.post_id+"]"),e.length>0))return e.remove()}},r.prototype.load_reply_html=function(t){return $.get("/posts/get_reply_markup",{reply_id:t},function(t){return function(e){var i,n;return n=new quanto.JsonResponse(e),n.ok()?(i=n.html(),t.add_reply_html(i)):void 0}}(this))},r.prototype.add_reply_html=function(t){var e,i,n,r,o;return r=$("<div>"+t+"</div>"),t=r.html(),$(".replies").append(t),quanto.date.render_all_date_values(),this.format_code(),o=$(".post-response").length,1===o?$(".reply-title").html("1 response"):o>0?$(".reply-title").html(""+o+" responses"):$(".reply-title").html(""),e=$(".replies .response-container").last(),i=e.find(".backtest-widget").not(".backtest-loaded"),i.length>0&&this.initialize_embedded_backtest(i),n=e.find(".nb-preview-widget"),n.length>0?this.initialize_embedded_notebook(n):void 0},r.prototype.handle_reply_from_modal=function(){return $("#preview_reply_modal").modal("hide"),this.handle_reply_clicked()},r.prototype.handle_reply_clicked=function(){var t;return t=_.str.trim(this.$replybox.val()),0===t.length?($("#submit-error").html("Enter some text in your reply.").removeClass("hidden"),void 0):($("#submit-error").html("").addClass("hidden"),this.disable_controls(),this.post_data={paprika:$("#paprika").val(),parent_post_id:this.thread_id,text:t},this.$replybutton.addClass("disabled"),this.before_submit())},r.prototype.finish_submit=function(){return $.post("/posts/submit_reply",this.post_data,function(t){return function(e){var i;return mixpanel.track("post reply submitted"),i=new quanto.JsonResponse(e),t.$replybutton.removeClass("disabled"),i.ok()&&(t.add_reply_html(i.html()),t.clear_controls(),t.enable_controls(),null!=t.attached_backtest_id||null!=t.attached_notebook)?t.remove_attachment():void 0}}(this)).error(function(t){return function(e){return quanto.is_not_logged_in_error(e)?alert("You must be logged in."):quanto.show_error_popup(),t.enable_controls()}}(this)),this.$replybutton.prop("disabled",!1)},r.prototype.handle_clone_clicked=function(t){var e,i,n,r,o,a;return e=$(quanto.get_src_element(t)),e.html("Cloning...").addClass("disabled"),i=e.closest(".backtest-widget"),n=i.data("algo-id"),r=i.data("backtest-id"),a=i.data("post-id"),o={id:n,post_id:a,backtest_id:r},$.post("/algorithms/clone",o,function(){return function(t){var i;return mixpanel.track("new algo",{type:"cloned"}),i=new quanto.JsonResponse(t),i.redirect()||i.ok()?void 0:(e.html("Clone Algorithm").removeClass("disabled"),quanto.show_error_popup("There was an error cloning this algorithm."))}}(this))},r.prototype.clear_controls=function(){return this.$replybox.val(""),this.wmd_mgr.editor.refreshPreview(),$("#reply-link").trigger("click"),setTimeout(function(t){return function(){return t.$replybox.focus()}}(this),10)},r.prototype.get_preview_link_text=function(){return"Preview Reply"},r.prototype.get_validation_tooltip_text=function(){return"Enter some text for this reply"},r}(quanto.PostManagerBase),t=function(){function t(){this.cancel_edit_ui=n(this.cancel_edit_ui,this),this.handle_update_post_clicked=n(this.handle_update_post_clicked,this),this.handle_cancel_update=n(this.handle_cancel_update,this),this.handle_edit_clicked=n(this.handle_edit_clicked,this),this.wmd_editors={},quanto.on_click(".edit-link.inplace",function(t){return function(e){return t.handle_edit_clicked(e)}}(this)),quanto.on_click(".update-post-button",function(t){return function(e){return t.handle_update_post_clicked(e)}}(this)),quanto.on_click(".cancel-update-button",function(t){return function(e){return t.handle_cancel_update(e)}}(this))}return t.prototype.handle_edit_clicked=function(t){var e,i,n,r;return i=$(quanto.get_src_element(t)),n=i.closest(".post-container"),r=n.data("post-id"),e=n.find(".edit-body-controls"),n.find(".response-text").hide(),e.show(),e.hasClass("wmd-done")?void 0:(this.wmd_editors[r]=new quanto.wmdEditor({"show-attach":!1,postfix:"-"+r}),e.addClass("wmd-done"))},t.prototype.handle_cancel_update=function(t){var e,i;return e=$(quanto.get_src_element(t)),i=e.closest(".post-container"),this.cancel_edit_ui(i)},t.prototype.handle_update_post_clicked=function(t){var e,i,n,r;return e=$(quanto.get_src_element(t)),i=e.closest(".response-container"),r=i.data("post-id"),n={paprika:$("#paprika").val(),id:r,new_body:$("#wmd-input-"+r).val()},$.post("/posts/update_post",n,function(t){return function(e){var n,r;return r=new quanto.JsonResponse(e),r.ok()?(mixpanel.track("Post edited"),n=r.data().new_html,null!=n&&i.find(".response-text-container").html(n),t.cancel_edit_ui(i)):void 0}}(this)).error(function(){return function(){return alert("There was a problem updating your post.")}}(this))},t.prototype.cancel_edit_ui=function(t){return t.find(".response-text").show(),t.find(".edit-body-controls").hide()},t}(),e=function(){function t(t){this.render=n(this.render,this),this.toggle_listener=n(this.toggle_listener,this),this.initialize=n(this.initialize,this),this.$listeners_container=$(".listeners-control"),0!==this.$listeners_container.length&&(this.thread_id=t,this.$button=$("#listen-button"),this.$listeners_label=$(".listeners-count"),this.initialize())}return t.prototype.initialize=function(){var t,e,i;return this.listening=!1,t=$("#listening-data"),i=t.data("listening"),e=t.data("count"),this.listening=i,this.render(e),quanto.on_click("#listen-button",this.toggle_listener)},t.prototype.toggle_listener=function(){var t;return t={id:this.thread_id,user_id:quanto.user_id},this.listening?$.post("/posts/remove_listener",t,function(t){return function(e){var i,n;return t.listening=!1,n=new quanto.JsonResponse(e),i=n.data().count,t.render(i,!0)}}(this)):$.post("/posts/add_listener",t,function(t){return function(e){var i,n;return t.listening=!0,n=new quanto.JsonResponse(e),i=n.data().count,t.render(i,!0)}}(this))},t.prototype.render=function(t,e){return null==e&&(e=!1),this.listening?(this.$button.addClass("active"),this.$button.find(".listen-label").html("Listening"),this.$button.tooltip("destroy"),this.$button.tooltip({title:"You will receive email updates for this thread.",container:"body"})):(this.$button.removeClass("active"),this.$button.find(".listen-label").html("Listen"),this.$button.tooltip("destroy"),this.$button.tooltip({title:"Click to receive email updates for this thread.",container:"body"})),null!=t&&(1===t?this.$listeners_label.html("1 person listening to this thread"):this.$listeners_label.html(""+t+" people listening to this thread")),this.$listeners_container.removeClass("hidden"),e?this.$button.tooltip("show"):void 0},t}()}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};quanto.TagManager=t=function(){function t(){this.update_add_tag_modal_from_search_box=e(this.update_add_tag_modal_from_search_box,this),this.update_add_tags_mobile=e(this.update_add_tags_mobile,this),this.initialize_add_tag_modal=e(this.initialize_add_tag_modal,this),this.select_tags_for_search=e(this.select_tags_for_search,this),this.add_remove_tag=e(this.add_remove_tag,this),this.add_tags=e(this.add_tags,this),this.tags_added_count=0}return t.prototype.add_tags=function(){return $("#add-tags-to-post-modal").modal("show"),this.update_add_tag_modal_from_search_box()},t.prototype.add_remove_tag=function(t){var e,i;if(e=$(quanto.get_src_element(t)),"Featured"===e.html());else if(e.hasClass("selected"))this.tags_added_count-=1;else{if(e.hasClass("selected")||!(this.tags_added_count<5))return $("#add-tags-to-post-modal").find(".subtitle").toggleClass("shake"),void 0;this.tags_added_count+=1}return e.toggleClass("selected"),i=$("#add-tags-to-post-modal").find(".addable").filter(":contains('Featured')").hasClass("selected"),0!==this.tags_added_count||i?$("#save-tags-button").prop("disabled",!1):$("#save-tags-button").prop("disabled",!0)},t.prototype.select_tags_for_search=function(t){var e,i,n,r,o,a,s,l,c,h,d;if(r=$(".wrapper").find("#search-box"),n=r.val(),i=n.match(/[^[\]]+(?=])/g),null!==i)for(l=0,h=i.length;h>l;l++)a=i[l],n=n.replace("["+a+"]"," ");for(s="",e=$(t).find(".tag.selected"),c=0,d=e.length;d>c;c++)o=e[c],a=$(o).html(),s+="["+a+"] ";return s+=n.trim(),r.val(s),""===s?r.css("width","100%"):$(".current-tags").show()},t.prototype.initialize_add_tag_modal=function(){var t,e,i,n,r;if(i=$(".page-title").data("tag"),""!==i)for(e=i.split(","),n=0,r=e.length;r>n;n++)t=e[n],$("#add-tags-to-post-modal").find(":contains("+t+")").addClass("selected"),this.tags_added_count+=1;return 0===this.tags_added_count?$("#save-tags-button").prop("disabled",!0):void 0},t.prototype.update_add_tags_mobile=function(){var t,e,i,n,r,o;if(i=$(".page-title").data("tag"),""!==i){for(e=i.split(","),o=[],n=0,r=e.length;r>n;n++)t=e[n],$(".mobile-advanced-search-options").find(":contains("+t+")").addClass("selected"),o.push(this.tags_added_count+=1);return o}},t.prototype.update_add_tag_modal_from_search_box=function(){var t,e,i,n,r,o,a,s;if($("#add-tags-to-post-modal").find(".selected").removeClass("selected"),t=/\[(.*?)\]/g,r=$("#search-box").val(),""!==r&&(n=r.match(t),null!==n)){for(s=[],o=0,a=n.length;a>o;o++)i=n[o],e=i.substring(1,i.length-1),s.push($("#add-tags-to-post-modal").find(":contains("+e+")").addClass("selected"));
return s}},t}()}.call(this),function(){var t;quanto.wmdEditor=t=function(){function t(t){var e,i;null==t&&(t={}),this.converter=Markdown.getSanitizingConverter(),this.editor=new Markdown.Editor(this.converter,t.postfix),this.editor.run(),i=t.postfix||"",$("#wmd-button-row"+i+" button").attr("tabIndex",-1),null!=t["show-attach"]&&t["show-attach"]?$("#wmd-button-group-add-backtest"+i).removeClass("hidden"):$("#wmd-button-group-add-backtest"+i).remove(),quanto.is_mac()?(e="Cmd",$(".wmd-quote-button").tooltip({title:"Blockquote ("+e+"-Shift-9)",container:"body"}),Mousetrap.bindGlobal("command+shift+9",function(t){return t.target===$(".wmd-input")[0]?$("#wmd-quote-button").click():void 0}),Mousetrap.bindGlobal("command+shift+z",function(t){return t.target===$(".wmd-input")[0]?$("#wmd-redo-button").click():void 0})):(e="Ctrl",$(".wmd-quote-button").tooltip({title:"Blockquote ("+e+"-Q)",container:"body"}),Mousetrap.bindGlobal("ctrl+shift+z",function(t){return t.target===$(".wmd-input")[0]?$("#wmd-redo-button").click():void 0})),$(".wmd-bold-button").tooltip({title:"Bold ("+e+"-B)",container:"body"}),$(".wmd-italic-button").tooltip({title:"Italic ("+e+"-I)",container:"body"}),$(".wmd-link-button").tooltip({title:"Link ("+e+"-L)",container:"body"}),$(".wmd-code-button").tooltip({title:"Code Sample ("+e+"-K)",container:"body"}),$(".wmd-olist-button").tooltip({title:"Numbered List ("+e+"-O)",container:"body"}),$(".wmd-ulist-button").tooltip({title:"Bulleted List ("+e+"-U)",container:"body"}),$(".wmd-undo-button").tooltip({title:"Undo ("+e+"-Z)",container:"body"}),$(".wmd-redo-button").tooltip({title:"Redo ("+e+"-Shift-Z)",container:"body"}),this.converter.hooks.chain("postConversion",function(){return function(t){return 0===t.length?"<em class='gray'>(No text)</em>":t}}(this)),this.converter.hooks.chain("postConversion",function(){return function(t){var e,i,n,r,o,a;if(n=$("<div>"+t+"</div>"),i=n.find("code"),i.length>0)for(i.addClass("prettyprint"),i.wrap("<pre />"),o=0,a=i.length;a>o;o++)r=i[o],e=$(r),t=e.html(),_.str.startsWith(t,"\n")&&e.html(t.substr(1));return n.html()}}(this))}return t}()}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};quanto.NotebookIframeManager=t=function(){function t(t,i){null==i&&(i=!1),this.fit_to_contents=e(this.fit_to_contents,this),this.receive_post_message=e(this.receive_post_message,this),this.send_post_message=e(this.send_post_message,this),this.show_error=e(this.show_error,this),this.$iframe_elem=t,this.view_full=i,this.nb_preview_url=quanto_data.nb_preview_url,this.received_iframe_message=!1,this.iframe_window=this.$iframe_elem[0].contentWindow,window.addEventListener("message",this.receive_post_message,!1),this.timeout_id=setTimeout(function(t){return function(){return t.received_iframe_message?void 0:t.send_post_message({event:"get_height"})}}(this),2e3),this.$iframe_elem.load(function(t){return function(){return t.iframe_loaded=!0,clearTimeout(t.timeout_id),t.view_full?void 0:setTimeout(function(){return t.received_iframe_message?void 0:t.show_error()},5e3)}}(this)),this.view_full||(this.$nb_widget=this.$iframe_elem.closest(".nb-preview-area"),this.$loading_area=this.$nb_widget.find(".progress-area"),this.$error_area=this.$nb_widget.find(".error-area"),this.$iframe_wrapper=this.$nb_widget.find(".nb-preview-wrapper"),this.timeout_id=setTimeout(function(t){return function(){return t.received_iframe_message?void 0:t.show_error()}}(this),1e4))}return t.prototype.show_error=function(){return this.$loading_area.removeClass("in"),this.$error_area.addClass("in"),this.$nb_widget.closest(".nb-preview-widget").find(".full-notebook-button").addClass("disabled")},t.prototype.send_post_message=function(t){return this.nb_preview_url?this.iframe_window.postMessage(t,this.nb_preview_url):void 0},t.prototype.receive_post_message=function(t){var e;if(t.origin===this.nb_preview_url&&t.source===this.iframe_window&&null!=t.data)if("height_changed"===t.data.event){if(this.view_full||(this.$loading_area.removeClass("in"),this.$iframe_elem.addClass("animate-height"),setTimeout(function(t){return function(){return t.$iframe_wrapper.addClass("in")}}(this),500)),this.received_iframe_message=!0,e=t.data.height,null!=e&&0!==e)return this.$iframe_elem.height(e)}else if("link_clicked"===t.data.event)return window.location.href=t.data.url},t.prototype.fit_to_contents=function(){return this.send_post_message({event:"get_height"})},t}()}.call(this),function(){function t(t,e){var i;t||(t={});for(i in e)t[i]=e[i];return t}function e(){var t,e,i=arguments,n={},r=function(t,e){var i,n;"object"!=typeof t&&(t={});for(n in e)e.hasOwnProperty(n)&&(i=e[n],t[n]=i&&"object"==typeof i&&"[object Array]"!==Object.prototype.toString.call(i)&&"renderTo"!==n&&"number"!=typeof i.nodeType?r(t[n]||{},i):e[n]);return t};for(i[0]===!0&&(n=i[1],i=Array.prototype.slice.call(i,2)),e=i.length,t=0;e>t;t++)n=r(n,i[t]);return n}function i(){for(var t=0,e=arguments,i=e.length,n={};i>t;t++)n[e[t++]]=e[t];return n}function n(t,e){return parseInt(t,e||10)}function r(t){return"string"==typeof t}function o(t){return"object"==typeof t}function a(t){return"[object Array]"===Object.prototype.toString.call(t)}function s(t){return"number"==typeof t}function l(t){return me.log(t)/me.LN10}function c(t){return me.pow(10,t)}function h(t,e){for(var i=t.length;i--;)if(t[i]===e){t.splice(i,1);break}}function d(t){return t!==X&&null!==t}function u(t,e,i){var n,a,s="setAttribute";if(r(e))d(i)?t[s](e,i):t&&t.getAttribute&&(a=t.getAttribute(e));else if(d(e)&&o(e))for(n in e)t[s](n,e[n]);return a}function p(t){return a(t)?t:[t]}function f(){var t,e,i=arguments,n=i.length;for(t=0;n>t;t++)if(e=i[t],"undefined"!=typeof e&&null!==e)return e}function g(e,i){Ae&&!He&&i&&i.opacity!==X&&(i.filter="alpha(opacity="+100*i.opacity+")"),t(e.style,i)}function m(e,i,n,r,o){var a=fe.createElement(e);return i&&t(a,i),o&&g(a,{padding:0,border:Ze,margin:0}),n&&g(a,n),r&&r.appendChild(a),a}function v(e,i){var n=function(){};return n.prototype=new e,t(n.prototype,i),n}function b(t,e,i,r,o){var a=j.lang,s=+t||0,l=-1===e?(s.toString().split(".")[1]||"").length:isNaN(e=we(e))?2:e,c=void 0===i?a.decimalPoint:i,h=void 0===r?a.thousandsSep:r,d=0>s?"-":"",u=String(n(s=we(s).toFixed(l))),p=u.length>3?u.length%3:0,f=o?"$":"";return d+f+(p?u.substr(0,p)+h:"")+u.substr(p).replace(/(\d{3})(?=\d)/g,"$1"+h)+(l?c+we(s-u).toFixed(l).slice(2):"")}function y(t,e){return new Array((e||2)+1-String(t).length).join(0)+t}function x(t,e,i){var n=t[e];t[e]=function(){var t=Array.prototype.slice.call(arguments);return t.unshift(n),i.apply(this,t)}}function _(t,e){if(!t)return 0;for(var i=0,n=t.length;n>i;){var r=i+n>>1;t[r]<e?i=r+1:n=r}return i}function w(t,e){var i,n=/f$/,r=/\.([0-9])/,o=j.lang;return n.test(t)?(i=t.match(r),i=i?i[1]:-1,e=b(e,i,o.decimalPoint,t.indexOf(",")>-1?o.thousandsSep:"")):e=K(t,e),e}function k(t,e){for(var i,n,r,o,a,s,l,c="{",h=!1,d=[];-1!==(l=t.indexOf(c));){if(i=t.slice(0,l),h){for(n=i.split(":"),r=n.shift().split("."),a=r.length,s=e,o=0;a>o;o++)s=s[r[o]];n.length&&(s=w(n.join(":"),s)),d.push(s)}else d.push(i);t=t.slice(l+1),h=!h,c=h?"}":"{"}return d.push(t),d.join("")}function C(t){return me.pow(10,be(me.log(t)/me.LN10))}function T(t,e,i,n){var r,o;for(i=f(i,1),r=t/i,e||(e=[1,2,2.5,5,10],n&&n.allowDecimals===!1&&(1===i?e=[1,2,5,10]:.1>=i&&(e=[1/i]))),o=0;o<e.length&&(t=e[o],!(r<=(e[o]+(e[o+1]||e[o]))/2));o++);return t*=i}function S(){this.color=0,this.symbol=0}function L(t,e){var i,n,r=t.length;for(n=0;r>n;n++)t[n].ss_i=n;for(t.sort(function(t,n){return i=e(t,n),0===i?t.ss_i-n.ss_i:i}),n=0;r>n;n++)delete t[n].ss_i}function M(t){for(var e=t.length,i=t[0];e--;)t[e]<i&&(i=t[e]);return i}function A(t){for(var e=t.length,i=t[0];e--;)t[e]>i&&(i=t[e]);return i}function $(t,e){var i;for(i in t)t[i]&&t[i]!==e&&t[i].destroy&&t[i].destroy(),delete t[i]}function P(t){U||(U=m(Ge)),t&&U.appendChild(t),U.innerHTML=""}function D(t,e){var i="Highcharts error #"+t+": www.highcharts.com/errors/"+t;if(e)throw i;ge.console&&console.log(i)}function O(t){return parseFloat(t.toPrecision(14))}function E(t,e){Z=f(t,e.animation)}function H(){var t=j.global.useUTC,e=t?"getUTC":"get",i=t?"setUTC":"set";ie=6e4*(t&&j.global.timezoneOffset||0),ee=t?Date.UTC:function(t,e,i,n,r,o){return new Date(t,e,f(i,1),f(n,0),f(r,0),f(o,0)).getTime()},ne=e+"Minutes",re=e+"Hours",oe=e+"Day",ae=e+"Date",se=e+"Month",le=e+"FullYear",ce=i+"Minutes",he=i+"Hours",de=i+"Date",ue=i+"Month",pe=i+"FullYear"}function z(t){return j=e(!0,j,t),H(),j}function I(){return j}function W(){}function N(t,e,i,n){this.axis=t,this.pos=e,this.type=i||"",this.isNew=!0,i||n||this.addLabel()}function R(){this.init.apply(this,arguments)}function B(){this.init.apply(this,arguments)}function F(t,e,i,n,r,o){var a=t.chart.inverted;this.axis=t,this.isNegative=i,this.options=e,this.x=n,this.total=null,this.points={},this.stack=r,this.percent="percent"===o,this.alignOptions={align:e.align||(a?i?"left":"right":"center"),verticalAlign:e.verticalAlign||(a?"middle":i?"bottom":"top"),y:f(e.y,a?4:i?14:-6),x:f(e.x,a?i?-6:6:0)},this.textAlign=e.textAlign||(a?i?"right":"left":"center")}function q(t){var e=t.options,i=e.navigator,n=i.enabled,r=e.scrollbar,o=r.enabled,a=n?i.height:0,s=o?r.height:0;this.handles=[],this.scrollbarButtons=[],this.elementsToDestroy=[],this.chart=t,this.setBaseSeries(),this.height=a,this.scrollbarHeight=s,this.scrollbarEnabled=o,this.navigatorEnabled=n,this.navigatorOptions=i,this.scrollbarOptions=r,this.outlineHeight=a+s,this.init()}function G(t){this.init(t)}var X,Y,V,U,j,K,Z,J,Q,te,ee,ie,ne,re,oe,ae,se,le,ce,he,de,ue,pe,fe=document,ge=window,me=Math,ve=me.round,be=me.floor,ye=me.ceil,xe=me.max,_e=me.min,we=me.abs,ke=me.cos,Ce=me.sin,Te=me.PI,Se=2*Te/360,Le=navigator.userAgent,Me=ge.opera,Ae=/msie/i.test(Le)&&!Me,$e=8===fe.documentMode,Pe=/AppleWebKit/.test(Le),De=/Firefox/.test(Le),Oe=/(Mobile|Android|Windows Phone)/.test(Le),Ee="http://www.w3.org/2000/svg",He=!!fe.createElementNS&&!!fe.createElementNS(Ee,"svg").createSVGRect,ze=De&&parseInt(Le.split("Firefox/")[1],10)<4,Ie=!He&&!Ae&&!!fe.createElement("canvas").getContext,We={},Ne=0,Re=function(){},Be=[],Fe="Highstock",qe="1.3.10",Ge="div",Xe="absolute",Ye="relative",Ve="hidden",Ue="highcharts-",je="visible",Ke="px",Ze="none",Je="M",Qe="L",ti=/^[0-9]+$/,ei="",ii="hover",ni="select",ri="millisecond",oi="second",ai="minute",si="hour",li="day",ci="week",hi="month",di="year",ui="stroke-width",pi={},fi=ge.Highcharts=ge.Highcharts?D(16,!0):{};K=function(e,i,n){if(!d(i)||isNaN(i))return"Invalid date";e=f(e,"%Y-%m-%d %H:%M:%S");var r,o=new Date(i-ie),a=o[re](),s=o[oe](),l=o[ae](),c=o[se](),h=o[le](),u=j.lang,p=u.weekdays,g=t({a:p[s].substr(0,3),A:p[s],d:y(l),e:l,b:u.shortMonths[c],B:u.months[c],m:y(c+1),y:h.toString().substr(2,2),Y:h,H:y(a),I:y(a%12||12),l:a%12||12,M:y(o[ne]()),p:12>a?"AM":"PM",P:12>a?"am":"pm",S:y(o.getSeconds()),L:y(ve(i%1e3),3)},fi.dateFormats);for(r in g)for(;-1!==e.indexOf("%"+r);)e=e.replace("%"+r,"function"==typeof g[r]?g[r](i):g[r]);return n?e.substr(0,1).toUpperCase()+e.substr(1):e},S.prototype={wrapColor:function(t){this.color>=t&&(this.color=0)},wrapSymbol:function(t){this.symbol>=t&&(this.symbol=0)}},Q=i(ri,1,oi,1e3,ai,6e4,si,36e5,li,864e5,ci,6048e5,hi,26784e5,di,31556952e3),J={init:function(t,e,i){e=e||"";var n,r,o,a,s,l=t.shift,c=e.indexOf("C")>-1,h=c?7:3,d=e.split(" "),u=[].concat(i),p=function(t){for(o=t.length;o--;)t[o]===Je&&t.splice(o+1,0,t[o+1],t[o+2],t[o+1],t[o+2])};if(c&&(p(d),p(u)),t.isArea&&(a=d.splice(d.length-6,6),s=u.splice(u.length-6,6)),l<=u.length/h&&d.length===u.length)for(;l--;)u=[].concat(u).splice(0,h).concat(u);if(t.shift=0,d.length)for(n=u.length;d.length<n;)r=[].concat(d).splice(d.length-h,h),c&&(r[h-6]=r[h-2],r[h-5]=r[h-1]),d=d.concat(r);return a&&(d=d.concat(a),u=u.concat(s)),[d,u]},step:function(t,e,i,n){var r,o=[],a=t.length;if(1===i)o=n;else if(a===e.length&&1>i)for(;a--;)r=parseFloat(t[a]),o[a]=isNaN(r)?t[a]:i*parseFloat(e[a]-r)+r;else o=e;return o}},function(e){ge.HighchartsAdapter=ge.HighchartsAdapter||e&&{init:function(t){var i,n=e.fx,o=n.step,a=e.Tween,s=a&&a.propHooks,l=e.cssHooks.opacity;e.extend(e.easing,{easeOutQuad:function(t,e,i,n,r){return-n*(e/=r)*(e-2)+i}}),e.each(["cur","_default","width","height","opacity"],function(t,e){var i,r=o;"cur"===e?r=n.prototype:"_default"===e&&a&&(r=s[e],e="set"),i=r[e],i&&(r[e]=function(n){var r;return n=t?n:this,"align"!==n.prop?(r=n.elem,r.attr?r.attr(n.prop,"cur"===e?X:n.now):i.apply(this,arguments)):void 0})}),x(l,"get",function(t,e,i){return e.attr?e.opacity||0:t.call(this,e,i)}),i=function(e){var i,n=e.elem;e.started||(i=t.init(n,n.d,n.toD),e.start=i[0],e.end=i[1],e.started=!0),n.attr("d",t.step(e.start,e.end,e.pos,n.toD))},a?s.d={set:i}:o.d=i,this.each=Array.prototype.forEach?function(t,e){return Array.prototype.forEach.call(t,e)}:function(t,e){for(var i=0,n=t.length;n>i;i++)if(e.call(t[i],t[i],i,t)===!1)return i},e.fn.highcharts=function(){var t,e,i,n="Chart",o=arguments;return r(o[0])&&(n=o[0],o=Array.prototype.slice.call(o,1)),t=o[0],t!==X&&(t.chart=t.chart||{},t.chart.renderTo=this[0],i=new fi[n](t,o[1]),e=this),t===X&&(e=Be[u(this[0],"data-highcharts-chart")]),e}},getScript:e.getScript,inArray:e.inArray,adapterRun:function(t,i){return e(t)[i]()},grep:e.grep,map:function(t,e){for(var i=[],n=0,r=t.length;r>n;n++)i[n]=e.call(t[n],t[n],n,t);return i},offset:function(t){return e(t).offset()},addEvent:function(t,i,n){e(t).bind(i,n)},removeEvent:function(t,i,n){var r=fe.removeEventListener?"removeEventListener":"detachEvent";fe[r]&&t&&!t[r]&&(t[r]=function(){}),e(t).unbind(i,n)},fireEvent:function(i,n,r,o){var a,s=e.Event(n),l="detached"+n;!Ae&&r&&(delete r.layerX,delete r.layerY),t(s,r),i[n]&&(i[l]=i[n],i[n]=null),e.each(["preventDefault","stopPropagation"],function(t,e){var i=s[e];s[e]=function(){try{i.call(s)}catch(t){"preventDefault"===e&&(a=!0)}}}),e(i).trigger(s),i[l]&&(i[n]=i[l],i[l]=null),!o||s.isDefaultPrevented()||a||o(s)},washMouseEvent:function(t){var e=t.originalEvent||t;return e.pageX===X&&(e.pageX=t.pageX,e.pageY=t.pageY),e},animate:function(t,i,n){var r=e(t);t.style||(t.style={}),i.d&&(t.toD=i.d,i.d=1),r.stop(),i.opacity!==X&&t.attr&&(i.opacity+="px"),r.animate(i,n)},stop:function(t){e(t).stop()}}}(ge.jQuery);var gi=ge.HighchartsAdapter,mi=gi||{};gi&&gi.init.call(gi,J);var vi=mi.adapterRun,bi=mi.getScript,yi=mi.inArray,xi=mi.each,_i=mi.grep,wi=mi.offset,ki=mi.map,Ci=mi.addEvent,Ti=mi.removeEvent,Si=mi.fireEvent,Li=mi.washMouseEvent,Mi=mi.animate,Ai=mi.stop,$i={enabled:!0,x:0,y:15,style:{color:"#666",cursor:"default",fontSize:"11px"}};j={colors:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","B","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:!0,canvasToolsURL:"http://code.highcharts.com/stock/1.3.10/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/stock/1.3.10/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:5,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",margin:15,style:{color:"#274b6d",fontSize:"16px"}},subtitle:{text:"",align:"center",style:{color:"#4d759e"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:{enabled:!0,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:e($i,{align:"center",enabled:!1,formatter:function(){return null===this.y?"":b(this.y,-1)},verticalAlign:"bottom",y:0}),cropThreshold:300,pointRange:0,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1e3}},labels:{style:{position:Xe,color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderWidth:1,borderColor:"#909090",borderRadius:5,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{color:"#274b6d",fontSize:"12px"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:Xe,width:"13px",height:"13px"},symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:Ye,top:"1em"},style:{position:Xe,backgroundColor:"white",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:He,backgroundColor:"rgba(255, 255, 255, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b><br/>',shadow:!0,snap:Oe?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var Pi=j.plotOptions,Di=Pi.line;H();var Oi=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,Ei=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,Hi=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,zi=function(t){function i(t){t&&t.stops?c=ki(t.stops,function(t){return zi(t[1])}):(l=Oi.exec(t),l?h=[n(l[1]),n(l[2]),n(l[3]),parseFloat(l[4],10)]:(l=Ei.exec(t),l?h=[n(l[1],16),n(l[2],16),n(l[3],16),1]:(l=Hi.exec(t),l&&(h=[n(l[1]),n(l[2]),n(l[3]),1]))))}function r(i){var n;return c?(n=e(t),n.stops=[].concat(n.stops),xi(c,function(t,e){n.stops[e]=[n.stops[e][0],t.get(i)]})):n=h&&!isNaN(h[0])?"rgb"===i?"rgb("+h[0]+","+h[1]+","+h[2]+")":"a"===i?h[3]:"rgba("+h.join(",")+")":t,n}function o(t){if(c)xi(c,function(e){e.brighten(t)});else if(s(t)&&0!==t){var e;for(e=0;3>e;e++)h[e]+=n(255*t),h[e]<0&&(h[e]=0),h[e]>255&&(h[e]=255)}return this}function a(t){return h[3]=t,this}var l,c,h=[];return i(t),{get:r,brighten:o,rgba:h,setOpacity:a}};W.prototype={init:function(t,e){var i=this;i.element="span"===e?m(e):fe.createElementNS(Ee,e),i.renderer=t,i.attrSetters={}},opacity:1,animate:function(t,i,n){var r=f(i,Z,!0);Ai(this),r?(r=e(r,{}),n&&(r.complete=n),Mi(this,t,r)):(this.attr(t),n&&n())},attr:function(t,e){var i,o,a,s,l,c,h,p,g,m=this,v=m.element,b=v.nodeName.toLowerCase(),y=m.renderer,x=m.attrSetters,_=m.shadows,w=m;if(r(t)&&d(e)&&(i=t,t={},t[i]=e),r(t))i=t,"circle"===b?i={x:"cx",y:"cy"}[i]||i:"strokeWidth"===i&&(i="stroke-width"),w=u(v,i)||m[i]||0,"d"!==i&&"visibility"!==i&&"fill"!==i&&(w=parseFloat(w));else{for(i in t)if(c=!1,o=t[i],a=x[i]&&x[i].call(m,o,i),a!==!1){if(a!==X&&(o=a),"d"===i)o&&o.join&&(o=o.join(" ")),/(NaN| {2}|^$)/.test(o)&&(o="M 0 0");else if("x"===i&&"text"===b)for(s=0;s<v.childNodes.length;s++)l=v.childNodes[s],u(l,"x")===u(v,"x")&&u(l,"x",o);else if(!m.rotation||"x"!==i&&"y"!==i)if("fill"===i)o=y.color(o,v,i);else if("circle"!==b||"x"!==i&&"y"!==i)if("rect"===b&&"r"===i)u(v,{rx:o,ry:o}),c=!0;else if("translateX"===i||"translateY"===i||"rotation"===i||"verticalAlign"===i||"scaleX"===i||"scaleY"===i)g=!0,c=!0;else if("stroke"===i)o=y.color(o,v,i);else if("dashstyle"===i){if(i="stroke-dasharray",o=o&&o.toLowerCase(),"solid"===o)o=Ze;else if(o){for(o=o.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(","),s=o.length;s--;)o[s]=n(o[s])*f(t["stroke-width"],m["stroke-width"]);o=o.join(",")}}else"width"===i?o=n(o):"align"===i?(i="text-anchor",o={left:"start",center:"middle",right:"end"}[o]):"title"===i&&(h=v.getElementsByTagName("title")[0],h||(h=fe.createElementNS(Ee,"title"),v.appendChild(h)),h.textContent=o);else i={x:"cx",y:"cy"}[i]||i;else g=!0;if("strokeWidth"===i&&(i="stroke-width"),("stroke-width"===i||"stroke"===i)&&(m[i]=o,m.stroke&&m["stroke-width"]?(u(v,"stroke",m.stroke),u(v,"stroke-width",m["stroke-width"]),m.hasStroke=!0):"stroke-width"===i&&0===o&&m.hasStroke&&(v.removeAttribute("stroke"),m.hasStroke=!1),c=!0),m.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(i)&&(p||(m.symbolAttr(t),p=!0),c=!0),_&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(i))for(s=_.length;s--;)u(_[s],i,"height"===i?xe(o-(_[s].cutHeight||0),0):o);("width"===i||"height"===i)&&"rect"===b&&0>o&&(o=0),m[i]=o,"text"===i?o!==m.textStr&&(delete m.bBox,m.textStr=o,m.added&&y.buildText(m)):c||void 0!==o&&v.setAttribute(i,o)}g&&m.updateTransform()}return w},addClass:function(t){var e=this.element,i=u(e,"class")||"";return-1===i.indexOf(t)&&u(e,"class",i+" "+t),this},symbolAttr:function(t){var e=this;xi(["x","y","r","start","end","width","height","innerR","anchorX","anchorY"],function(i){e[i]=f(t[i],e[i])}),e.attr({d:e.renderer.symbols[e.symbolName](e.x,e.y,e.width,e.height,e)})},clip:function(t){return this.attr("clip-path",t?"url("+this.renderer.url+"#"+t.id+")":Ze)},crisp:function(t){var e,i,n=this,r={},o=t.strokeWidth||n.strokeWidth||n.attr&&n.attr("stroke-width")||0;i=ve(o)%2/2,t.x=be(t.x||n.x||0)+i,t.y=be(t.y||n.y||0)+i,t.width=be((t.width||n.width||0)-2*i),t.height=be((t.height||n.height||0)-2*i),t.strokeWidth=o;for(e in t)n[e]!==t[e]&&(n[e]=r[e]=t[e]);return r},css:function(e){var i,r,o,a=this,s=a.styles,l={},c=a.element,h="",d=!s;if(e&&e.color&&(e.fill=e.color),s)for(r in e)e[r]!==s[r]&&(l[r]=e[r],d=!0);if(d){if(i=a.textWidth=e&&e.width&&"text"===c.nodeName.toLowerCase()&&n(e.width),s&&(e=t(s,l)),a.styles=e,i&&(Ie||!He&&a.renderer.forExport)&&delete e.width,Ae&&!He)g(a.element,e);else{o=function(t,e){return"-"+e.toLowerCase()};for(r in e)h+=r.replace(/([A-Z])/g,o)+":"+e[r]+";";u(c,"style",h)}i&&a.added&&a.renderer.buildText(a)}return a},on:function(t,e){var i=this,n=i.element;return V&&"click"===t?(n.ontouchstart=function(t){i.touchEventFired=Date.now(),t.preventDefault(),e.call(n,t)},n.onclick=function(t){(-1===Le.indexOf("Android")||Date.now()-(i.touchEventFired||0)>1100)&&e.call(n,t)}):n["on"+t]=e,this},setRadialReference:function(t){return this.element.radialReference=t,this},translate:function(t,e){return this.attr({translateX:t,translateY:e})},invert:function(){var t=this;return t.inverted=!0,t.updateTransform(),t},updateTransform:function(){var t,e=this,i=e.translateX||0,n=e.translateY||0,r=e.scaleX,o=e.scaleY,a=e.inverted,s=e.rotation;a&&(i+=e.attr("width"),n+=e.attr("height")),t=["translate("+i+","+n+")"],a?t.push("rotate(90) scale(-1,1)"):s&&t.push("rotate("+s+" "+(e.x||0)+" "+(e.y||0)+")"),(d(r)||d(o))&&t.push("scale("+f(r,1)+" "+f(o,1)+")"),t.length&&u(e.element,"transform",t.join(" "))},toFront:function(){var t=this.element;return t.parentNode.appendChild(t),this},align:function(t,e,i){var n,o,a,s,l,c={},d=this.renderer,u=d.alignedObjects;return t?(this.alignOptions=t,this.alignByTranslate=e,(!i||r(i))&&(this.alignTo=l=i||"renderer",h(u,this),u.push(this),i=null)):(t=this.alignOptions,e=this.alignByTranslate,l=this.alignTo),i=f(i,d[l],d),n=t.align,o=t.verticalAlign,a=(i.x||0)+(t.x||0),s=(i.y||0)+(t.y||0),("right"===n||"center"===n)&&(a+=(i.width-(t.width||0))/{right:1,center:2}[n]),c[e?"translateX":"x"]=ve(a),("bottom"===o||"middle"===o)&&(s+=(i.height-(t.height||0))/({bottom:1,middle:2}[o]||1)),c[e?"translateY":"y"]=ve(s),this[this.placed?"animate":"attr"](c),this.placed=!0,this.alignAttr=c,this},getBBox:function(){var e,i,n,r=this,o=r.bBox,a=r.renderer,s=r.rotation,l=r.element,c=r.styles,h=s*Se,d=r.textStr;if((""===d||ti.test(d))&&(n=d.toString().length+(c?"|"+c.fontSize+"|"+c.fontFamily:""),o=a.cache[n]),!o){if(l.namespaceURI===Ee||a.forExport){try{o=l.getBBox?t({},l.getBBox()):{width:l.offsetWidth,height:l.offsetHeight}}catch(u){}(!o||o.width<0)&&(o={width:0,height:0})}else o=r.htmlGetBBox();a.isSVG&&(e=o.width,i=o.height,Ae&&c&&"11px"===c.fontSize&&"16.9"===i.toPrecision(3)&&(o.height=i=14),s&&(o.width=we(i*Ce(h))+we(e*ke(h)),o.height=we(i*ke(h))+we(e*Ce(h)))),r.bBox=o,n&&(a.cache[n]=o)}return o},show:function(t){return this.attr({visibility:t?"inherit":je})},hide:function(){return this.attr({visibility:Ve})},fadeOut:function(t){var e=this;e.animate({opacity:0},{duration:t||150,complete:function(){e.hide()}})},add:function(t){var e,i,r,o,a,s=this.renderer,l=t||s,c=l.element||s.box,h=this.element,p=this.zIndex;if(t&&(this.parentGroup=t),this.parentInverted=t&&t.inverted,void 0!==this.textStr&&s.buildText(this),p&&(l.handleZ=!0,p=n(p)),l.handleZ)for(e=c.childNodes,o=0;o<e.length;o++)if(i=e[o],r=u(i,"zIndex"),i!==h&&(n(r)>p||!d(p)&&d(r))){c.insertBefore(h,i),a=!0;break}return a||c.appendChild(h),this.added=!0,this.onAdd&&this.onAdd(),this},safeRemoveChild:function(t){var e=t.parentNode;e&&e.removeChild(t)},destroy:function(){var t,e,i,n=this,r=n.element||{},o=n.shadows,a=n.renderer.isSVG&&"SPAN"===r.nodeName&&n.parentGroup;if(r.onclick=r.onmouseout=r.onmouseover=r.onmousemove=r.point=null,Ai(n),n.clipPath&&(n.clipPath=n.clipPath.destroy()),n.stops){for(i=0;i<n.stops.length;i++)n.stops[i]=n.stops[i].destroy();n.stops=null}for(n.safeRemoveChild(r),o&&xi(o,function(t){n.safeRemoveChild(t)});a&&0===a.div.childNodes.length;)t=a.parentGroup,n.safeRemoveChild(a.div),delete a.div,a=t;n.alignTo&&h(n.renderer.alignedObjects,n);for(e in n)delete n[e];return null},shadow:function(t,e,i){var n,r,o,a,s,l,c=[],h=this.element;if(t){for(a=f(t.width,3),s=(t.opacity||.15)/a,l=this.parentInverted?"(-1,-1)":"("+f(t.offsetX,1)+", "+f(t.offsetY,1)+")",n=1;a>=n;n++)r=h.cloneNode(0),o=2*a+1-2*n,u(r,{isShadow:"true",stroke:t.color||"black","stroke-opacity":s*n,"stroke-width":o,transform:"translate"+l,fill:Ze}),i&&(u(r,"height",xe(u(r,"height")-o,0)),r.cutHeight=o),e?e.element.appendChild(r):h.parentNode.insertBefore(r,h),c.push(r);this.shadows=c}return this}};var Ii=function(){this.init.apply(this,arguments)};Ii.prototype={Element:W,init:function(t,e,i,n,r){var o,a,s,l=this,c=location;o=l.createElement("svg").attr({version:"1.1"}).css(this.getStyle(n)),a=o.element,t.appendChild(a),-1===t.innerHTML.indexOf("xmlns")&&u(a,"xmlns",Ee),l.isSVG=!0,l.box=a,l.boxWrapper=o,l.alignedObjects=[],l.url=(De||Pe)&&fe.getElementsByTagName("base").length?c.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"",s=this.createElement("desc").add(),s.element.appendChild(fe.createTextNode("Created with "+Fe+" "+qe)),l.defs=this.createElement("defs").add(),l.forExport=r,l.gradients={},l.cache={},l.setSize(e,i,!1);var h,d;De&&t.getBoundingClientRect&&(l.subPixelFix=h=function(){g(t,{left:0,top:0}),d=t.getBoundingClientRect(),g(t,{left:ye(d.left)-d.left+Ke,top:ye(d.top)-d.top+Ke})},h(),Ci(ge,"resize",h))},getStyle:function(e){return this.style=t({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif',fontSize:"12px"},e)},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var t=this,e=t.defs;return t.box=null,t.boxWrapper=t.boxWrapper.destroy(),$(t.gradients||{}),t.gradients=null,e&&(t.defs=e.destroy()),t.subPixelFix&&Ti(ge,"resize",t.subPixelFix),t.alignedObjects=null,null},createElement:function(t){var e=new this.Element;return e.init(this,t),e},draw:function(){},buildText:function(t){for(var e=t.element,i=this,r=i.forExport,o=f(t.textStr,"").toString().replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g),a=e.childNodes,s=/<.*style="([^"]+)".*>/,l=/<.*href="(http[^"]+)".*>/,c=u(e,"x"),h=t.styles,d=t.textWidth,p=h&&h.lineHeight,m=a.length,v=function(t){return p?n(p):i.fontMetrics(/(px|em)$/.test(t&&t.style.fontSize)?t.style.fontSize:h.fontSize||11).h};m--;)e.removeChild(a[m]);d&&!t.added&&this.box.appendChild(e),""===o[o.length-1]&&o.pop(),xi(o,function(n,o){var a,p=0;n=n.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||"),a=n.split("|||"),xi(a,function(n){if(""!==n||1===a.length){var f,m={},b=fe.createElementNS(Ee,"tspan");if(s.test(n)&&(f=n.match(s)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),u(b,"style",f)),l.test(n)&&!r&&(u(b,"onclick",'location.href="'+n.match(l)[1]+'"'),g(b,{cursor:"pointer"})),n=(n.replace(/<(.|\n)*?>/g,"")||" ").replace(/&lt;/g,"<").replace(/&gt;/g,">")," "!==n&&(b.appendChild(fe.createTextNode(n)),p?m.dx=0:m.x=c,u(b,m),!p&&o&&(!He&&r&&g(b,{display:"block"}),u(b,"dy",v(b),Pe&&b.offsetHeight)),e.appendChild(b),p++,d))for(var y,x,_,w=n.replace(/([^\^])-/g,"$1- ").split(" "),k=w.length>1&&"nowrap"!==h.whiteSpace,C=t._clipHeight,T=[],S=v(),L=1;k&&(w.length||T.length);)delete t.bBox,_=t.getBBox(),x=_.width,!He&&i.forExport&&(x=i.measureSpanWidth(b.firstChild.data,t.styles)),y=x>d,y&&1!==w.length?(b.removeChild(b.firstChild),T.unshift(w.pop())):(w=T,T=[],w.length&&(L++,C&&L*S>C?(w=["..."],t.attr("title",t.textStr)):(b=fe.createElementNS(Ee,"tspan"),u(b,{dy:S,x:c}),f&&u(b,"style",f),e.appendChild(b),x>d&&(d=x)))),w.length&&b.appendChild(fe.createTextNode(w.join(" ").replace(/- /g,"-")))}})})},button:function(i,n,r,o,a,s,l,c,h){var d,u,p,f,g,m,v=this.label(i,n,r,h,null,null,null,null,"button"),b=0,y="style",x={x1:0,y1:0,x2:0,y2:1};return a=e({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:x,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},a),p=a[y],delete a[y],s=e(a,{stroke:"#68A",fill:{linearGradient:x,stops:[[0,"#FFF"],[1,"#ACF"]]}},s),f=s[y],delete s[y],l=e(a,{stroke:"#68A",fill:{linearGradient:x,stops:[[0,"#9BD"],[1,"#CDF"]]}},l),g=l[y],delete l[y],c=e(a,{style:{color:"#CCC"}},c),m=c[y],delete c[y],Ci(v.element,Ae?"mouseover":"mouseenter",function(){3!==b&&v.attr(s).css(f)}),Ci(v.element,Ae?"mouseout":"mouseleave",function(){3!==b&&(d=[a,s,l][b],u=[p,f,g][b],v.attr(d).css(u))}),v.setState=function(t){v.state=b=t,t?2===t?v.attr(l).css(g):3===t&&v.attr(c).css(m):v.attr(a).css(p)},v.on("click",function(){3!==b&&o.call(v)}).attr(a).css(t({cursor:"default"},p))},crispLine:function(t,e){return t[1]===t[4]&&(t[1]=t[4]=ve(t[1])-e%2/2),t[2]===t[5]&&(t[2]=t[5]=ve(t[2])+e%2/2),t},path:function(e){var i={fill:Ze};return a(e)?i.d=e:o(e)&&t(i,e),this.createElement("path").attr(i)},circle:function(t,e,i){var n=o(t)?t:{x:t,y:e,r:i};return this.createElement("circle").attr(n)},arc:function(t,e,i,n,r,a){var s;return o(t)&&(e=t.y,i=t.r,n=t.innerR,r=t.start,a=t.end,t=t.x),s=this.symbol("arc",t||0,e||0,i||0,i||0,{innerR:n||0,start:r||0,end:a||0}),s.r=i,s},rect:function(t,e,i,n,r,a){r=o(t)?t.r:r;var s=this.createElement("rect"),l=o(t)?t:t===X?{}:{x:t,y:e,width:xe(i,0),height:xe(n,0)};return a!==X&&(l.strokeWidth=a,l=s.crisp(l)),r&&(l.r=r),s.attr(l)},setSize:function(t,e,i){var n=this,r=n.alignedObjects,o=r.length;for(n.width=t,n.height=e,n.boxWrapper[f(i,!0)?"animate":"attr"]({width:t,height:e});o--;)r[o].align()},g:function(t){var e=this.createElement("g");return d(t)?e.attr({"class":Ue+t}):e},image:function(e,i,n,r,o){var a,s={preserveAspectRatio:Ze};return arguments.length>1&&t(s,{x:i,y:n,width:r,height:o}),a=this.createElement("image").attr(s),a.element.setAttributeNS?a.element.setAttributeNS("http://www.w3.org/1999/xlink","href",e):a.element.setAttribute("hc-svg-href",e),a},symbol:function(e,i,n,r,o,a){var s,l,c,h,d,u=this.symbols[e],p=u&&u(ve(i),ve(n),r,o,a),f=/^url\((.*?)\)$/;return p?(s=this.path(p),t(s,{symbolName:e,x:i,y:n,width:r,height:o}),a&&t(s,a)):f.test(e)&&(d=function(t,e){t.element&&(t.attr({width:e[0],height:e[1]}),t.alignByTranslate||t.translate(ve((r-e[0])/2),ve((o-e[1])/2)))},c=e.match(f)[1],h=We[c],s=this.image(c).attr({x:i,y:n}),s.isImg=!0,h?d(s,h):(s.attr({width:0,height:0}),l=m("img",{onload:function(){d(s,We[c]=[this.width,this.height])},src:c}))),s},symbols:{circle:function(t,e,i,n){var r=.166*i;return[Je,t+i/2,e,"C",t+i+r,e,t+i+r,e+n,t+i/2,e+n,"C",t-r,e+n,t-r,e,t+i/2,e,"Z"]},square:function(t,e,i,n){return[Je,t,e,Qe,t+i,e,t+i,e+n,t,e+n,"Z"]},triangle:function(t,e,i,n){return[Je,t+i/2,e,Qe,t+i,e+n,t,e+n,"Z"]},"triangle-down":function(t,e,i,n){return[Je,t,e,Qe,t+i,e,t+i/2,e+n,"Z"]},diamond:function(t,e,i,n){return[Je,t+i/2,e,Qe,t+i,e+n/2,t+i/2,e+n,t,e+n/2,"Z"]
},arc:function(t,e,i,n,r){var o=r.start,a=r.r||i||n,s=r.end-.001,l=r.innerR,c=r.open,h=ke(o),d=Ce(o),u=ke(s),p=Ce(s),f=r.end-o<Te?0:1;return[Je,t+a*h,e+a*d,"A",a,a,0,f,1,t+a*u,e+a*p,c?Je:Qe,t+l*u,e+l*p,"A",l,l,0,f,0,t+l*h,e+l*d,c?"":"Z"]}},clipRect:function(t,e,i,n){var r,o=Ue+Ne++,a=this.createElement("clipPath").attr({id:o}).add(this.defs);return r=this.rect(t,e,i,n,0).add(a),r.id=o,r.clipPath=a,r},color:function(t,i,n){var r,o,s,l,c,h,p,f,g,m,v,b=this,y=/^rgba/,x=[];if(t&&t.linearGradient?o="linearGradient":t&&t.radialGradient&&(o="radialGradient"),o){s=t[o],l=b.gradients,h=t.stops,g=i.radialReference,a(s)&&(t[o]=s={x1:s[0],y1:s[1],x2:s[2],y2:s[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===o&&g&&!d(s.gradientUnits)&&(s=e(s,{cx:g[0]-g[2]/2+s.cx*g[2],cy:g[1]-g[2]/2+s.cy*g[2],r:s.r*g[2],gradientUnits:"userSpaceOnUse"}));for(m in s)"id"!==m&&x.push(m,s[m]);for(m in h)x.push(h[m]);return x=x.join(","),l[x]?v=l[x].id:(s.id=v=Ue+Ne++,l[x]=c=b.createElement(o).attr(s).add(b.defs),c.stops=[],xi(h,function(t){var e;y.test(t[1])?(r=zi(t[1]),p=r.get("rgb"),f=r.get("a")):(p=t[1],f=1),e=b.createElement("stop").attr({offset:t[0],"stop-color":p,"stop-opacity":f}).add(c),c.stops.push(e)})),"url("+b.url+"#"+v+")"}return y.test(t)?(r=zi(t),u(i,n+"-opacity",r.get("a")),r.get("rgb")):(i.removeAttribute(n+"-opacity"),t)},text:function(t,e,i,n){var r,o=this,a=Ie||!He&&o.forExport;return n&&!o.forExport?o.html(t,e,i):(e=ve(f(e,0)),i=ve(f(i,0)),r=o.createElement("text").attr({x:e,y:i,text:t}),a&&r.css({position:Xe}),r.x=e,r.y=i,r)},fontMetrics:function(t){t=t||this.style.fontSize,t=/px/.test(t)?n(t):/em/.test(t)?12*parseFloat(t):12;var e=24>t?t+4:ve(1.2*t),i=ve(.8*e);return{h:e,b:i}},label:function(i,n,r,o,a,s,l,c,h){function u(){var t,i,n=T.element.style;m=(void 0===v||void 0===b||C.styles.textAlign)&&T.textStr&&T.getBBox(),C.width=(v||m.width||0)+2*L+M,C.height=(b||m.height||0)+2*L,_=L+k.fontMetrics(n&&n.fontSize).b,w&&(g||(t=ve(-S*L),i=c?-_:0,C.box=g=o?k.symbol(o,t,i,C.width,C.height,$):k.rect(t,i,C.width,C.height,0,$[ui]),g.attr("fill",Ze).add(C)),g.isImg||g.attr(e({width:C.width,height:C.height},$)),$=null)}function p(){var t,e=C.styles,i=e&&e.textAlign,n=M+L*(1-S);t=c?0:_,d(v)&&m&&("center"===i||"right"===i)&&(n+={center:.5,right:1}[i]*(v-m.width)),(n!==T.x||t!==T.y)&&T.attr({x:n,y:t}),T.x=n,T.y=t}function f(t,e){g?g.attr(t,e):$[t]=e}var g,m,v,b,y,x,_,w,k=this,C=k.g(h),T=k.text("",0,0,l).attr({zIndex:1}),S=0,L=3,M=0,A=0,$={},P=C.attrSetters;C.onAdd=function(){T.add(C),C.attr({text:i,x:n,y:r}),g&&d(a)&&C.attr({anchorX:a,anchorY:s})},P.width=function(t){return v=t,!1},P.height=function(t){return b=t,!1},P.padding=function(t){return d(t)&&t!==L&&(L=t,p()),!1},P.paddingLeft=function(t){return d(t)&&t!==M&&(M=t,p()),!1},P.align=function(t){return S={left:0,center:.5,right:1}[t],!1},P.text=function(t,e){return T.attr(e,t),u(),p(),!1},P[ui]=function(t,e){return t&&(w=!0),A=t%2/2,f(e,t),!1},P.stroke=P.fill=P.r=function(t,e){return"fill"===e&&t&&(w=!0),f(e,t),!1},P.anchorX=function(t,e){return a=t,f(e,t+A-y),!1},P.anchorY=function(t,e){return s=t,f(e,t-x),!1},P.x=function(t){return C.x=t,t-=S*((v||m.width)+L),y=ve(t),C.attr("translateX",y),!1},P.y=function(t){return x=C.y=ve(t),C.attr("translateY",x),!1};var D=C.css;return t(C,{css:function(t){if(t){var i={};t=e(t),xi(["fontSize","fontWeight","fontFamily","color","lineHeight","width","textDecoration","textShadow"],function(e){t[e]!==X&&(i[e]=t[e],delete t[e])}),T.css(i)}return D.call(C,t)},getBBox:function(){return{width:m.width+2*L,height:m.height+2*L,x:m.x-L,y:m.y-L}},shadow:function(t){return g&&g.shadow(t),C},destroy:function(){Ti(C.element,"mouseenter"),Ti(C.element,"mouseleave"),T&&(T=T.destroy()),g&&(g=g.destroy()),W.prototype.destroy.call(C),C=k=u=p=f=null}})}},Y=Ii,t(W.prototype,{htmlCss:function(e){var i=this,n=i.element,r=e&&"SPAN"===n.tagName&&e.width;return r&&(delete e.width,i.textWidth=r,i.updateTransform()),i.styles=t(i.styles,e),g(i.element,e),i},htmlGetBBox:function(){var t=this,e=t.element,i=t.bBox;return i||("text"===e.nodeName&&(e.style.position=Xe),i=t.bBox={x:e.offsetLeft,y:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}),i},htmlUpdateTransform:function(){if(!this.added)return this.alignOnAdd=!0,void 0;var t=this,e=t.renderer,i=t.element,r=t.translateX||0,o=t.translateY||0,a=t.x||0,s=t.y||0,l=t.textAlign||"left",c={left:0,center:.5,right:1}[l],h=t.shadows;if(g(i,{marginLeft:r,marginTop:o}),h&&xi(h,function(t){g(t,{marginLeft:r+1,marginTop:o+1})}),t.inverted&&xi(i.childNodes,function(t){e.invertChild(t,i)}),"SPAN"===i.tagName){var u,p,m=t.rotation,v=n(t.textWidth),b=[m,l,i.innerHTML,t.textWidth].join(",");b!==t.cTT&&(p=e.fontMetrics(i.style.fontSize).b,d(m)&&t.setSpanRotation(m,c,p),u=f(t.elemWidth,i.offsetWidth),u>v&&/[ \-]/.test(i.textContent||i.innerText)&&(g(i,{width:v+Ke,display:"block",whiteSpace:"normal"}),u=v),t.getSpanCorrection(u,p,c,m,l)),g(i,{left:a+(t.xCorr||0)+Ke,top:s+(t.yCorr||0)+Ke}),Pe&&(p=i.offsetHeight),t.cTT=b}},setSpanRotation:function(t,e,i){var n={},r=Ae?"-ms-transform":Pe?"-webkit-transform":De?"MozTransform":Me?"-o-transform":"";n[r]=n.transform="rotate("+t+"deg)",n[r+(De?"Origin":"-origin")]=n.transformOrigin=100*e+"% "+i+"px",g(this.element,n)},getSpanCorrection:function(t,e,i){this.xCorr=-t*i,this.yCorr=-e}}),t(Ii.prototype,{html:function(e,i,n){var r=this.createElement("span"),o=r.attrSetters,a=r.element,s=r.renderer;return o.text=function(t){return t!==a.innerHTML&&delete this.bBox,a.innerHTML=this.textStr=t,!1},o.x=o.y=o.align=o.rotation=function(t,e){return"align"===e&&(e="textAlign"),r[e]=t,r.htmlUpdateTransform(),!1},r.attr({text:e,x:ve(i),y:ve(n)}).css({position:Xe,whiteSpace:"nowrap",fontFamily:this.style.fontFamily,fontSize:this.style.fontSize}),r.css=r.htmlCss,s.isSVG&&(r.add=function(e){var i,n,o=s.box.parentNode,l=[];if(this.parentGroup=e,e){if(i=e.div,!i){for(n=e;n;)l.push(n),n=n.parentGroup;xi(l.reverse(),function(e){var n;i=e.div=e.div||m(Ge,{className:u(e.element,"class")},{position:Xe,left:(e.translateX||0)+Ke,top:(e.translateY||0)+Ke},i||o),n=i.style,t(e.attrSetters,{translateX:function(t){n.left=t+Ke},translateY:function(t){n.top=t+Ke},visibility:function(t,e){n[e]=t}})})}}else i=o;return i.appendChild(a),r.added=!0,r.alignOnAdd&&r.htmlUpdateTransform(),r}),r}});var Wi,Ni;if(!He&&!Ie){fi.VMLElement=Ni={init:function(t,e){var i=this,n=["<",e,' filled="f" stroked="f"'],r=["position: ",Xe,";"],o=e===Ge;("shape"===e||o)&&r.push("left:0;top:0;width:1px;height:1px;"),r.push("visibility: ",o?Ve:je),n.push(' style="',r.join(""),'"/>'),e&&(n=o||"span"===e||"img"===e?n.join(""):t.prepVML(n),i.element=m(n)),i.renderer=t,i.attrSetters={}},add:function(t){var e=this,i=e.renderer,n=e.element,r=i.box,o=t&&t.inverted,a=t?t.element||t:r;return o&&i.invertChild(n,a),a.appendChild(n),e.added=!0,e.alignOnAdd&&!e.deferUpdateTransform&&e.updateTransform(),e.onAdd&&e.onAdd(),e},updateTransform:W.prototype.htmlUpdateTransform,setSpanRotation:function(){var t=this.rotation,e=ke(t*Se),i=Ce(t*Se);g(this.element,{filter:t?["progid:DXImageTransform.Microsoft.Matrix(M11=",e,", M12=",-i,", M21=",i,", M22=",e,", sizingMethod='auto expand')"].join(""):Ze})},getSpanCorrection:function(t,e,i,n,r){var o,a=n?ke(n*Se):1,s=n?Ce(n*Se):0,l=f(this.elemHeight,this.element.offsetHeight),c=r&&"left"!==r;this.xCorr=0>a&&-t,this.yCorr=0>s&&-l,o=0>a*s,this.xCorr+=s*e*(o?1-i:i),this.yCorr-=a*e*(n?o?i:1-i:1),c&&(this.xCorr-=t*i*(0>a?-1:1),n&&(this.yCorr-=l*i*(0>s?-1:1)),g(this.element,{textAlign:r}))},pathToVML:function(t){for(var e=t.length,i=[];e--;)s(t[e])?i[e]=ve(10*t[e])-5:"Z"===t[e]?i[e]="x":(i[e]=t[e],!t.isArc||"wa"!==t[e]&&"at"!==t[e]||(i[e+5]===i[e+7]&&(i[e+7]+=t[e+7]>t[e+5]?1:-1),i[e+6]===i[e+8]&&(i[e+8]+=t[e+8]>t[e+6]?1:-1)));return i.join(" ")||"x"},attr:function(t,e){var i,n,o,a,l,c,h=this,p=h.element||{},f=p.style,g=p.nodeName,v=h.renderer,b=h.symbolName,y=h.shadows,x=h.attrSetters,_=h;if(r(t)&&d(e)&&(i=t,t={},t[i]=e),r(t))i=t,_="strokeWidth"===i||"stroke-width"===i?h.strokeweight:h[i];else for(i in t)if(n=t[i],c=!1,a=x[i]&&x[i].call(h,n,i),a!==!1&&null!==n){if(a!==X&&(n=a),b&&/^(x|y|r|start|end|width|height|innerR|anchorX|anchorY)/.test(i))l||(h.symbolAttr(t),l=!0),c=!0;else if("d"===i){if(n=n||[],h.d=n.join(" "),p.path=n=h.pathToVML(n),y)for(o=y.length;o--;)y[o].path=y[o].cutOff?this.cutOffPath(n,y[o].cutOff):n;c=!0}else if("visibility"===i){if("inherit"===n&&(n=je),y)for(o=y.length;o--;)y[o].style[i]=n;"DIV"===g&&(n=n===Ve?"-999em":0,$e||(f[i]=n?je:Ve),i="top"),f[i]=n,c=!0}else if("zIndex"===i)n&&(f[i]=n),c=!0;else if(-1!==yi(i,["x","y","width","height"]))h[i]=n,"x"===i||"y"===i?i={x:"left",y:"top"}[i]:n=xe(0,n),h.updateClipping?(h[i]=n,h.updateClipping()):f[i]=n,c=!0;else if("class"===i&&"DIV"===g)p.className=n;else if("stroke"===i)n=v.color(n,p,i),i="strokecolor";else if("stroke-width"===i||"strokeWidth"===i)p.stroked=n?!0:!1,i="strokeweight",h[i]=n,s(n)&&(n+=Ke);else if("dashstyle"===i){var w=p.getElementsByTagName("stroke")[0]||m(v.prepVML(["<stroke/>"]),null,null,p);w[i]=n||"solid",h.dashstyle=n,c=!0}else"fill"===i?"SPAN"===g?f.color=n:"IMG"!==g&&(p.filled=n!==Ze?!0:!1,n=v.color(n,p,i,h),i="fillcolor"):"opacity"===i?c=!0:"shape"===g&&"rotation"===i?(h[i]=p.style[i]=n,p.style.left=-ve(Ce(n*Se)+1)+Ke,p.style.top=ve(ke(n*Se))+Ke):("translateX"===i||"translateY"===i||"rotation"===i)&&(h[i]=n,h.updateTransform(),c=!0);c||($e?p[i]=n:u(p,i,n))}return _},clip:function(t){var e,i,n=this;return t?(e=t.members,h(e,n),e.push(n),n.destroyClip=function(){h(e,n)},i=t.getCSS(n)):(n.destroyClip&&n.destroyClip(),i={clip:$e?"inherit":"rect(auto)"}),n.css(i)},css:W.prototype.htmlCss,safeRemoveChild:function(t){t.parentNode&&P(t)},destroy:function(){return this.destroyClip&&this.destroyClip(),W.prototype.destroy.apply(this)},on:function(t,e){return this.element["on"+t]=function(){var t=ge.event;t.target=t.srcElement,e(t)},this},cutOffPath:function(t,e){var i;return t=t.split(/[ ,]/),i=t.length,(9===i||11===i)&&(t[i-4]=t[i-2]=n(t[i-2])-10*e),t.join(" ")},shadow:function(t,e,i){var r,o,a,s,l,c,h,d=[],u=this.element,p=this.renderer,g=u.style,v=u.path;if(v&&"string"!=typeof v.value&&(v="x"),l=v,t){for(c=f(t.width,3),h=(t.opacity||.15)/c,r=1;3>=r;r++)s=2*c+1-2*r,i&&(l=this.cutOffPath(v.value,s+.5)),a=['<shape isShadow="true" strokeweight="',s,'" filled="false" path="',l,'" coordsize="10 10" style="',u.style.cssText,'" />'],o=m(p.prepVML(a),null,{left:n(g.left)+f(t.offsetX,1),top:n(g.top)+f(t.offsetY,1)}),i&&(o.cutOff=s+1),a=['<stroke color="',t.color||"black",'" opacity="',h*r,'"/>'],m(p.prepVML(a),null,null,o),e?e.element.appendChild(o):u.parentNode.insertBefore(o,u),d.push(o);this.shadows=d}return this}},Ni=v(W,Ni);var Ri={Element:Ni,isIE8:Le.indexOf("MSIE 8.0")>-1,init:function(e,i,n,r){var o,a,s,l=this;if(l.alignedObjects=[],o=l.createElement(Ge).css(t(this.getStyle(r),{position:Ye})),a=o.element,e.appendChild(o.element),l.isVML=!0,l.box=a,l.boxWrapper=o,l.cache={},l.setSize(i,n,!1),!fe.namespaces.hcv){fe.namespaces.add("hcv","urn:schemas-microsoft-com:vml"),s="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } ";try{fe.createStyleSheet().cssText=s}catch(c){fe.styleSheets[0].cssText+=s}}},isHidden:function(){return!this.box.offsetWidth},clipRect:function(e,i,n,r){var a=this.createElement(),s=o(e);return t(a,{members:[],left:(s?e.x:e)+1,top:(s?e.y:i)+1,width:(s?e.width:n)-1,height:(s?e.height:r)-1,getCSS:function(e){var i=e.element,n=i.nodeName,r="shape"===n,o=e.inverted,a=this,s=a.top-(r?i.offsetTop:0),l=a.left,c=l+a.width,h=s+a.height,d={clip:"rect("+ve(o?l:s)+"px,"+ve(o?h:c)+"px,"+ve(o?c:h)+"px,"+ve(o?s:l)+"px)"};return!o&&$e&&"DIV"===n&&t(d,{width:c+Ke,height:h+Ke}),d},updateClipping:function(){xi(a.members,function(t){t.css(a.getCSS(t))})}})},color:function(t,e,i,n){var r,o,a,s=this,l=/^rgba/,c=Ze;if(t&&t.linearGradient?a="gradient":t&&t.radialGradient&&(a="pattern"),a){var h,d,u,p,f,g,v,b,y,x,_,w,k=t.linearGradient||t.radialGradient,C="",T=t.stops,S=[],L=function(){o=['<fill colors="'+S.join(",")+'" opacity="',b,'" o:opacity2="',v,'" type="',a,'" ',C,'focus="100%" method="any" />'],m(s.prepVML(o),null,null,e)};if(_=T[0],w=T[T.length-1],_[0]>0&&T.unshift([0,_[1]]),w[0]<1&&T.push([1,w[1]]),xi(T,function(t,e){l.test(t[1])?(r=zi(t[1]),h=r.get("rgb"),d=r.get("a")):(h=t[1],d=1),S.push(100*t[0]+"% "+h),e?(b=d,y=h):(v=d,x=h)}),"fill"===i)if("gradient"===a)u=k.x1||k[0]||0,p=k.y1||k[1]||0,f=k.x2||k[2]||0,g=k.y2||k[3]||0,C='angle="'+(90-180*me.atan((g-p)/(f-u))/Te)+'"',L();else{var M,A=k.r,$=2*A,P=2*A,D=k.cx,O=k.cy,E=e.radialReference,H=function(){E&&(M=n.getBBox(),D+=(E[0]-M.x)/M.width-.5,O+=(E[1]-M.y)/M.height-.5,$*=E[2]/M.width,P*=E[2]/M.height),C='src="'+j.global.VMLRadialGradientURL+'" size="'+$+","+P+'" origin="0.5,0.5" position="'+D+","+O+'" color2="'+x+'" ',L()};n.added?H():n.onAdd=H,c=y}else c=h}else if(l.test(t)&&"IMG"!==e.tagName)r=zi(t),o=["<",i,' opacity="',r.get("a"),'"/>'],m(this.prepVML(o),null,null,e),c=r.get("rgb");else{var z=e.getElementsByTagName(i);z.length&&(z[0].opacity=1,z[0].type="solid"),c=t}return c},prepVML:function(t){var e="display:inline-block;behavior:url(#default#VML);",i=this.isIE8;return t=t.join(""),i?(t=t.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),t=-1===t.indexOf('style="')?t.replace("/>",' style="'+e+'" />'):t.replace('style="','style="'+e)):t=t.replace("<","<hcv:"),t},text:Ii.prototype.html,path:function(e){var i={coordsize:"10 10"};return a(e)?i.d=e:o(e)&&t(i,e),this.createElement("shape").attr(i)},circle:function(t,e,i){var n=this.symbol("circle");return o(t)&&(i=t.r,e=t.y,t=t.x),n.isCircle=!0,n.r=i,n.attr({x:t,y:e})},g:function(t){var e,i;return t&&(i={className:Ue+t,"class":Ue+t}),e=this.createElement(Ge).attr(i)},image:function(t,e,i,n,r){var o=this.createElement("img").attr({src:t});return arguments.length>1&&o.attr({x:e,y:i,width:n,height:r}),o},createElement:function(t){return"rect"===t?this.symbol(t):Ii.prototype.createElement.call(this,t)},invertChild:function(t,e){var i=this,r=e.style,o="IMG"===t.tagName&&t.style;g(t,{flip:"x",left:n(r.width)-(o?n(o.top):1),top:n(r.height)-(o?n(o.left):1),rotation:-90}),xi(t.childNodes,function(e){i.invertChild(e,t)})},symbols:{arc:function(t,e,i,n,r){var o,a=r.start,s=r.end,l=r.r||i||n,c=r.innerR,h=ke(a),d=Ce(a),u=ke(s),p=Ce(s);return 0===s-a?["x"]:(o=["wa",t-l,e-l,t+l,e+l,t+l*h,e+l*d,t+l*u,e+l*p],r.open&&!c&&o.push("e",Je,t,e),o.push("at",t-c,e-c,t+c,e+c,t+c*u,e+c*p,t+c*h,e+c*d,"x","e"),o.isArc=!0,o)},circle:function(t,e,i,n,r){return r&&(i=n=2*r.r),r&&r.isCircle&&(t-=i/2,e-=n/2),["wa",t,e,t+i,e+n,t+i,e+n/2,t+i,e+n/2,"e"]},rect:function(t,e,i,n,r){var o,a,s=t+i,l=e+n;return d(r)&&r.r?(a=_e(r.r,i,n),o=[Je,t+a,e,Qe,s-a,e,"wa",s-2*a,e,s,e+2*a,s-a,e,s,e+a,Qe,s,l-a,"wa",s-2*a,l-2*a,s,l,s,l-a,s-a,l,Qe,t+a,l,"wa",t,l-2*a,t+2*a,l,t+a,l,t,l-a,Qe,t,e+a,"wa",t,e,t+2*a,e+2*a,t,e+a,t+a,e,"x","e"]):o=Ii.prototype.symbols.square.apply(0,arguments),o}}};fi.VMLRenderer=Wi=function(){this.init.apply(this,arguments)},Wi.prototype=e(Ii.prototype,Ri),Y=Wi}Ii.prototype.measureSpanWidth=function(t,e){var i,n=fe.createElement("span"),r=fe.createTextNode(t);return n.appendChild(r),g(n,e),this.box.appendChild(n),i=n.offsetWidth,P(n),i};var Bi,Fi;Ie&&(fi.CanVGRenderer=Bi=function(){Ee="http://www.w3.org/1999/xhtml"},Bi.prototype.symbols={},Fi=function(){function t(){var t,i=e.length;for(t=0;i>t;t++)e[t]();e=[]}var e=[];return{push:function(i,n){0===e.length&&bi(n,t),e.push(i)}}}(),Y=Bi),N.prototype={addLabel:function(){var e,i,n,r,o=this,a=o.axis,l=a.options,h=a.chart,u=a.horiz,p=a.categories,g=a.names,m=o.pos,v=l.labels,b=a.tickPositions,y=u&&p&&!v.step&&!v.staggerLines&&!v.rotation&&h.plotWidth/b.length||!u&&(h.margin[3]||.33*h.chartWidth),x=m===b[0],_=m===b[b.length-1],w=p?f(p[m],g[m],m):m,k=o.label,C=b.info;a.isDatetimeAxis&&C&&(r=l.dateTimeLabelFormats[C.higherRanks[m]||C.unitName]),o.isFirst=x,o.isLast=_,e=a.labelFormatter.call({axis:a,chart:h,isFirst:x,isLast:_,dateTimeLabelFormat:r,value:a.isLog?O(c(w)):w}),x?e="<span class='highcharts-first-label'>"+e+"</span>":_&&(e="<span class='highcharts-last-label'>"+e+"</span>"),i=y&&{width:xe(1,ve(y-2*(v.padding||10)))+Ke},i=t(i,v.style),d(k)?k&&k.attr({text:e}).css(i):(n={align:a.labelAlign},s(v.rotation)&&(n.rotation=v.rotation),y&&v.ellipsis&&(n._clipHeight=a.len/b.length),o.label=d(e)&&v.enabled?h.renderer.text(e,0,0,v.useHTML).attr(n).css(i).add(a.labelGroup):null)},getLabelSize:function(){var t=this.label,e=this.axis;return t?t.getBBox()[e.horiz?"height":"width"]:0},getLabelSides:function(){var t=this.label.getBBox(),e=this.axis,i=e.horiz,n=e.options,r=n.labels,o=i?t.width:t.height,a=i?r.x-o*{left:0,center:.5,right:1}[e.labelAlign]:0,s=i?o+a:o;return[a,s]},handleOverflow:function(t,e){var i,n,r,o,a,s=!0,l=this.axis,c=this.isFirst,h=this.isLast,d=l.horiz,u=d?e.x:e.y,p=l.reversed,f=l.tickPositions,g=this.getLabelSides(),m=g[0],v=g[1],b=this.label.line||0,y=l.labelEdge,x=l.justifyLabels&&(c||h);if(y[b]===X||u+m>y[b]?y[b]=u+v:x||(s=!1),x){a=l.justifyToPlot,i=a?l.pos:0,n=a?i+l.len:l.chart.chartWidth;do t+=c?1:-1,r=l.ticks[f[t]];while(f[t]&&(!r||r.label.line!==b));o=r&&r.label.xy&&r.label.xy.x+r.getLabelSides()[c?0:1],c&&!p||h&&p?i>u+m&&(u=i-m,r&&u+v>o&&(s=!1)):u+v>n&&(u=n-v,r&&o>u+m&&(s=!1)),e.x=u}return s},getPosition:function(t,e,i,n){var r=this.axis,o=r.chart,a=n&&o.oldChartHeight||o.chartHeight;return{x:t?r.translate(e+i,null,null,n)+r.transB:r.left+r.offset+(r.opposite?(n&&o.oldChartWidth||o.chartWidth)-r.right-r.left:0),y:t?a-r.bottom+r.offset-(r.opposite?r.height:0):a-r.translate(e+i,null,null,n)-r.transB}},getLabelPosition:function(t,e,i,n,r,o,a,s){var l=this.axis,c=l.transA,h=l.reversed,u=l.staggerLines,p=l.chart.renderer.fontMetrics(r.style.fontSize).b,f=r.rotation;return t=t+r.x-(o&&n?o*c*(h?-1:1):0),e=e+r.y-(o&&!n?o*c*(h?1:-1):0),f&&2===l.side&&(e-=p-p*ke(f*Se)),d(r.y)||f||(e+=p-i.getBBox().height/2),u&&(i.line=a/(s||1)%u,e+=i.line*(l.labelOffset/u)),{x:t,y:e}},getMarkPath:function(t,e,i,n,r,o){return o.crispLine([Je,t,e,Qe,t+(r?0:-i),e+(r?i:0)],n)},render:function(t,e,i){var n,r,o,a=this,s=a.axis,l=s.options,c=s.chart,h=c.renderer,d=s.horiz,u=a.type,p=a.label,g=a.pos,m=l.labels,v=a.gridLine,b=u?u+"Grid":"grid",y=u?u+"Tick":"tick",x=l[b+"LineWidth"],_=l[b+"LineColor"],w=l[b+"LineDashStyle"],k=l[y+"Length"],C=l[y+"Width"]||0,T=l[y+"Color"],S=l[y+"Position"],L=a.mark,M=m.step,A=!0,$=s.tickmarkOffset,P=a.getPosition(d,g,$,e),D=P.x,O=P.y,E=d&&D===s.pos+s.len||!d&&O===s.pos?-1:1;this.isActive=!0,x&&(n=s.getPlotLinePath(g+$,x*E,e,!0),v===X&&(o={stroke:_,"stroke-width":x},w&&(o.dashstyle=w),u||(o.zIndex=1),e&&(o.opacity=0),a.gridLine=v=x?h.path(n).attr(o).add(s.gridGroup):null),!e&&v&&n&&v[a.isNew?"attr":"animate"]({d:n,opacity:i})),C&&k&&("inside"===S&&(k=-k),s.opposite&&(k=-k),r=a.getMarkPath(D,O,k,C*E,d,h),L?L.animate({d:r,opacity:i}):a.mark=h.path(r).attr({stroke:T,"stroke-width":C,opacity:i}).add(s.axisGroup)),p&&!isNaN(D)&&(p.xy=P=a.getLabelPosition(D,O,p,d,m,$,t,M),a.isFirst&&!a.isLast&&!f(l.showFirstLabel,1)||a.isLast&&!a.isFirst&&!f(l.showLastLabel,1)?A=!1:s.isRadial||m.step||m.rotation||e||0===i||(A=a.handleOverflow(t,P)),M&&t%M&&(A=!1),A&&!isNaN(P.y)?(P.opacity=i,p[a.isNew?"attr":"animate"](P),a.isNew=!1):p.attr("y",-9999))},destroy:function(){$(this,this.axis)}},fi.PlotLineOrBand=function(t,e){this.axis=t,e&&(this.options=e,this.id=e.id)},fi.PlotLineOrBand.prototype={render:function(){var t,i,n,r,o,a,s,c=this,h=c.axis,u=h.horiz,p=(h.pointRange||0)/2,g=c.options,m=g.label,v=c.label,b=g.width,y=g.to,x=g.from,_=d(x)&&d(y),w=g.value,k=g.dashStyle,C=c.svgElem,T=[],S=g.color,L=g.zIndex,$=g.events,P=h.chart.renderer;if(h.isLog&&(x=l(x),y=l(y),w=l(w)),b)T=h.getPlotLinePath(w,b),s={stroke:S,"stroke-width":b},k&&(s.dashstyle=k);else{if(!_)return;x=xe(x,h.min-p),y=_e(y,h.max+p),T=h.getPlotBandPath(x,y,g),s={fill:S},g.borderWidth&&(s.stroke=g.borderColor,s["stroke-width"]=g.borderWidth)}if(d(L)&&(s.zIndex=L),C)T?C.animate({d:T},null,C.onGetPath):(C.hide(),C.onGetPath=function(){C.show()},v&&(c.label=v=v.destroy()));else if(T&&T.length&&(c.svgElem=C=P.path(T).attr(s).add(),$)){t=function(t){C.on(t,function(e){$[t].apply(c,[e])})};for(i in $)t(i)}return m&&d(m.text)&&T&&T.length&&h.width>0&&h.height>0?(m=e({align:u&&_&&"center",x:u?!_&&4:10,verticalAlign:!u&&_&&"middle",y:u?_?16:10:_?6:-4,rotation:u&&!_&&90},m),v||(c.label=v=P.text(m.text,0,0,m.useHTML).attr({align:m.textAlign||m.align,rotation:m.rotation,zIndex:L}).css(m.style).add()),n=[T[1],T[4],f(T[6],T[1])],r=[T[2],T[5],f(T[7],T[2])],o=M(n),a=M(r),v.align(m,!1,{x:o,y:a,width:A(n)-o,height:A(r)-a}),v.show()):v&&v.hide(),c},destroy:function(){h(this.axis.plotLinesAndBands,this),delete this.axis,$(this)}},te={getPlotBandPath:function(t,e){var i=this.getPlotLinePath(e),n=this.getPlotLinePath(t);return n&&i?n.push(i[4],i[5],i[1],i[2]):n=null,n},addPlotBand:function(t){this.addPlotBandOrLine(t,"plotBands")},addPlotLine:function(t){this.addPlotBandOrLine(t,"plotLines")},addPlotBandOrLine:function(t,e){var i=new fi.PlotLineOrBand(this,t).render(),n=this.userOptions;return i&&(e&&(n[e]=n[e]||[],n[e].push(t)),this.plotLinesAndBands.push(i)),i},removePlotBandOrLine:function(t){for(var e=this.plotLinesAndBands,i=this.options,n=this.userOptions,r=e.length;r--;)e[r].id===t&&e[r].destroy();xi([i.plotLines||[],n.plotLines||[],i.plotBands||[],n.plotBands||[]],function(e){for(r=e.length;r--;)e[r].id===t&&h(e,e[r])})}},R.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#C0C0C0",labels:$i,lineColor:"#C0D0E0",lineWidth:1,minPadding:.01,maxPadding:.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:5,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",style:{color:"#4d759e",fontWeight:"bold"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8,y:3},lineWidth:0,maxPadding:.05,minPadding:.05,startOnTick:!0,tickWidth:0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return b(this.total,-1)},style:$i.style}},defaultLeftAxisOptions:{labels:{x:-8,y:null},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:8,y:null},title:{rotation:90}},defaultBottomAxisOptions:{labels:{x:0,y:14},title:{rotation:0}},defaultTopAxisOptions:{labels:{x:0,y:-5},title:{rotation:0}},init:function(t,e){var i=e.isX,n=this;n.horiz=t.inverted?!i:i,n.isXAxis=i,n.coll=i?"xAxis":"yAxis",n.opposite=e.opposite,n.side=e.side||(n.horiz?n.opposite?0:2:n.opposite?1:3),n.setOptions(e);var r=this.options,o=r.type,a="datetime"===o;n.labelFormatter=r.labels.formatter||n.defaultLabelFormatter,n.userOptions=e,n.minPixelPadding=0,n.chart=t,n.reversed=r.reversed,n.zoomEnabled=r.zoomEnabled!==!1,n.categories=r.categories||"category"===o,n.names=[],n.isLog="logarithmic"===o,n.isDatetimeAxis=a,n.isLinked=d(r.linkedTo),n.tickmarkOffset=n.categories&&"between"===r.tickmarkPlacement?.5:0,n.ticks={},n.labelEdge=[],n.minorTicks={},n.plotLinesAndBands=[],n.alternateBands={},n.len=0,n.minRange=n.userMinRange=r.minRange||r.maxZoom,n.range=r.range,n.offset=r.offset||0,n.stacks={},n.oldStacks={},n.max=null,n.min=null,n.crosshair=f(r.crosshair,p(t.options.tooltip.crosshairs)[i?0:1],!1);var s,h=n.options.events;-1===yi(n,t.axes)&&(i&&!this.isColorAxis?t.axes.splice(t.xAxis.length,0,n):t.axes.push(n),t[n.coll].push(n)),n.series=n.series||[],t.inverted&&i&&n.reversed===X&&(n.reversed=!0),n.removePlotBand=n.removePlotBandOrLine,n.removePlotLine=n.removePlotBandOrLine;for(s in h)Ci(n,s,h[s]);n.isLog&&(n.val2lin=l,n.lin2val=c)},setOptions:function(t){this.options=e(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],e(j[this.coll],t))},defaultLabelFormatter:function(){var t,e,i=this.axis,n=this.value,r=i.categories,o=this.dateTimeLabelFormat,a=j.lang.numericSymbols,s=a&&a.length,l=i.options.labels.format,c=i.isLog?n:i.tickInterval;if(l)e=k(l,this);else if(r)e=n;else if(o)e=K(o,n);else if(s&&c>=1e3)for(;s--&&e===X;)t=Math.pow(1e3,s+1),c>=t&&null!==a[s]&&(e=i.options&&i.options.labels&&i.options.labels.isMoney?b(n/t,-1,void 0,void 0,!0)+a[s]:b(n/t,-1)+a[s]);return e===X&&(e=n>=1e4?b(n,0):b(n,-1,X,"")),e},getSeriesExtremes:function(){var t=this,e=t.chart;t.hasVisibleSeries=!1,t.dataMin=t.dataMax=null,t.buildStacks&&t.buildStacks(),xi(t.series,function(i){if(i.visible||!e.options.chart.ignoreHiddenSeries){var n,r,o,a=i.options,s=a.threshold;t.hasVisibleSeries=!0,t.isLog&&0>=s&&(s=null),t.isXAxis?(n=i.xData,n.length&&(t.dataMin=_e(f(t.dataMin,n[0]),M(n)),t.dataMax=xe(f(t.dataMax,n[0]),A(n)))):(i.getExtremes(),o=i.dataMax,r=i.dataMin,d(r)&&d(o)&&(t.dataMin=_e(f(t.dataMin,r),r),t.dataMax=xe(f(t.dataMax,o),o)),d(s)&&(t.dataMin>=s?(t.dataMin=s,t.ignoreMinPadding=!0):t.dataMax<s&&(t.dataMax=s,t.ignoreMaxPadding=!0)))}})},translate:function(t,e,i,n,r,o){var a,l=this,c=1,h=0,d=n?l.oldTransA:l.transA,u=n?l.oldMin:l.min,p=l.minPixelPadding,f=(l.options.ordinal||l.isLog&&r)&&l.lin2val;return d||(d=l.transA),i&&(c*=-1,h=l.len),l.reversed&&(c*=-1,h-=c*(l.sector||l.len)),e?(t=t*c+h,t-=p,a=t/d+u,f&&(a=l.lin2val(a))):(f&&(t=l.val2lin(t)),"between"===o&&(o=.5),a=c*(t-u)*d+h+c*p+(s(o)?d*o*l.pointRange:0)),a},toPixels:function(t,e){return this.translate(t,!1,!this.horiz,null,!0)+(e?0:this.pos)},toValue:function(t,e){return this.translate(t-(e?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(t,e,i,n,r){var o,a,s,l,c,h=this,d=h.chart,u=h.left,p=h.top,g=i&&d.oldChartHeight||d.chartHeight,m=i&&d.oldChartWidth||d.chartWidth,v=h.transB;return r=f(r,h.translate(t,null,null,i)),o=s=ve(r+v),a=l=ve(g-r-v),isNaN(r)?c=!0:h.horiz?(a=p,l=g-h.bottom,(u>o||o>u+h.width)&&(c=!0)):(o=u,s=m-h.right,(p>a||a>p+h.height)&&(c=!0)),c&&!n?null:d.renderer.crispLine([Je,o,a,Qe,s,l],e||1)},getLinearTickPositions:function(t,e,i){var n,r,o=O(be(e/t)*t),a=O(ye(i/t)*t),s=[];for(n=o;a>=n&&(s.push(n),n=O(n+t),n!==r);)r=n;return s},getMinorTickPositions:function(){var t,e,i,n=this,r=n.options,o=n.tickPositions,a=n.minorTickInterval,s=[];if(n.isLog)for(i=o.length,e=1;i>e;e++)s=s.concat(n.getLogTickPositions(a,o[e-1],o[e],!0));else if(n.isDatetimeAxis&&"auto"===r.minorTickInterval)s=s.concat(n.getTimeTicks(n.normalizeTimeTickInterval(a),n.min,n.max,r.startOfWeek)),s[0]<n.min&&s.shift();else for(t=n.min+(o[0]-n.min)%a;t<=n.max;t+=a)s.push(t);return s},adjustForMinRange:function(){var t,e,i,n,r,o,a,s,l=this,c=l.options,h=l.min,u=l.max,p=l.dataMax-l.dataMin>=l.minRange;if(l.isXAxis&&l.minRange===X&&!l.isLog&&(d(c.min)||d(c.max)?l.minRange=null:(xi(l.series,function(t){for(r=t.xData,o=t.xIncrement?1:r.length-1,i=o;i>0;i--)n=r[i]-r[i-1],(e===X||e>n)&&(e=n)}),l.minRange=_e(5*e,l.dataMax-l.dataMin))),u-h<l.minRange){var g=l.minRange;t=(g-u+h)/2,a=[h-t,f(c.min,h-t)],p&&(a[2]=l.dataMin),h=A(a),s=[h+g,f(c.max,h+g)],p&&(s[2]=l.dataMax),u=M(s),g>u-h&&(a[0]=u-g,a[1]=f(c.min,u-g),h=A(a))}l.min=h,l.max=u},setAxisTranslation:function(t){var e,i,n=this,o=n.max-n.min,a=n.axisPointRange||0,s=0,l=0,c=n.linkedParent,h=!!n.categories,u=n.transA;(n.isXAxis||h||a)&&(c?(s=c.minPointOffset,l=c.pointRangePadding):xi(n.series,function(t){var i=xe(n.isXAxis?t.pointRange:n.axisPointRange||0,+h),c=t.options.pointPlacement,u=t.closestPointRange;i>o&&(i=0),a=xe(a,i),s=xe(s,r(c)?0:i/2),l=xe(l,"on"===c?0:i),!t.noSharedTooltip&&d(u)&&(e=d(e)?_e(e,u):u)}),i=n.ordinalSlope&&e?n.ordinalSlope/e:1,n.minPointOffset=s*=i,n.pointRangePadding=l*=i,n.pointRange=_e(a,o),n.closestPointRange=e),t&&(n.oldTransA=u),n.translationSlope=n.transA=u=n.len/(o+l||1),n.transB=n.horiz?n.left:n.bottom,n.minPixelPadding=u*s},setTickPositions:function(t){var e,i,n,r,o=this,a=o.chart,s=o.options,c=o.isLog,h=o.isDatetimeAxis,u=o.isXAxis,p=o.isLinked,g=o.options.tickPositioner,m=s.maxPadding,v=s.minPadding,b=s.tickInterval,y=s.minTickInterval,x=s.tickPixelInterval,_=o.categories;if(p?(o.linkedParent=a[o.coll][s.linkedTo],i=o.linkedParent.getExtremes(),o.min=f(i.min,i.dataMin),o.max=f(i.max,i.dataMax),s.type!==o.linkedParent.options.type&&D(11,1)):(o.min=f(o.userMin,s.min,o.dataMin),o.max=f(o.userMax,s.max,o.dataMax)),c&&(!t&&_e(o.min,f(o.dataMin,o.min))<=0&&D(10,1),o.min=O(l(o.min)),o.max=O(l(o.max))),o.range&&d(o.max)&&(o.userMin=o.min=xe(o.min,o.max-o.range),o.userMax=o.max,o.range=null),o.beforePadding&&o.beforePadding(),o.adjustForMinRange(),_||o.axisPointRange||o.usePercentage||p||!d(o.min)||!d(o.max)||(e=o.max-o.min,e&&(d(s.min)||d(o.userMin)||!v||!(o.dataMin<0)&&o.ignoreMinPadding||(o.min-=e*v),d(s.max)||d(o.userMax)||!m||!(o.dataMax>0)&&o.ignoreMaxPadding||(o.max+=e*m))),o.min===o.max||void 0===o.min||void 0===o.max?o.tickInterval=o.max/5:p&&!b&&x===o.linkedParent.options.tickPixelInterval?o.tickInterval=o.linkedParent.tickInterval:(o.tickInterval=f(b,_?1:(o.max-o.min)*x/xe(o.len,x)),!d(b)&&o.len<x&&!this.isRadial&&!this.isLog&&!_&&s.startOnTick&&s.endOnTick&&(r=!0,o.tickInterval/=4)),u&&!t&&xi(o.series,function(t){t.processData(o.min!==o.oldMin||o.max!==o.oldMax)}),o.setAxisTranslation(!0),o.beforeSetTickPositions&&o.beforeSetTickPositions(),o.postProcessTickInterval&&(o.tickInterval=o.postProcessTickInterval(o.tickInterval)),o.pointRange&&(o.tickInterval=xe(o.pointRange,o.tickInterval)),!b&&o.tickInterval<y&&(o.tickInterval=y),h||c||b||(o.tickInterval=T(o.tickInterval,null,C(o.tickInterval),s)),o.minorTickInterval="auto"===s.minorTickInterval&&o.tickInterval?o.tickInterval/5:s.minorTickInterval,o.tickPositions=n=s.tickPositions?[].concat(s.tickPositions):g&&g.apply(o,[o.min,o.max]),n||(!o.ordinalPositions&&(o.max-o.min)/o.tickInterval>xe(2*o.len,200)&&D(19,!0),n=h?o.getTimeTicks(o.normalizeTimeTickInterval(o.tickInterval,s.units),o.min,o.max,s.startOfWeek,o.ordinalPositions,o.closestPointRange,!0):c?o.getLogTickPositions(o.tickInterval,o.min,o.max):o.getLinearTickPositions(o.tickInterval,o.min,o.max),r&&n.splice(1,n.length-2),o.tickPositions=n),!p){var w,k=n[0],S=n[n.length-1],L=o.minPointOffset||0;s.startOnTick?o.min=k:o.min-L>k&&n.shift(),s.endOnTick?o.max=S:o.max+L<S&&n.pop(),1===n.length&&(w=.001*we(o.max||1),o.min-=w,o.max+=w)}},setMaxTicks:function(){var t=this.chart,e=t.maxTicks||{},i=this.tickPositions,n=this._maxTicksKey=[this.coll,this.pos,this.len].join("-");!this.isLinked&&!this.isDatetimeAxis&&i&&i.length>(e[n]||0)&&this.options.alignTicks!==!1&&(e[n]=i.length),this.options.forceTickRecalculate&&(e[n]=i.length),t.maxTicks=e},adjustTickAmount:function(){var t=this,e=t.chart,i=t._maxTicksKey,n=t.tickPositions,r=e.maxTicks;if(n&&r&&r[i]&&!t.isDatetimeAxis&&!t.categories&&!t.isLinked&&t.options.alignTicks!==!1&&this.min!==X){var o,a=t.tickAmount,s=n.length;if(t.tickAmount=o=r[i],o>s){for(;n.length<o;)n.push(O(n[n.length-1]+t.tickInterval));t.transA*=(s-1)/(o-1),t.max=n[n.length-1]}d(a)&&o!==a&&(t.isDirty=!0)}},setScale:function(){var t,e,i,n,r=this,o=r.stacks;if(r.oldMin=r.min,r.oldMax=r.max,r.oldAxisLength=r.len,r.setAxisSize(),n=r.len!==r.oldAxisLength,xi(r.series,function(t){(t.isDirtyData||t.isDirty||t.xAxis.isDirty)&&(i=!0)}),n||i||r.isLinked||r.forceRedraw||r.userMin!==r.oldUserMin||r.userMax!==r.oldUserMax){if(!r.isXAxis)for(t in o)for(e in o[t])o[t][e].total=null,o[t][e].cum=0;r.forceRedraw=!1,r.getSeriesExtremes(),r.setTickPositions(),r.oldUserMin=r.userMin,r.oldUserMax=r.userMax,r.isDirty||(r.isDirty=n||r.min!==r.oldMin||r.max!==r.oldMax)}else if(!r.isXAxis){r.oldStacks&&(o=r.stacks=r.oldStacks);for(t in o)for(e in o[t])o[t][e].cum=o[t][e].total}r.setMaxTicks()},setExtremes:function(e,i,n,r,o){var a=this,s=a.chart;n=f(n,!0),o=t(o,{min:e,max:i});var l=function(){a.userMin=e,a.userMax=i,a.eventArgs=o,a.isDirtyExtremes=!0,n&&s.redraw(r)};o.preventEventFire?l():Si(a,"setExtremes",o,l)},zoom:function(t,e){var i=this.dataMin,n=this.dataMax,r=this.options;return this.allowZoomOutside||(d(i)&&t<=_e(i,f(r.min,i))&&(t=X),d(n)&&e>=xe(n,f(r.max,n))&&(e=X)),this.displayBtn=t!==X||e!==X,this.setExtremes(t,e,!1,X,{trigger:"zoom"}),!0},setAxisSize:function(){var t,e,i,n,r=this.chart,o=this.options,a=o.offsetLeft||0,s=o.offsetRight||0,l=this.horiz;this.left=n=f(o.left,r.plotLeft+a),this.top=i=f(o.top,r.plotTop),this.width=t=f(o.width,r.plotWidth-a+s),this.height=e=f(o.height,r.plotHeight),this.bottom=r.chartHeight-e-i,this.right=r.chartWidth-t-n,this.len=xe(l?t:e,0),this.pos=l?n:i},getExtremes:function(){var t=this,e=t.isLog;return{min:e?O(c(t.min)):t.min,max:e?O(c(t.max)):t.max,dataMin:t.dataMin,dataMax:t.dataMax,userMin:t.userMin,userMax:t.userMax}},getThreshold:function(t){var e=this,i=e.isLog,n=i?c(e.min):e.min,r=i?c(e.max):e.max;
return n>t||null===t?t=n:t>r&&(t=r),e.translate(t,0,1,0,1)},autoLabelAlign:function(t){var e,i=(f(t,0)-90*this.side+720)%360;return e=i>15&&165>i?"right":i>195&&345>i?"left":"center"},getOffset:function(){var t,e,i,n,r,o,a,s,l,c,h,u,p,g=this,m=g.chart,v=m.renderer,b=g.options,y=g.tickPositions,x=g.ticks,_=g.horiz,w=g.side,k=m.inverted?[1,0,3,2][w]:w,C=0,T=0,S=b.title,L=b.labels,M=0,A=m.axisOffset,$=m.clipOffset,P=[-1,1,1,-1][w],D=1,O=f(L.maxStaggerLines,5);if(g.hasData=t=g.hasVisibleSeries||d(g.min)&&d(g.max)&&!!y,g.showAxis=e=t||f(b.showEmpty,!0),g.staggerLines=g.horiz&&L.staggerLines,g.axisGroup||(g.gridGroup=v.g("grid").attr({zIndex:b.gridZIndex||1}).add(),g.axisGroup=v.g("axis").attr({zIndex:b.zIndex||2}).add(),g.labelGroup=v.g("axis-labels").attr({zIndex:L.zIndex||7}).addClass(Ue+g.coll.toLowerCase()+"-labels").add()),t||g.isLinked){if(g.labelAlign=f(L.align||g.autoLabelAlign(L.rotation)),xi(y,function(t){x[t]?x[t].addLabel():x[t]=new N(g,t)}),g.horiz&&!g.staggerLines&&O&&!L.rotation){for(o=g.reversed?[].concat(y).reverse():y;O>D;){for(a=[],s=!1,r=0;r<o.length;r++)l=o[r],c=x[l].label&&x[l].label.getBBox(),u=c?c.width:0,p=r%D,u&&(h=g.translate(l),a[p]!==X&&h<a[p]&&(s=!0),a[p]=h+u);if(!s)break;D++}D>1&&(g.staggerLines=D)}xi(y,function(t){(0===w||2===w||{1:"left",3:"right"}[w]===g.labelAlign)&&(M=xe(x[t].getLabelSize(),M))}),g.staggerLines&&(M*=g.staggerLines,g.labelOffset=M)}else for(n in x)x[n].destroy(),delete x[n];S&&S.text&&S.enabled!==!1&&(g.axisTitle||(g.axisTitle=v.text(S.text,0,0,S.useHTML).attr({zIndex:7,rotation:S.rotation||0,align:S.textAlign||{low:"left",middle:"center",high:"right"}[S.align]}).addClass(Ue+this.coll.toLowerCase()+"-title").css(S.style).add(g.axisGroup),g.axisTitle.isNew=!0),e&&(C=g.axisTitle.getBBox()[_?"height":"width"],T=f(S.margin,_?5:10),i=S.offset),g.axisTitle[e?"show":"hide"]()),g.offset=P*f(b.offset,A[w]),g.axisTitleMargin=f(i,M+T+(2!==w&&M&&P*b.labels[_?"y":"x"])),A[w]=xe(A[w],g.axisTitleMargin+C+P*g.offset),$[k]=xe($[k],2*be(b.lineWidth/2))},getLinePath:function(t){var e=this.chart,i=this.opposite,n=this.offset,r=this.horiz,o=this.left+(i?this.width:0)+n,a=e.chartHeight-this.bottom-(i?this.height:0)+n;return i&&(t*=-1),e.renderer.crispLine([Je,r?this.left:o,r?a:this.top,Qe,r?e.chartWidth-this.right:o,r?a:e.chartHeight-this.bottom],t)},getTitlePosition:function(){var t=this.horiz,e=this.left,i=this.top,r=this.len,o=this.options.title,a=t?e:i,s=this.opposite,l=this.offset,c=n(o.style.fontSize||12),h={low:a+(t?0:r),middle:a+r/2,high:a+(t?r:0)}[o.align],d=(t?i+this.height:e)+(t?1:-1)*(s?-1:1)*this.axisTitleMargin+(2===this.side?c:0);return{x:t?h:d+(s?this.width:0)+l+(o.x||0),y:t?d-(s?this.height:0)+l:h+(o.y||0)}},render:function(){var t,e,i,n,r=this,o=r.horiz,a=r.reversed,s=r.chart,l=s.renderer,h=r.options,u=r.isLog,p=r.isLinked,f=r.tickPositions,g=r.axisTitle,m=r.ticks,v=r.minorTicks,b=r.alternateBands,y=h.stackLabels,x=h.alternateGridColor,_=r.tickmarkOffset,w=h.lineWidth,k=s.hasRendered,C=k&&d(r.oldMin)&&!isNaN(r.oldMin),T=r.hasData,S=r.showAxis,L=h.labels.overflow,M=r.justifyLabels=o&&L!==!1;r.labelEdge.length=0,r.justifyToPlot="justify"===L,xi([m,v,b],function(t){var e;for(e in t)t[e].isActive=!1}),(T||p)&&(r.minorTickInterval&&!r.categories&&xi(r.getMinorTickPositions(),function(t){v[t]||(v[t]=new N(r,t,"minor")),C&&v[t].isNew&&v[t].render(null,!0),v[t].render(null,!1,1)}),f.length&&(t=f.slice(),(o&&a||!o&&!a)&&t.reverse(),M&&(t=t.slice(1).concat([t[0]])),xi(t,function(e,i){M&&(i=i===t.length-1?0:i+1),(!p||e>=r.min&&e<=r.max)&&(m[e]||(m[e]=new N(r,e)),C&&m[e].isNew&&m[e].render(i,!0,.1),m[e].render(i,!1,1))}),_&&0===r.min&&(m[-1]||(m[-1]=new N(r,-1,null,!0)),m[-1].render(-1))),x&&xi(f,function(t,e){0===e%2&&t<r.max&&(b[t]||(b[t]=new fi.PlotLineOrBand(r)),i=t+_,n=f[e+1]!==X?f[e+1]+_:r.max,b[t].options={from:u?c(i):i,to:u?c(n):n,color:x},b[t].render(),b[t].isActive=!0)}),r._addedPlotLB||(xi((h.plotLines||[]).concat(h.plotBands||[]),function(t){r.addPlotBandOrLine(t)}),r._addedPlotLB=!0)),xi([m,v,b],function(t){var e,i,n=[],r=Z?Z.duration||500:0,o=function(){for(i=n.length;i--;)t[n[i]]&&!t[n[i]].isActive&&(t[n[i]].destroy(),delete t[n[i]])};for(e in t)t[e].isActive||(t[e].render(e,!1,0),t[e].isActive=!1,n.push(e));t!==b&&s.hasRendered&&r?r&&setTimeout(o,r):o()}),w&&(e=r.getLinePath(w),r.axisLine?r.axisLine.animate({d:e}):r.axisLine=l.path(e).attr({stroke:h.lineColor,"stroke-width":w,zIndex:7}).add(r.axisGroup),r.axisLine[S?"show":"hide"]()),g&&S&&(g[g.isNew?"attr":"animate"](r.getTitlePosition()),g.isNew=!1),y&&y.enabled&&r.renderStackTotals(),r.isDirty=!1},redraw:function(){var t=this,e=t.chart,i=e.pointer;i&&i.reset(!0),t.render(),xi(t.plotLinesAndBands,function(t){t.render()}),xi(t.series,function(t){t.isDirty=!0})},destroy:function(t){var e,i,n=this,r=n.stacks,o=n.plotLinesAndBands;t||Ti(n);for(e in r)$(r[e]),r[e]=null;for(xi([n.ticks,n.minorTicks,n.alternateBands],function(t){$(t)}),i=o.length;i--;)o[i].destroy();xi(["stackTotalGroup","axisLine","axisTitle","axisGroup","cross","gridGroup","labelGroup"],function(t){n[t]&&(n[t]=n[t].destroy())}),this.cross&&this.cross.destroy()},drawCrosshair:function(t,e){if(this.crosshair){if((d(e)||!f(this.crosshair.snap,!0))===!1)return this.hideCrosshair(),void 0;var i,n,r=this.crosshair,o=r.animation;if(f(r.snap,!0)?d(e)&&(n=this.chart.inverted!=this.horiz?e.plotX:this.len-e.plotY):n=this.horiz?t.chartX-this.pos:this.len-t.chartY+this.pos,i=this.isRadial?this.getPlotLinePath(this.isXAxis?e.x:f(e.stackY,e.y)):this.getPlotLinePath(null,null,null,null,n),null===i)return this.hideCrosshair(),void 0;if(this.cross)this.cross.attr({visibility:je})[o?"animate":"attr"]({d:i},o);else{var a={"stroke-width":r.width||1,stroke:r.color||"#C0C0C0",zIndex:r.zIndex||2};r.dashStyle&&(a.dashstyle=r.dashStyle),this.cross=this.chart.renderer.path(i).attr(a).add()}}},hideCrosshair:function(){this.cross&&this.cross.hide()}},t(R.prototype,te),R.prototype.getTimeTicks=function(e,i,n,r){var o,a,s=[],l={},c=j.global.useUTC,h=new Date(i-ie),u=e.unitRange,p=e.count;if(d(i)){u>=Q[oi]&&(h.setMilliseconds(0),h.setSeconds(u>=Q[ai]?0:p*be(h.getSeconds()/p))),u>=Q[ai]&&h[ce](u>=Q[si]?0:p*be(h[ne]()/p)),u>=Q[si]&&h[he](u>=Q[li]?0:p*be(h[re]()/p)),u>=Q[li]&&h[de](u>=Q[hi]?1:p*be(h[ae]()/p)),u>=Q[hi]&&(h[ue](u>=Q[di]?0:p*be(h[se]()/p)),a=h[le]()),u>=Q[di]&&(a-=a%p,h[pe](a)),u===Q[ci]&&h[de](h[ae]()-h[oe]()+f(r,1)),o=1,ie&&(h=new Date(h.getTime()+ie)),a=h[le]();for(var g=h.getTime(),m=h[se](),v=h[ae](),b=c?ie:(864e5+1e3*60*h.getTimezoneOffset())%864e5;n>g;)s.push(g),u===Q[di]?g=ee(a+o*p,0):u===Q[hi]?g=ee(a,m+o*p):c||u!==Q[li]&&u!==Q[ci]?g+=u*p:g=ee(a,m,v+o*p*(u===Q[li]?1:7)),o++;s.push(g),xi(_i(s,function(t){return u<=Q[si]&&t%Q[li]===b}),function(t){l[t]=li})}return s.info=t(e,{higherRanks:l,totalRange:u*p}),s},R.prototype.normalizeTimeTickInterval=function(t,e){var i,n,r=e||[[ri,[1,2,5,10,20,25,50,100,200,500]],[oi,[1,2,5,10,15,30]],[ai,[1,2,5,10,15,30]],[si,[1,2,3,4,6,8,12]],[li,[1,2]],[ci,[1,2]],[hi,[1,2,3,4,6]],[di,null]],o=r[r.length-1],a=Q[o[0]],s=o[1];for(n=0;n<r.length;n++)if(o=r[n],a=Q[o[0]],s=o[1],r[n+1]){var l=(a*s[s.length-1]+Q[r[n+1][0]])/2;if(l>=t)break}return a===Q[di]&&5*a>t&&(s=[1,2,5]),i=T(t/a,s,o[0]===di?xe(C(t/a),1):1),{unitRange:a,count:i,unitName:o[0]}},R.prototype.getLogTickPositions=function(t,e,i,n){var r=this,o=r.options,a=r.len,s=[];if(n||(r._minorAutoInterval=null),t>=.5)t=ve(t),s=r.getLinearTickPositions(t,e,i);else if(t>=.08){var h,d,u,p,g,m,v,b=be(e);for(h=t>.3?[1,2,4]:t>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],d=b;i+1>d&&!v;d++)for(p=h.length,u=0;p>u&&!v;u++)g=l(c(d)*h[u]),g>e&&(!n||i>=m)&&s.push(m),m>i&&(v=!0),m=g}else{var y=c(e),x=c(i),_=o[n?"minorTickInterval":"tickInterval"],w="auto"===_?null:_,k=o.tickPixelInterval/(n?5:1),S=n?a/r.tickPositions.length:a;t=f(w,r._minorAutoInterval,(x-y)*k/(S||1)),t=T(t,null,C(t)),s=ki(r.getLinearTickPositions(t,y,x),l),n||(r._minorAutoInterval=t/5)}return n||(r.tickInterval=t),s};var qi=fi.Tooltip=function(){this.init.apply(this,arguments)};qi.prototype={init:function(t,e){var i=e.borderWidth,r=e.style,o=n(r.padding);this.chart=t,this.options=e,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.label=t.renderer.label("",0,0,e.shape,null,null,e.useHTML,null,"tooltip").attr({padding:o,fill:e.backgroundColor,"stroke-width":i,r:e.borderRadius,zIndex:8}).css(r).css({padding:0}).add().attr({y:-9999}),Ie||this.label.shadow(e.shadow),this.shared=e.shared},destroy:function(){this.label&&(this.label=this.label.destroy()),clearTimeout(this.hideTimer),clearTimeout(this.tooltipTimeout)},move:function(e,i,n,r){var o=this,a=o.now,s=o.options.animation!==!1&&!o.isHidden;t(a,{x:s?(2*a.x+e)/3:e,y:s?(a.y+i)/2:i,anchorX:s?(2*a.anchorX+n)/3:n,anchorY:s?(a.anchorY+r)/2:r}),o.label.attr(a),s&&(we(e-a.x)>1||we(i-a.y)>1)&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){o&&o.move(e,i,n,r)},32))},hide:function(){var t,e=this;clearTimeout(this.hideTimer),this.isHidden||(t=this.chart.hoverPoints,this.hideTimer=setTimeout(function(){e.label.fadeOut(),e.isHidden=!0},f(this.options.hideDelay,500)),t&&xi(t,function(t){t.setState()}),this.chart.hoverPoints=null)},getAnchor:function(t,e){var i,n,r=this.chart,o=r.inverted,a=r.plotTop,s=0,l=0;return t=p(t),i=t[0].tooltipPos,this.followPointer&&e&&(e.chartX===X&&(e=r.pointer.normalize(e)),i=[e.chartX-r.plotLeft,e.chartY-a]),i||(xi(t,function(t){n=t.series.yAxis,s+=t.plotX,l+=(t.plotLow?(t.plotLow+t.plotHigh)/2:t.plotY)+(!o&&n?n.top-a:0)}),s/=t.length,l/=t.length,i=[o?r.plotWidth-l:s,this.shared&&!o&&t.length>1&&e?e.chartY-a:o?r.plotHeight-s:l]),ki(i,ve)},getPosition:function(t,e,i){var n,r=this.chart,o=r.plotLeft,a=r.plotTop,s=r.plotWidth,l=r.plotHeight,c=f(this.options.distance,12),h=isNaN(i.plotX)?0:i.plotX,d=i.plotY,u=h+o+(r.inverted?c:-t-c),p=d-e+a+15;return 7>u&&(u=o+xe(h,0)+c),u+t>o+s&&(u-=u+t-(o+s),p=d-e+a-c,n=!0),a+5>p&&(p=a+5,n&&d>=p&&p+e>=d&&(p=d+a+c)),p+e>a+l&&(p=xe(a,a+l-e-c)),{x:u,y:p}},defaultFormatter:function(t){var e,i=this.points||p(this),n=i[0].series;return e=[t.tooltipHeaderFormatter(i[0])],xi(i,function(t){n=t.series,e.push(n.tooltipFormatter&&n.tooltipFormatter(t)||t.point.tooltipFormatter(n.tooltipOptions.pointFormat))}),e.push(t.options.footerFormat||""),e.join("")},refresh:function(t,e){var i,n,r,o,a,s,l=this,c=l.chart,h=l.label,d=l.options,u={},f=[],g=d.formatter||l.defaultFormatter,m=c.hoverPoints,v=l.shared;clearTimeout(this.hideTimer),l.followPointer=p(t)[0].series.tooltipOptions.followPointer,r=l.getAnchor(t,e),i=r[0],n=r[1],!v||t.series&&t.series.noSharedTooltip?u=t.getLabelConfig():(c.hoverPoints=t,m&&xi(m,function(t){t.setState()}),xi(t,function(t){t.setState(ii),f.push(t.getLabelConfig())}),u={x:t[0].category,y:t[0].y},u.points=f,t=t[0]),o=g.call(u,l),s=t.series,o===!1?this.hide():(l.isHidden&&(Ai(h),h.attr("opacity",1).show()),h.attr({text:o}),a=d.borderColor||t.color||s.color||"#606060",h.attr({stroke:a}),l.updatePosition({plotX:i,plotY:n}),this.isHidden=!1),Si(c,"tooltipRefresh",{text:o,x:i+c.plotLeft,y:n+c.plotTop,borderColor:a})},updatePosition:function(t){var e=this.chart,i=this.label,n=(this.options.positioner||this.getPosition).call(this,i.width,i.height,t);this.move(ve(n.x),ve(n.y),t.plotX+e.plotLeft,t.plotY+e.plotTop)},tooltipHeaderFormatter:function(t){var e,i=t.series,n=i.tooltipOptions,r=n.dateTimeLabelFormats,o=n.xDateFormat,a=i.xAxis,l=a&&"datetime"===a.options.type&&s(t.key),c=n.headerFormat,h=a&&a.closestPointRange;if(l&&!o){if(h){for(e in Q)if(Q[e]>=h||Q[e]<=Q[li]&&t.key%Q[e]>0){o=r[e];break}}else o=r.day;o=o||r.year}return l&&o&&(c=c.replace("{point.key}","{point.key:"+o+"}")),k(c,{point:t,series:i})}};var Gi;V=fe.documentElement.ontouchstart!==X;var Xi=fi.Pointer=function(t,e){this.init(t,e)};if(Xi.prototype={init:function(t,e){var i,n,r=e.chart,o=r.events,a=Ie?"":r.zoomType,s=t.inverted;this.options=e,this.chart=t,this.zoomX=i=/x/.test(a),this.zoomY=n=/y/.test(a),this.zoomHor=i&&!s||n&&s,this.zoomVert=n&&!s||i&&s,this.runChartClick=o&&!!o.click,this.pinchDown=[],this.lastValidTouch={},fi.Tooltip&&e.tooltip.enabled&&(t.tooltip=new qi(t,e.tooltip)),this.setDOMEvents()},normalize:function(e,i){var n,r,o;return e=e||ge.event,e=Li(e),e.target||(e.target=e.srcElement),o=e.touches?e.touches.item(0):e,i||(this.chartPosition=i=wi(this.chart.container)),o.pageX===X?(n=xe(e.x,e.clientX-i.left),r=e.y):(n=o.pageX-i.left,r=o.pageY-i.top),t(e,{chartX:ve(n),chartY:ve(r)})},getCoordinates:function(t){var e={xAxis:[],yAxis:[]};return xi(this.chart.axes,function(i){e[i.isXAxis?"xAxis":"yAxis"].push({axis:i,value:i.toValue(t[i.horiz?"chartX":"chartY"])})}),e},getIndex:function(t){var e=this.chart;return e.inverted?e.plotHeight+e.plotTop-t.chartY:t.chartX-e.plotLeft},runPointActions:function(t){var e,i,n,r,o,a=this,s=a.chart,l=s.series,c=s.tooltip,h=s.hoverPoint,u=s.hoverSeries,p=s.chartWidth,g=a.getIndex(t);if(c&&a.options.tooltip.shared&&(!u||!u.noSharedTooltip)){for(i=[],n=l.length,r=0;n>r;r++)l[r].visible&&l[r].options.enableMouseTracking!==!1&&!l[r].noSharedTooltip&&l[r].singularTooltips!==!0&&l[r].tooltipPoints.length&&(e=l[r].tooltipPoints[g],e&&e.series&&(e._dist=we(g-e.clientX),p=_e(p,e._dist),i.push(e)));for(n=i.length;n--;)i[n]._dist>p&&i.splice(n,1);i.length&&i[0].clientX!==a.hoverX&&(c.refresh(i,t),a.hoverX=i[0].clientX)}!u||!u.tracker||c&&c.followPointer?c&&c.followPointer&&!c.isHidden&&(o=c.getAnchor([{}],t),c.updatePosition({plotX:o[0],plotY:o[1]})):(e=u.tooltipPoints[g],e&&e!==h&&e.onMouseOver(t)),c&&!a._onDocumentMouseMove&&(a._onDocumentMouseMove=function(t){d(Gi)&&Be[Gi].pointer.onDocumentMouseMove(t)},Ci(fe,"mousemove",a._onDocumentMouseMove)),xi(s.axes,function(i){i.drawCrosshair(t,f(e,h))})},reset:function(t){var e=this,i=e.chart,n=i.hoverSeries,r=i.hoverPoint,o=i.tooltip,a=o&&o.shared?i.hoverPoints:r;t=t&&o&&a,t&&p(a)[0].plotX===X&&(t=!1),t?(o.refresh(a),r&&r.setState(r.state,!0)):(r&&r.onMouseOut(),n&&n.onMouseOut(),o&&o.hide(),e._onDocumentMouseMove&&(Ti(fe,"mousemove",e._onDocumentMouseMove),e._onDocumentMouseMove=null),xi(i.axes,function(t){t.hideCrosshair()}),e.hoverX=null)},scaleGroups:function(t,e){var i,n=this.chart;xi(n.series,function(r){i=t||r.getPlotBox(),r.xAxis&&r.xAxis.zoomEnabled&&(r.group.attr(i),r.markerGroup&&(r.markerGroup.attr(i),r.markerGroup.clip(e?n.clipRect:null)),r.dataLabelsGroup&&r.dataLabelsGroup.attr(i))}),n.clipRect.attr(e||n.clipBox)},dragStart:function(t){var e=this.chart;e.mouseIsDown=t.type,e.cancelClick=!1,e.mouseDownX=this.mouseDownX=t.chartX,e.mouseDownY=this.mouseDownY=t.chartY},drag:function(t){var e,i,n=this.chart,r=n.options.chart,o=t.chartX,a=t.chartY,s=this.zoomHor,l=this.zoomVert,c=n.plotLeft,h=n.plotTop,d=n.plotWidth,u=n.plotHeight,p=this.mouseDownX,f=this.mouseDownY;c>o?o=c:o>c+d&&(o=c+d),h>a?a=h:a>h+u&&(a=h+u),this.hasDragged=Math.sqrt(Math.pow(p-o,2)+Math.pow(f-a,2)),this.hasDragged>10&&(e=n.isInsidePlot(p-c,f-h),n.hasCartesianSeries&&(this.zoomX||this.zoomY)&&e&&(this.selectionMarker||(this.selectionMarker=n.renderer.rect(c,h,s?1:d,l?1:u,0).attr({fill:r.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add())),this.selectionMarker&&s&&(i=o-p,this.selectionMarker.attr({width:we(i),x:(i>0?0:i)+p})),this.selectionMarker&&l&&(i=a-f,this.selectionMarker.attr({height:we(i),y:(i>0?0:i)+f})),e&&!this.selectionMarker&&r.panning&&n.pan(t,r.panning))},drop:function(e){var i=this.chart,n=this.hasPinched;if(this.selectionMarker){var r,o={xAxis:[],yAxis:[],originalEvent:e.originalEvent||e},a=this.selectionMarker,s=a.x,l=a.y;(this.hasDragged||n)&&(xi(i.axes,function(t){if(t.zoomEnabled){var e=t.horiz,i=t.toValue(e?s:l),n=t.toValue(e?s+a.width:l+a.height);isNaN(i)||isNaN(n)||(o[t.coll].push({axis:t,min:_e(i,n),max:xe(i,n)}),r=!0)}}),r&&Si(i,"selection",o,function(e){i.zoom(t(e,n?{animation:!1}:null))})),this.selectionMarker=this.selectionMarker.destroy(),n&&this.scaleGroups()}i&&(g(i.container,{cursor:i._cursor}),i.cancelClick=this.hasDragged>10,i.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},onContainerMouseDown:function(t){t=this.normalize(t),t.preventDefault&&t.preventDefault(),this.dragStart(t)},onDocumentMouseUp:function(t){d(Gi)&&Be[Gi].pointer.drop(t)},onDocumentMouseMove:function(t){var e=this.chart,i=this.chartPosition,n=e.hoverSeries;t=this.normalize(t,i),i&&n&&!this.inClass(t.target,"highcharts-tracker")&&!e.isInsidePlot(t.chartX-e.plotLeft,t.chartY-e.plotTop)&&this.reset()},onContainerMouseLeave:function(){var t=Be[Gi];t&&(t.pointer.reset(),t.pointer.chartPosition=null),Gi=null},onContainerMouseMove:function(t){var e=this.chart;Gi=e.index,t=this.normalize(t),"mousedown"===e.mouseIsDown&&this.drag(t),(e.isInsidePlot(t.chartX-e.plotLeft,t.chartY-e.plotTop)||t.synthetic)&&(this.runPointActions(t),!t.synthetic&&e.options&&e.options.events&&e.options.events.mouseMove&&e.options.events.mouseMove(t,e))},inClass:function(t,e){for(var i;t;){if(i=u(t,"class")){if(-1!==i.indexOf(e))return!0;if(-1!==i.indexOf(Ue+"container"))return!1}t=t.parentNode}},onTrackerMouseOut:function(t){var e=this.chart.hoverSeries,i=t.relatedTarget||t.toElement,n=i&&i.point&&i.point.series;!e||e.options.stickyTracking||this.inClass(i,Ue+"tooltip")||n===e||e.onMouseOut()},onContainerClick:function(e){var i,n,r,o=this.chart,a=o.hoverPoint,s=o.plotLeft,l=o.plotTop,c=o.inverted;e=this.normalize(e),e.cancelBubble=!0,o.cancelClick||(a&&this.inClass(e.target,Ue+"tracker")?(i=this.chartPosition,n=a.plotX,r=a.plotY,t(a,{pageX:i.left+s+(c?o.plotWidth-r:n),pageY:i.top+l+(c?o.plotHeight-n:r)}),Si(a.series,"click",t(e,{point:a})),o.hoverPoint&&a.firePointEvent("click",e)):(t(e,this.getCoordinates(e)),o.isInsidePlot(e.chartX-s,e.chartY-l)&&Si(o,"click",e)))},setDOMEvents:function(){var t=this,e=t.chart.container;e.onmousedown=function(e){t.onContainerMouseDown(e)},e.onmousemove=function(e){t.onContainerMouseMove(e)},e.onclick=function(e){t.onContainerClick(e)},Ci(e,"mouseleave",t.onContainerMouseLeave),Ci(fe,"mouseup",t.onDocumentMouseUp),V&&(e.ontouchstart=function(e){t.onContainerTouchStart(e)},e.ontouchmove=function(e){t.onContainerTouchMove(e)},Ci(fe,"touchend",t.onDocumentTouchEnd))},destroy:function(){var t;Ti(this.chart.container,"mouseleave",this.onContainerMouseLeave),Ti(fe,"mouseup",this.onDocumentMouseUp),Ti(fe,"touchend",this.onDocumentTouchEnd),clearInterval(this.tooltipTimeout);for(t in this)this[t]=null}},t(fi.Pointer.prototype,{pinchTranslate:function(t,e,i,n,r,o,a,s){t&&this.pinchTranslateDirection(!0,i,n,r,o,a,s),e&&this.pinchTranslateDirection(!1,i,n,r,o,a,s)},pinchTranslateDirection:function(t,e,i,n,r,o,a,s){var l,c,h,d,u,p,f=this.chart,g=t?"x":"y",m=t?"X":"Y",v="chart"+m,b=t?"width":"height",y=f["plot"+(t?"Left":"Top")],x=s||1,_=f.inverted,w=f.bounds[t?"h":"v"],k=1===e.length,C=e[0][v],T=i[0][v],S=!k&&e[1][v],L=!k&&i[1][v],M=function(){!k&&we(C-S)>20&&(x=s||we(T-L)/we(C-S)),h=(y-T)/x+C,l=f["plot"+(t?"Width":"Height")]/x};M(),c=h,c<w.min?(c=w.min,d=!0):c+l>w.max&&(c=w.max-l,d=!0),d?(T-=.8*(T-a[g][0]),k||(L-=.8*(L-a[g][1])),M()):a[g]=[T,L],_||(o[g]=h-y,o[b]=l),p=_?t?"scaleY":"scaleX":"scale"+m,u=_?1/x:x,r[b]=l,r[g]=c,n[p]=x,n["translate"+m]=u*y+(T-u*C)},pinch:function(e){var i=this,n=i.chart,r=i.pinchDown,o=n.tooltip&&n.tooltip.options.followTouchMove,a=e.touches,s=a.length,l=i.lastValidTouch,c=i.zoomHor||i.pinchHor,h=i.zoomVert||i.pinchVert,d=c||h,u=i.selectionMarker,p={},f=1===s&&(i.inClass(e.target,Ue+"tracker")&&n.runTrackerClick||n.runChartClick),g={};!d&&!o||f||e.preventDefault(),ki(a,function(t){return i.normalize(t)}),"touchstart"===e.type?(xi(a,function(t,e){r[e]={chartX:t.chartX,chartY:t.chartY}}),l.x=[r[0].chartX,r[1]&&r[1].chartX],l.y=[r[0].chartY,r[1]&&r[1].chartY],xi(n.axes,function(t){if(t.zoomEnabled){var e=n.bounds[t.horiz?"h":"v"],i=t.minPixelPadding,r=t.toPixels(t.dataMin),o=t.toPixels(t.dataMax),a=_e(r,o),s=xe(r,o);e.min=_e(t.pos,a-i),e.max=xe(t.pos+t.len,s+i)}})):r.length&&(u||(i.selectionMarker=u=t({destroy:Re},n.plotBox)),i.pinchTranslate(c,h,r,a,p,u,g,l),i.hasPinched=d,i.scaleGroups(p,g),!d&&o&&1===s&&this.runPointActions(i.normalize(e)))},onContainerTouchStart:function(t){var e=this.chart;Gi=e.index,1===t.touches.length?(t=this.normalize(t),e.isInsidePlot(t.chartX-e.plotLeft,t.chartY-e.plotTop)?(this.runPointActions(t),this.pinch(t)):this.reset()):2===t.touches.length&&this.pinch(t)},onContainerTouchMove:function(t){(1===t.touches.length||2===t.touches.length)&&this.pinch(t)},onDocumentTouchEnd:function(t){d(Gi)&&Be[Gi].pointer.drop(t)}}),ge.PointerEvent||ge.MSPointerEvent){var Yi={},Vi=!!ge.PointerEvent,Ui=function(){var t,e=[];e.item=function(t){return this[t]};for(t in Yi)Yi.hasOwnProperty(t)&&e.push({pageX:Yi[t].pageX,pageY:Yi[t].pageY,target:Yi[t].target});return e},ji=function(t,e,i,n){var r;t=t.originalEvent||t,"touch"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_TOUCH||!Be[Gi]||(n(t),r=Be[Gi].pointer,r[e]({type:i,target:t.currentTarget,preventDefault:Re,touches:Ui()}))};t(Xi.prototype,{onContainerPointerDown:function(t){ji(t,"onContainerTouchStart","touchstart",function(t){Yi[t.pointerId]={pageX:t.pageX,pageY:t.pageY,target:t.currentTarget}})},onContainerPointerMove:function(t){ji(t,"onContainerTouchMove","touchmove",function(t){Yi[t.pointerId]={pageX:t.pageX,pageY:t.pageY},Yi[t.pointerId].target||(Yi[t.pointerId].target=t.currentTarget)})},onDocumentPointerUp:function(t){ji(t,"onContainerTouchEnd","touchend",function(t){delete Yi[t.pointerId]})},batchMSEvents:function(t){t(this.chart.container,Vi?"pointerdown":"MSPointerDown",this.onContainerPointerDown),t(this.chart.container,Vi?"pointermove":"MSPointerMove",this.onContainerPointerMove),t(fe,Vi?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}}),x(Xi.prototype,"init",function(t,e,i){g(e.container,{"-ms-touch-action":Ze,"touch-action":Ze}),t.call(this,e,i)}),x(Xi.prototype,"setDOMEvents",function(t){t.apply(this),this.batchMSEvents(Ci)}),x(Xi.prototype,"destroy",function(t){this.batchMSEvents(Ti),t.call(this)})}var Ki=fi.Legend=function(t,e){this.init(t,e)};Ki.prototype={init:function(t,i){var r=this,o=i.itemStyle,a=f(i.padding,8),s=i.itemMarginTop||0;this.options=i,i.enabled&&(r.baseline=n(o.fontSize)+3+s,r.itemStyle=o,r.itemHiddenStyle=e(o,i.itemHiddenStyle),r.itemMarginTop=s,r.padding=a,r.initialItemX=a,r.initialItemY=a-5,r.maxItemWidth=0,r.chart=t,r.itemHeight=0,r.lastLineHeight=0,r.symbolWidth=f(i.symbolWidth,16),r.pages=[],r.render(),Ci(r.chart,"endResize",function(){r.positionCheckboxes()}))},colorizeItem:function(t,e){var i,n,r=this,o=r.options,a=t.legendItem,s=t.legendLine,l=t.legendSymbol,c=r.itemHiddenStyle.color,h=e?o.itemStyle.color:c,d=e?t.legendColor||t.color||"#CCC":c,u=t.options&&t.options.marker,p={stroke:d,fill:d};if(a&&a.css({fill:h,color:h}),s&&s.attr({stroke:d}),l){if(u&&l.isMarker){u=t.convertAttribs(u);for(i in u)n=u[i],n!==X&&(p[i]=n)}l.attr(p)}},positionItem:function(t){var e=this,i=e.options,n=i.symbolPadding,r=!i.rtl,o=t._legendItemPos,a=o[0],s=o[1],l=t.checkbox;t.legendGroup&&t.legendGroup.translate(r?a:e.legendWidth-a-2*n-4,s),l&&(l.x=a,l.y=s)},destroyItem:function(t){var e=t.checkbox;xi(["legendItem","legendLine","legendSymbol","legendGroup"],function(e){t[e]&&(t[e]=t[e].destroy())}),e&&P(t.checkbox)},destroy:function(){var t=this,e=t.group,i=t.box;i&&(t.box=i.destroy()),e&&(t.group=e.destroy())},positionCheckboxes:function(t){var e,i=this.group.alignAttr,n=this.clipHeight||this.legendHeight;i&&(e=i.translateY,xi(this.allItems,function(r){var o,a=r.checkbox;a&&(o=e+a.y+(t||0)+3,g(a,{left:i.translateX+r.legendItemWidth+a.x-20+Ke,top:o+Ke,display:o>e-6&&e+n-6>o?"":Ze}))}))},renderTitle:function(){var t,e=this.options,i=this.padding,n=e.title,r=0;n.text&&(this.title||(this.title=this.chart.renderer.label(n.text,i-3,i-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(n.style).add(this.group)),t=this.title.getBBox(),r=t.height,this.offsetWidth=t.width,this.contentGroup.attr({translateY:r})),this.titleHeight=r},renderItem:function(t){var i,n,r,o=this,a=o.chart,s=a.renderer,l=o.options,c="horizontal"===l.layout,h=o.symbolWidth,d=l.symbolPadding,u=o.itemStyle,p=o.itemHiddenStyle,g=o.padding,m=c?f(l.itemDistance,8):0,v=!l.rtl,b=l.width,y=l.itemMarginBottom||0,x=o.itemMarginTop,_=o.initialItemX,w=t.legendItem,C=t.series&&t.series.drawLegendSymbol?t.series:t,T=C.options,S=o.createCheckboxForItem&&T&&T.showCheckbox,L=l.useHTML;w||(t.legendGroup=s.g("legend-item").attr({zIndex:1}).add(o.scrollGroup),C.drawLegendSymbol(o,t),t.legendItem=w=s.text(l.labelFormat?k(l.labelFormat,t):l.labelFormatter.call(t),v?h+d:-d,o.baseline,L).css(e(t.visible?u:p)).attr({align:v?"left":"right",zIndex:2}).add(t.legendGroup),o.setItemEvents&&o.setItemEvents(t,w,L,u,p),o.colorizeItem(t,t.visible),S&&o.createCheckboxForItem(t)),n=w.getBBox(),r=t.legendItemWidth=l.itemWidth||t.legendItemWidth||h+d+n.width+m+(S?20:0),o.itemHeight=i=ve(t.legendItemHeight||n.height),c&&o.itemX-_+r>(b||a.chartWidth-2*g-_-l.x)&&(o.itemX=_,o.itemY+=x+o.lastLineHeight+y,o.lastLineHeight=0),o.maxItemWidth=xe(o.maxItemWidth,r),o.lastItemY=x+o.itemY+y,o.lastLineHeight=xe(i,o.lastLineHeight),t._legendItemPos=[o.itemX,o.itemY],c?o.itemX+=r:(o.itemY+=x+i+y,o.lastLineHeight=i),o.offsetWidth=b||xe((c?o.itemX-_-m:r)+g,o.offsetWidth)},getAllItems:function(){var t=[];return xi(this.chart.series,function(e){var i=e.options;f(i.showInLegend,d(i.linkedTo)?!1:X,!0)&&(t=t.concat(e.legendItems||("point"===i.legendType?e.data:e)))}),t},render:function(){var e,i,n,r,o=this,a=o.chart,s=a.renderer,l=o.group,c=o.box,h=o.options,d=o.padding,u=h.borderWidth,p=h.backgroundColor;o.itemX=o.initialItemX,o.itemY=o.initialItemY,o.offsetWidth=0,o.lastItemY=0,l||(o.group=l=s.g("legend").attr({zIndex:7}).add(),o.contentGroup=s.g().attr({zIndex:1}).add(l),o.scrollGroup=s.g().add(o.contentGroup)),o.renderTitle(),e=o.getAllItems(),L(e,function(t,e){return(t.options&&t.options.legendIndex||0)-(e.options&&e.options.legendIndex||0)}),h.reversed&&e.reverse(),o.allItems=e,o.display=i=!!e.length,xi(e,function(t){o.renderItem(t)}),n=h.width||o.offsetWidth,r=o.lastItemY+o.lastLineHeight+o.titleHeight,r=o.handleOverflow(r),(u||p)&&(n+=d,r+=d,c?n>0&&r>0&&(c[c.isNew?"attr":"animate"](c.crisp({width:n,height:r})),c.isNew=!1):(o.box=c=s.rect(0,0,n,r,h.borderRadius,u||0).attr({stroke:h.borderColor,"stroke-width":u||0,fill:p||Ze}).add(l).shadow(h.shadow),c.isNew=!0),c[i?"show":"hide"]()),o.legendWidth=n,o.legendHeight=r,xi(e,function(t){o.positionItem(t)}),i&&l.align(t({width:n,height:r},h),!0,"spacingBox"),a.isResizing||this.positionCheckboxes()},handleOverflow:function(t){var e,i,n=this,r=this.chart,o=r.renderer,a=this.options,s=a.y,l="top"===a.verticalAlign,c=r.spacingBox.height+(l?-s:s)-this.padding,h=a.maxHeight,d=this.clipRect,u=a.navigation,p=f(u.animation,!0),g=u.arrowSize||12,m=this.nav,v=this.pages,b=this.allItems;return"horizontal"===a.layout&&(c/=2),h&&(c=_e(c,h)),v.length=0,t>c&&!a.useHTML?(this.clipHeight=e=c-20-this.titleHeight-this.padding,this.currentPage=f(this.currentPage,1),this.fullHeight=t,xi(b,function(t,n){var r=t._legendItemPos[1],o=ve(t.legendItem.getBBox().height),a=v.length;(!a||r-v[a-1]>e&&(i||r)!==v[a-1])&&(v.push(i||r),a++),n===b.length-1&&r+o-v[a-1]>e&&v.push(r),r!==i&&(i=r)}),d||(d=n.clipRect=o.clipRect(0,this.padding,9999,0),n.contentGroup.clip(d)),d.attr({height:e}),m||(this.nav=m=o.g().attr({zIndex:1}).add(this.group),this.up=o.symbol("triangle",0,0,g,g).on("click",function(){n.scroll(-1,p)}).add(m),this.pager=o.text("",15,10).css(u.style).add(m),this.down=o.symbol("triangle-down",0,0,g,g).on("click",function(){n.scroll(1,p)}).add(m)),n.scroll(0),t=c):m&&(d.attr({height:r.chartHeight}),m.hide(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),t},scroll:function(t,e){var i,n=this.pages,r=n.length,o=this.currentPage+t,a=this.clipHeight,s=this.options.navigation,l=s.activeColor,c=s.inactiveColor,h=this.pager,d=this.padding;o>r&&(o=r),o>0&&(e!==X&&E(e,this.chart),this.nav.attr({translateX:d,translateY:a+this.padding+7+this.titleHeight,visibility:je}),this.up.attr({fill:1===o?c:l}).css({cursor:1===o?"default":"pointer"}),h.attr({text:o+"/"+r}),this.down.attr({x:18+this.pager.getBBox().width,fill:o===r?c:l}).css({cursor:o===r?"default":"pointer"}),i=-n[o-1]+this.initialItemY,this.scrollGroup.animate({translateY:i}),this.currentPage=o,this.positionCheckboxes(i))}};var Zi=fi.LegendSymbolMixin={drawRectangle:function(t,e){var i=t.options.symbolHeight||12;e.legendSymbol=this.chart.renderer.rect(0,t.baseline-5-i/2,t.symbolWidth,i,f(t.options.symbolRadius,2)).attr({zIndex:3}).add(e.legendGroup)},drawLineMarker:function(t){var e,i,n,r=this.options,o=r.marker,a=t.options,s=t.symbolWidth,l=this.chart.renderer,c=this.legendGroup,h=t.baseline-ve(.3*l.fontMetrics(a.itemStyle.fontSize).b);r.lineWidth&&(n={"stroke-width":r.lineWidth},r.dashStyle&&(n.dashstyle=r.dashStyle),this.legendLine=l.path([Je,0,h,Qe,s,h]).attr(n).add(c)),o&&o.enabled&&(e=o.radius,this.legendSymbol=i=l.symbol(this.symbol,s/2-e,h-e,2*e,2*e).add(c),i.isMarker=!0)}};(/Trident\/7\.0/.test(Le)||De)&&x(Ki.prototype,"positionItem",function(t,e){var i=this,n=function(){e._legendItemPos&&t.call(i,e)};i.chart.renderer.forExport?n():setTimeout(n)}),B.prototype={init:function(t,i){var n,r=t.series;t.series=null,n=e(j,t),n.series=t.series=r,this.userOptions=t;var o=n.chart;this.margin=this.splashArray("margin",o),this.spacing=this.splashArray("spacing",o);var a=o.events;this.bounds={h:{},v:{}},this.callback=i,this.isResizing=0,this.options=n,this.axes=[],this.series=[],this.hasCartesianSeries=o.showAxes;var s,l=this;if(l.index=Be.length,Be.push(l),o.reflow!==!1&&Ci(l,"load",function(){l.initReflow()}),a)for(s in a)Ci(l,s,a[s]);l.xAxis=[],l.yAxis=[],l.animation=Ie?!1:f(o.animation,!0),l.pointCount=0,l.counters=new S,l.firstRender()},initSeries:function(t){var e,i=this,n=i.options.chart,r=t.type||n.type||n.defaultSeriesType,o=pi[r];return o||D(17,!0),e=new o,e.init(this,t),e},isInsidePlot:function(t,e,i){var n=i?e:t,r=i?t:e;return n>=0&&n<=this.plotWidth&&r>=0&&r<=this.plotHeight},adjustTickAmounts:function(){this.options.chart.alignTicks!==!1&&xi(this.axes,function(t){t.adjustTickAmount()}),this.maxTicks=null},redraw:function(e){var i,n,r,o=this,a=o.axes,s=o.series,l=o.pointer,c=o.legend,h=o.isDirtyLegend,d=o.isDirtyBox,u=s.length,p=u,f=o.renderer,g=f.isHidden(),m=[];for(E(e,o),g&&o.cloneRenderTo(),o.layOutTitles();p--;)if(r=s[p],r.options.stacking&&(i=!0,r.isDirty)){n=!0;break}if(n)for(p=u;p--;)r=s[p],r.options.stacking&&(r.isDirty=!0);xi(s,function(t){t.isDirty&&"point"===t.options.legendType&&(h=!0)}),h&&c.options.enabled&&(c.render(),o.isDirtyLegend=!1),i&&o.getStacks(),o.hasCartesianSeries&&(o.isResizing||(o.maxTicks=null,xi(a,function(t){t.setScale()})),o.adjustTickAmounts(),o.getMargins(),xi(a,function(t){t.isDirty&&(d=!0)}),xi(a,function(e){e.isDirtyExtremes&&(e.isDirtyExtremes=!1,m.push(function(){Si(e,"afterSetExtremes",t(e.eventArgs,e.getExtremes())),delete e.eventArgs})),(d||i)&&e.redraw()})),d&&o.drawChartBox(),xi(s,function(t){t.isDirty&&t.visible&&(!t.isCartesian||t.xAxis)&&t.redraw()}),l&&l.reset(!0),f.draw(),Si(o,"redraw"),g&&o.cloneRenderTo(!0),xi(m,function(t){t.call()})},get:function(t){var e,i,n,r=this,o=r.axes,a=r.series;for(e=0;e<o.length;e++)if(o[e].options.id===t)return o[e];for(e=0;e<a.length;e++)if(a[e].options.id===t)return a[e];for(e=0;e<a.length;e++)for(n=a[e].points||[],i=0;i<n.length;i++)if(n[i].id===t)return n[i];return null},getAxes:function(){var t,e,i=this,n=this.options,r=n.xAxis=p(n.xAxis||{}),o=n.yAxis=p(n.yAxis||{});xi(r,function(t,e){t.index=e,t.isX=!0}),xi(o,function(t,e){t.index=e}),t=r.concat(o),xi(t,function(t){e=new R(i,t)}),i.adjustTickAmounts()},getSelectedPoints:function(){var t=[];return xi(this.series,function(e){t=t.concat(_i(e.points||[],function(t){return t.selected}))}),t},getSelectedSeries:function(){return _i(this.series,function(t){return t.selected})},getStacks:function(){var t=this;xi(t.yAxis,function(t){t.stacks&&t.hasVisibleSeries&&(t.oldStacks=t.stacks)}),xi(t.series,function(e){!e.options.stacking||e.visible!==!0&&t.options.chart.ignoreHiddenSeries!==!1||(e.stackKey=e.type+f(e.options.stack,""))})},setTitle:function(t,i,n){var r,o,a=this,s=a.options;r=s.title=e(s.title,t),o=s.subtitle=e(s.subtitle,i),xi([["title",t,r],["subtitle",i,o]],function(t){var e=t[0],i=a[e],n=t[1],r=t[2];i&&n&&(a[e]=i=i.destroy()),r&&r.text&&!i&&(a[e]=a.renderer.text(r.text,0,0,r.useHTML).attr({align:r.align,"class":Ue+e,zIndex:r.zIndex||4}).css(r.style).add())}),a.layOutTitles(n)},layOutTitles:function(e){var i,n=0,r=this.title,o=this.subtitle,a=this.options,s=a.title,l=a.subtitle,c=this.spacingBox.width-44;r&&(r.css({width:(s.width||c)+Ke}).align(t({y:15},s),!1,"spacingBox"),s.floating||s.verticalAlign||(n=r.getBBox().height,n>=18&&25>=n&&(n=15))),o&&(o.css({width:(l.width||c)+Ke}).align(t({y:n+s.margin},l),!1,"spacingBox"),l.floating||l.verticalAlign||(n=ye(n+o.getBBox().height))),i=this.titleOffset!==n,this.titleOffset=n,!this.isDirtyBox&&i&&(this.isDirtyBox=i,this.hasRendered&&f(e,!0)&&this.isDirtyBox&&this.redraw())
},getChartSize:function(){var t=this,e=t.options.chart,i=e.width,n=e.height,r=t.renderToClone||t.renderTo;d(i)||(t.containerWidth=vi(r,"width")),d(n)||(t.containerHeight=vi(r,"height")),t.chartWidth=xe(0,i||t.containerWidth||600),t.chartHeight=xe(0,f(n,t.containerHeight>19?t.containerHeight:400))},cloneRenderTo:function(t){var e=this.renderToClone,i=this.container;t?e&&(this.renderTo.appendChild(i),P(e),delete this.renderToClone):(i&&i.parentNode===this.renderTo&&this.renderTo.removeChild(i),this.renderToClone=e=this.renderTo.cloneNode(0),g(e,{position:Xe,top:"-9999px",display:"block"}),e.style.setProperty&&e.style.setProperty("display","block","important"),fe.body.appendChild(e),i&&e.appendChild(i))},getContainer:function(){var e,i,o,a,s,l,c=this,h=c.options.chart,d="data-highcharts-chart";c.renderTo=a=h.renderTo,l=Ue+Ne++,r(a)&&(c.renderTo=a=fe.getElementById(a)),a||D(13,!0),s=n(u(a,d)),!isNaN(s)&&Be[s]&&Be[s].hasRendered&&Be[s].destroy(),u(a,d,c.index),a.innerHTML="",h.skipClone||a.offsetWidth||c.cloneRenderTo(),c.getChartSize(),i=c.chartWidth,o=c.chartHeight,c.container=e=m(Ge,{className:Ue+"container"+(h.className?" "+h.className:""),id:l},t({position:Ye,overflow:Ve,width:i+Ke,height:o+Ke,textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},h.style),c.renderToClone||a),c._cursor=e.style.cursor,c.renderer=h.forExport?new Ii(e,i,o,h.style,!0):new Y(e,i,o,h.style),Ie&&c.renderer.create(c,e,i,o)},getMargins:function(){var t,e=this,i=e.spacing,n=e.legend,r=e.margin,o=e.options.legend,a=f(o.margin,10),s=o.x,l=o.y,c=o.align,h=o.verticalAlign,u=e.titleOffset;e.resetMargins(),t=e.axisOffset,u&&!d(r[0])&&(e.plotTop=xe(e.plotTop,u+e.options.title.margin+i[0])),n.display&&!o.floating&&("right"===c?d(r[1])||(e.marginRight=xe(e.marginRight,n.legendWidth-s+a+i[1])):"left"===c?d(r[3])||(e.plotLeft=xe(e.plotLeft,n.legendWidth+s+a+i[3])):"top"===h?d(r[0])||(e.plotTop=xe(e.plotTop,n.legendHeight+l+a+i[0])):"bottom"===h&&(d(r[2])||(e.marginBottom=xe(e.marginBottom,n.legendHeight-l+a+i[2])))),e.extraBottomMargin&&(e.marginBottom+=e.extraBottomMargin),e.extraTopMargin&&(e.plotTop+=e.extraTopMargin),e.hasCartesianSeries&&xi(e.axes,function(t){t.getOffset()}),d(r[3])||(e.plotLeft+=t[3]),d(r[0])||(e.plotTop+=t[0]),d(r[2])||(e.marginBottom+=t[2]),d(r[1])||(e.marginRight+=t[1]),e.setChartSize()},reflow:function(t){var e=this,i=e.options.chart,n=e.renderTo,r=i.width||vi(n,"width"),o=i.height||vi(n,"height"),a=t?t.target:ge,s=function(){e.container&&(e.setSize(r,o,!1),e.hasUserSize=null)};e.hasUserSize||!r||!o||a!==ge&&a!==fe||((r!==e.containerWidth||o!==e.containerHeight)&&(clearTimeout(e.reflowTimeout),t?e.reflowTimeout=setTimeout(s,100):s()),e.containerWidth=r,e.containerHeight=o)},initReflow:function(){var t=this,e=function(e){t.reflow(e)};Ci(ge,"resize",e),Ci(t,"destroy",function(){Ti(ge,"resize",e)})},setSize:function(t,e,i){var n,r,o,a=this;a.isResizing+=1,o=function(){a&&Si(a,"endResize",null,function(){a.isResizing-=1})},E(i,a),a.oldChartHeight=a.chartHeight,a.oldChartWidth=a.chartWidth,d(t)&&(a.chartWidth=n=xe(0,ve(t)),a.hasUserSize=!!n),d(e)&&(a.chartHeight=r=xe(0,ve(e))),(Z?Mi:g)(a.container,{width:n+Ke,height:r+Ke},Z),a.setChartSize(!0),a.renderer.setSize(n,r,i),a.maxTicks=null,xi(a.axes,function(t){t.isDirty=!0,t.setScale()}),xi(a.series,function(t){t.isDirty=!0}),a.isDirtyLegend=!0,a.isDirtyBox=!0,a.getMargins(),a.redraw(i),a.oldChartHeight=null,Si(a,"resize"),Z===!1?o():setTimeout(o,Z&&Z.duration||500)},setChartSize:function(t){var e,i,n,r,o,a,s,l=this,c=l.inverted,h=l.renderer,d=l.chartWidth,u=l.chartHeight,p=l.options.chart,f=l.spacing,g=l.clipOffset;l.plotLeft=n=ve(l.plotLeft),l.plotTop=r=ve(l.plotTop),l.plotWidth=o=xe(0,ve(d-n-l.marginRight)),l.plotHeight=a=xe(0,ve(u-r-l.marginBottom)),l.plotSizeX=c?a:o,l.plotSizeY=c?o:a,l.plotBorderWidth=p.plotBorderWidth||0,l.spacingBox=h.spacingBox={x:f[3],y:f[0],width:d-f[3]-f[1],height:u-f[0]-f[2]},l.plotBox=h.plotBox={x:n,y:r,width:o,height:a},s=2*be(l.plotBorderWidth/2),e=ye(xe(s,g[3])/2),i=ye(xe(s,g[0])/2),l.clipBox={x:e,y:i,width:be(l.plotSizeX-xe(s,g[1])/2-e),height:be(l.plotSizeY-xe(s,g[2])/2-i)},t||xi(l.axes,function(t){t.setAxisSize(),t.setAxisTranslation()})},resetMargins:function(){var t=this,e=t.spacing,i=t.margin;t.plotTop=f(i[0],e[0]),t.marginRight=f(i[1],e[1]),t.marginBottom=f(i[2],e[2]),t.plotLeft=f(i[3],e[3]),t.axisOffset=[0,0,0,0],t.clipOffset=[0,0,0,0]},drawChartBox:function(){var t,e,i=this,n=i.options.chart,r=i.renderer,o=i.chartWidth,a=i.chartHeight,s=i.chartBackground,l=i.plotBackground,c=i.plotBorder,h=i.plotBGImage,d=n.borderWidth||0,u=n.backgroundColor,p=n.plotBackgroundColor,f=n.plotBackgroundImage,g=n.plotBorderWidth||0,m=i.plotLeft,v=i.plotTop,b=i.plotWidth,y=i.plotHeight,x=i.plotBox,_=i.clipRect,w=i.clipBox;t=d+(n.shadow?8:0),(d||u)&&(s?s.animate(s.crisp({width:o-t,height:a-t})):(e={fill:u||Ze},d&&(e.stroke=n.borderColor,e["stroke-width"]=d),i.chartBackground=r.rect(t/2,t/2,o-t,a-t,n.borderRadius,d).attr(e).addClass(Ue+"background").add().shadow(n.shadow))),p&&(l?l.animate(x):i.plotBackground=r.rect(m,v,b,y,0).attr({fill:p}).add().shadow(n.plotShadow)),f&&(h?h.animate(x):i.plotBGImage=r.image(f,m,v,b,y).add()),_?_.animate({width:w.width,height:w.height}):i.clipRect=r.clipRect(w),g&&(c?c.animate(c.crisp({x:m,y:v,width:b,height:y})):i.plotBorder=r.rect(m,v,b,y,0,-g).attr({stroke:n.plotBorderColor,"stroke-width":g,fill:Ze,zIndex:1}).add()),i.isDirtyBox=!1},propFromSeries:function(){var t,e,i,n=this,r=n.options.chart,o=n.options.series;xi(["inverted","angular","polar"],function(a){for(t=pi[r.type||r.defaultSeriesType],i=n[a]||r[a]||t&&t.prototype[a],e=o&&o.length;!i&&e--;)t=pi[o[e].type],t&&t.prototype[a]&&(i=!0);n[a]=i})},linkSeries:function(){var t=this,e=t.series;xi(e,function(t){t.linkedSeries.length=0}),xi(e,function(e){var i=e.options.linkedTo;r(i)&&(i=":previous"===i?t.series[e.index-1]:t.get(i),i&&(i.linkedSeries.push(e),e.linkedParent=i))})},renderSeries:function(){xi(this.series,function(t){t.translate(),t.setTooltipPoints&&t.setTooltipPoints(),t.render()})},render:function(){var e,i=this,r=i.axes,o=i.renderer,a=i.options,s=a.labels,l=a.credits;i.setTitle(),i.legend=new Ki(i,a.legend),i.getStacks(),xi(r,function(t){t.setScale()}),i.getMargins(),i.maxTicks=null,xi(r,function(t){t.setTickPositions(!0),t.setMaxTicks()}),i.adjustTickAmounts(),i.getMargins(),i.drawChartBox(),i.hasCartesianSeries&&xi(r,function(t){t.render()}),i.seriesGroup||(i.seriesGroup=o.g("series-group").attr({zIndex:3}).add()),i.renderSeries(),s.items&&xi(s.items,function(e){var r=t(s.style,e.style),a=n(r.left)+i.plotLeft,l=n(r.top)+i.plotTop+12;delete r.left,delete r.top,o.text(e.html,a,l).attr({zIndex:2}).css(r).add()}),l.enabled&&!i.credits&&(e=l.href,i.credits=o.text(l.text,0,0).on("click",function(){e&&(location.href=e)}).attr({align:l.position.align,zIndex:8}).css(l.style).add().align(l.position)),i.hasRendered=!0},destroy:function(){var t,e=this,i=e.axes,n=e.series,r=e.container,o=r&&r.parentNode;for(Si(e,"destroy"),Be[e.index]=X,e.renderTo.removeAttribute("data-highcharts-chart"),Ti(e),t=i.length;t--;)i[t]=i[t].destroy();for(t=n.length;t--;)n[t]=n[t].destroy();xi(["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","scroller","rangeSelector","legend","resetZoomButton","tooltip","renderer"],function(t){var i=e[t];i&&i.destroy&&(e[t]=i.destroy())}),r&&(r.innerHTML="",Ti(r),o&&P(r));for(t in e)delete e[t]},isReadyToRender:function(){var t=this;return!He&&ge==ge.top&&"complete"!==fe.readyState||Ie&&!ge.canvg?(Ie?Fi.push(function(){t.firstRender()},t.options.global.canvasToolsURL):fe.attachEvent("onreadystatechange",function(){fe.detachEvent("onreadystatechange",t.firstRender),"complete"===fe.readyState&&t.firstRender()}),!1):!0},firstRender:function(){var t=this,e=t.options,i=t.callback;t.isReadyToRender()&&(t.getContainer(),Si(t,"init"),t.resetMargins(),t.setChartSize(),t.propFromSeries(),t.getAxes(),xi(e.series||[],function(e){t.initSeries(e)}),t.linkSeries(),Si(t,"beforeRender"),fi.Pointer&&(t.pointer=new Xi(t,e)),t.render(),t.renderer.draw(),i&&i.apply(t,[t]),xi(t.callbacks,function(e){e.apply(t,[t])}),t.cloneRenderTo(!0),Si(t,"load"))},splashArray:function(t,e){var i=e[t],n=o(i)?i:[i,i,i,i];return[f(e[t+"Top"],n[0]),f(e[t+"Right"],n[1]),f(e[t+"Bottom"],n[2]),f(e[t+"Left"],n[3])]}},B.prototype.callbacks=[];var Ji=fi.CenteredSeriesMixin={getCenter:function(){var t,e,i=this.options,r=this.chart,o=2*(i.slicedOffset||0),a=r.plotWidth-2*o,s=r.plotHeight-2*o,l=i.center,c=[f(l[0],"50%"),f(l[1],"50%"),i.size||"100%",i.innerSize||0],h=_e(a,s);return ki(c,function(i,r){return e=/%$/.test(i),t=2>r||2===r&&e,(e?[a,s,h,h][r]*n(i)/100:i)+(t?o:0)})}},Qi=function(){};Qi.prototype={init:function(t,e,i){var n,r=this;return r.series=t,r.applyOptions(e,i),r.pointAttr={},t.options.colorByPoint&&(n=t.options.colors||t.chart.options.colors,r.color=r.color||n[t.colorCounter++],t.colorCounter===n.length&&(t.colorCounter=0)),t.chart.pointCount++,r},applyOptions:function(e,i){var n=this,r=n.series,o=r.pointValKey;return e=Qi.prototype.optionsToObject.call(this,e),t(n,e),n.options=n.options?t(n.options,e):e,o&&(n.y=n[o]),n.x===X&&r&&(n.x=i===X?r.autoIncrement():i),n},optionsToObject:function(t){var e,i={},n=this.series,r=n.pointArrayMap||["y"],o=r.length,s=0,l=0;if("number"==typeof t||null===t)i[r[0]]=t;else if(a(t))for(t.length>o&&(e=typeof t[0],"string"===e?i.name=t[0]:"number"===e&&(i.x=t[0]),s++);o>l;)i[r[l++]]=t[s++];else"object"==typeof t&&(i=t,t.dataLabels&&(n._hasPointLabels=!0),t.marker&&(n._hasPointMarkers=!0));return i},destroy:function(){var t,e=this,i=e.series,n=i.chart,r=n.hoverPoints;n.pointCount--,r&&(e.setState(),h(r,e),r.length||(n.hoverPoints=null)),e===n.hoverPoint&&e.onMouseOut(),(e.graphic||e.dataLabel)&&(Ti(e),e.destroyElements()),e.legendItem&&n.legend.destroyItem(e);for(t in e)e[t]=null},destroyElements:function(){for(var t,e=this,i=["graphic","dataLabel","dataLabelUpper","group","connector","shadowGroup"],n=6;n--;)t=i[n],e[t]&&(e[t]=e[t].destroy())},getLabelConfig:function(){var t=this;return{x:t.category,y:t.y,key:t.name||t.category,series:t.series,point:t,percentage:t.percentage,total:t.total||t.stackTotal}},tooltipFormatter:function(t){var e=this.series,i=e.tooltipOptions,n=f(i.valueDecimals,""),r=i.valuePrefix||"",o=i.valueSuffix||"";return xi(e.pointArrayMap||["y"],function(e){e="{point."+e,(r||o)&&(t=t.replace(e+"}",r+e+"}"+o)),t=t.replace(e+"}",e+":,."+n+"f}")}),k(t,{point:this,series:this.series})}};var tn=function(){};tn.prototype={isCartesian:!0,type:"line",pointClass:Qi,sorted:!0,requireSorting:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],init:function(e,i){var n,r,o=this,a=e.series,s=function(t,e){return f(t.options.index,t._i)-f(e.options.index,e._i)};o.chart=e,o.options=i=o.setOptions(i),o.linkedSeries=[],o.bindAxes(),t(o,{name:i.name,state:ei,pointAttr:{},visible:i.visible!==!1,selected:i.selected===!0}),Ie&&(i.animation=!1),r=i.events;for(n in r)Ci(o,n,r[n]);(r&&r.click||i.point&&i.point.events&&i.point.events.click||i.allowPointSelect)&&(e.runTrackerClick=!0),o.getColor(),o.getSymbol(),xi(o.parallelArrays,function(t){o[t+"Data"]=[]}),o.setData(i.data,!1),o.isCartesian&&(e.hasCartesianSeries=!0),a.push(o),o._i=a.length-1,L(a,s),this.yAxis&&L(this.yAxis.series,s),xi(a,function(t,e){t.index=e,t.name=t.name||"Series "+(e+1)})},bindAxes:function(){var t,e=this,i=e.options,n=e.chart;xi(e.axisTypes||[],function(r){xi(n[r],function(n){t=n.options,(i[r]===t.index||i[r]!==X&&i[r]===t.id||i[r]===X&&0===t.index)&&(n.series.push(e),e[r]=n,n.isDirty=!0)}),e[r]||e.optionalAxis===r||D(18,!0)})},updateParallelArrays:function(t,e){var i=t.series,n=arguments,r="number"==typeof e?function(n){var r="y"===n&&i.toYData?i.toYData(t):t[n];i[n+"Data"][e]=r}:function(t){Array.prototype[e].apply(i[t+"Data"],Array.prototype.slice.call(n,2))};xi(i.parallelArrays,r)},autoIncrement:function(){var t=this,e=t.options,i=t.xIncrement;return i=f(i,e.pointStart,0),t.pointInterval=f(t.pointInterval,e.pointInterval,1),t.xIncrement=i+t.pointInterval,i},getSegments:function(){var t,e=this,i=-1,n=[],r=e.points,o=r.length;if(o)if(e.options.connectNulls){for(t=o;t--;)null===r[t].y&&r.splice(t,1);r.length&&(n=[r])}else xi(r,function(t,e){null===t.y?(e>i+1&&n.push(r.slice(i+1,e)),i=e):e===o-1&&n.push(r.slice(i+1,e+1))});e.segments=n},setOptions:function(t){var i,n=this.chart,r=n.options,o=r.plotOptions,a=n.userOptions||{},s=a.plotOptions||{},l=o[this.type];return this.userOptions=t,i=e(l,o.series,t),this.tooltipOptions=e(j.tooltip,j.plotOptions[this.type].tooltip,a.tooltip,s.series&&s.series.tooltip,s[this.type]&&s[this.type].tooltip,t.tooltip),null===l.marker&&delete i.marker,i},getColor:function(){var t,e,i=this.options,n=this.userOptions,r=this.chart.options.colors,o=this.chart.counters;t=i.color||Pi[this.type].color,t||i.colorByPoint||(d(n._colorIndex)?e=n._colorIndex:(n._colorIndex=o.color,e=o.color++),t=r[e]),this.color=t,o.wrapColor(r.length)},getSymbol:function(){var t,e=this,i=e.userOptions,n=e.options.marker,r=e.chart,o=r.options.symbols,a=r.counters;e.symbol=n.symbol,e.symbol||(d(i._symbolIndex)?t=i._symbolIndex:(i._symbolIndex=a.symbol,t=a.symbol++),e.symbol=o[t]),/^url/.test(e.symbol)&&(n.radius=0),a.wrapSymbol(o.length)},drawLegendSymbol:Zi.drawLineMarker,setData:function(t,e,i,n){var o,l,c,h=this,d=h.points,u=d&&d.length||0,p=h.options,g=h.chart,m=null,v=h.xAxis,b=v&&!!v.categories,y=h.tooltipPoints,x=p.turboThreshold,_=this.xData,w=this.yData,k=h.pointArrayMap,C=k&&k.length;if(t=t||[],o=t.length,e=f(e,!0),n===!1||!o||u!==o||h.cropped||h.hasGroupedData){if(h.xIncrement=null,h.pointRange=b?1:p.pointRange,h.colorCounter=0,xi(this.parallelArrays,function(t){h[t+"Data"].length=0}),x&&o>x){for(l=0;null===m&&o>l;)m=t[l],l++;if(s(m)){var T=f(p.pointStart,0),S=f(p.pointInterval,1);for(l=0;o>l;l++)_[l]=T,w[l]=t[l],T+=S;h.xIncrement=T}else if(a(m))if(C)for(l=0;o>l;l++)c=t[l],_[l]=c[0],w[l]=c.slice(1,C+1);else for(l=0;o>l;l++)c=t[l],_[l]=c[0],w[l]=c[1];else D(12)}else for(l=0;o>l;l++)t[l]!==X&&(c={series:h},h.pointClass.prototype.applyOptions.apply(c,[t[l]]),h.updateParallelArrays(c,l),b&&c.name&&(v.names[c.x]=c.name));for(r(w[0])&&D(14,!0),h.data=[],h.options.data=t,l=u;l--;)d[l]&&d[l].destroy&&d[l].destroy();y&&(y.length=0),v&&(v.minRange=v.userMinRange),h.isDirty=h.isDirtyData=g.isDirtyBox=!0,i=!1}else xi(t,function(t,e){d[e].update(t,!1)});e&&g.redraw(i)},processData:function(t){var e,i,n,r,o,a=this,s=a.xData,l=a.yData,c=s.length,h=0,d=a.xAxis,u=a.options,p=u.cropThreshold,f=a.isCartesian;if(f&&!a.isDirty&&!d.isDirty&&!a.yAxis.isDirty&&!t)return!1;if(f&&a.sorted&&(!p||c>p||a.forceCrop)){var g=d.min,m=d.max;s[c-1]<g||s[0]>m?(s=[],l=[]):(s[0]<g||s[c-1]>m)&&(e=this.cropData(a.xData,a.yData,g,m),s=e.xData,l=e.yData,h=e.start,i=!0)}for(o=s.length-1;o>=0;o--)n=s[o]-s[o-1],n>0&&(r===X||r>n)?r=n:0>n&&a.requireSorting&&D(15);a.cropped=i,a.cropStart=h,a.processedXData=s,a.processedYData=l,null===u.pointRange&&(a.pointRange=r||1),a.closestPointRange=r},cropData:function(t,e,i,n){var r,o=t.length,a=0,s=o,l=f(this.cropShoulder,1);for(r=0;o>r;r++)if(t[r]>=i){a=xe(0,r-l);break}for(;o>r;r++)if(t[r]>n){s=r+l;break}return{xData:t.slice(a,s),yData:e.slice(a,s),start:a,end:s}},generatePoints:function(){var t,e,i,n,r=this,o=r.options,a=o.data,s=r.data,l=r.processedXData,c=r.processedYData,h=r.pointClass,d=l.length,u=r.cropStart||0,f=r.hasGroupedData,g=[];if(!s&&!f){var m=[];m.length=a.length,s=r.data=m}for(n=0;d>n;n++)e=u+n,f?g[n]=(new h).init(r,[l[n]].concat(p(c[n]))):(s[e]?i=s[e]:a[e]!==X&&(s[e]=i=(new h).init(r,a[e],l[n])),g[n]=i);if(s&&(d!==(t=s.length)||f))for(n=0;t>n;n++)n!==u||f||(n+=d),s[n]&&(s[n].destroyElements(),s[n].plotX=X);r.data=s,r.points=g},getExtremes:function(t){var e,i,n,r,o,a,s,l,c,h=this.xAxis,d=this.yAxis,u=this.processedXData,p=[],g=0,m=h.getExtremes(),v=m.min,b=m.max;for(t=t||this.stackedYData||this.processedYData,e=t.length,l=0;e>l;l++)if(a=u[l],s=t[l],i=null!==s&&s!==X&&(!d.isLog||s.length||s>0),n=this.getExtremesFromAll||this.cropped||(u[l+1]||a)>=v&&(u[l-1]||a)<=b,i&&n)if(c=s.length)for(;c--;)null!==s[c]&&(p[g++]=s[c]);else p[g++]=s;this.dataMin=f(r,M(p)),this.dataMax=f(o,A(p))},translate:function(){this.processedXData||this.processData(),this.generatePoints();var t,e=this,i=e.options,n=i.stacking,r=e.xAxis,o=r.categories,a=e.yAxis,l=e.points,c=l.length,h=!!e.modifyValue,u=i.pointPlacement,p="between"===u||s(u),g=i.threshold;for(t=0;c>t;t++){var m,v,b=l[t],y=b.x,x=b.y,_=b.low,w=n&&a.stacks[(e.negStacks&&g>x?"-":"")+e.stackKey];a.isLog&&0>=x&&(b.y=x=null),b.plotX=r.translate(y,0,0,0,1,u,"flags"===this.type),n&&e.visible&&w&&w[y]&&(m=w[y],v=m.points[e.index],_=v[0],x=v[1],0===_&&(_=f(g,a.min)),a.isLog&&0>=_&&(_=null),b.total=b.stackTotal=m.total,b.percentage=m.total&&100*(b.y/m.total),b.stackY=x,m.setOffset(e.pointXOffset||0,e.barW||0)),b.yBottom=d(_)?a.translate(_,0,1,0,1):null,h&&(x=e.modifyValue(x,b)),b.plotY="number"==typeof x&&1/0!==x?a.translate(x,0,1,0,1):X,b.clientX=p?r.translate(y,0,0,0,1):b.plotX,b.negative=b.y<(g||0),b.category=o&&o[b.x]!==X?o[b.x]:b.x}e.getSegments()},animate:function(e){var i,n,r,a=this,s=a.chart,l=s.renderer,c=a.options.animation,h=s.clipBox,d=s.inverted;c&&!o(c)&&(c=Pi[a.type].animation),r="_sharedClip"+c.duration+c.easing,e?(i=s[r],n=s[r+"m"],i||(s[r]=i=l.clipRect(t(h,{width:0})),s[r+"m"]=n=l.clipRect(-99,d?-s.plotLeft:-s.plotTop,99,d?s.chartWidth:s.chartHeight)),a.group.clip(i),a.markerGroup.clip(n),a.sharedClipKey=r):(i=s[r],i&&(i.animate({width:s.plotSizeX},c),s[r+"m"].animate({width:s.plotSizeX+99},c)),a.animate=null,a.animationTimeout=setTimeout(function(){a.afterAnimate()},c.duration))},afterAnimate:function(){var t=this.chart,e=this.sharedClipKey,i=this.group;i&&this.options.clip!==!1&&(i.clip(t.clipRect),this.markerGroup.clip()),setTimeout(function(){e&&t[e]&&(t[e]=t[e].destroy(),t[e+"m"]=t[e+"m"].destroy())},100)},drawPoints:function(){var e,i,n,r,o,a,s,l,c,h,d,u,p=this,g=p.points,m=p.chart,v=p.options,b=v.marker,y=p.pointAttr[""],x=p.markerGroup;if(b.enabled||p._hasPointMarkers)for(r=g.length;r--;)o=g[r],i=be(o.plotX),n=o.plotY,c=o.graphic,h=o.marker||{},d=b.enabled&&h.enabled===X||h.enabled,u=m.isInsidePlot(ve(i),n,m.inverted),d&&n!==X&&!isNaN(n)&&null!==o.y?(e=o.pointAttr[o.selected?ni:ei]||y,a=e.r,s=f(h.symbol,p.symbol),l=0===s.indexOf("url"),c?c.attr({visibility:u?"inherit":Ve}).animate(t({x:i-a,y:n-a},c.symbolName?{width:2*a,height:2*a}:{})):u&&(a>0||l)&&(o.graphic=c=m.renderer.symbol(s,i-a,n-a,2*a,2*a).attr(e).add(x))):c&&(o.graphic=c.destroy())},convertAttribs:function(t,e,i,n){var r,o,a=this.pointAttrToOptions,s={};t=t||{},e=e||{},i=i||{},n=n||{};for(r in a)o=a[r],s[r]=f(t[o],e[r],i[r],n[r]);return s},getAttribs:function(){var e,i,n,r,o,a,s=this,l=s.options,c=Pi[s.type].marker?l.marker:l,h=c.states,u=h[ii],p=s.color,f={stroke:p,fill:p},g=s.points||[],m=[],v=s.pointAttrToOptions,b=s.hasPointSpecificOptions,y=l.negativeColor,x=c.lineColor,_=c.fillColor,w=l.turboThreshold;if(l.marker?(u.radius=u.radius||c.radius+2,u.lineWidth=u.lineWidth||c.lineWidth+1):u.color=u.color||zi(u.color||p).brighten(u.brightness).get(),m[ei]=s.convertAttribs(c,f),xi([ii,ni],function(t){m[t]=s.convertAttribs(h[t],m[ei])}),s.pointAttr=m,i=g.length,!w||w>i||b)for(;i--;){if(n=g[i],c=n.options&&n.options.marker||n.options,c&&c.enabled===!1&&(c.radius=0),n.negative&&y&&(n.color=n.fillColor=y),b=l.colorByPoint||n.color,n.options)for(a in v)d(c[v[a]])&&(b=!0);b?(c=c||{},r=[],h=c.states||{},e=h[ii]=h[ii]||{},l.marker||(e.color=e.color||!n.options.color&&u.color||zi(n.color).brighten(e.brightness||u.brightness).get()),o={color:n.color},_||(o.fillColor=n.color),x||(o.lineColor=n.color),r[ei]=s.convertAttribs(t(o,c),m[ei]),r[ii]=s.convertAttribs(h[ii],m[ii],r[ei]),r[ni]=s.convertAttribs(h[ni],m[ni],r[ei])):r=m,n.pointAttr=r}},destroy:function(){var t,e,i,n,r,o=this,a=o.chart,s=/AppleWebKit\/533/.test(Le),l=o.data||[];for(Si(o,"destroy"),Ti(o),xi(o.axisTypes||[],function(t){r=o[t],r&&(h(r.series,o),r.isDirty=r.forceRedraw=!0)}),o.legendItem&&o.chart.legend.destroyItem(o),e=l.length;e--;)i=l[e],i&&i.destroy&&i.destroy();o.points=null,clearTimeout(o.animationTimeout),xi(["area","graph","dataLabelsGroup","group","markerGroup","tracker","graphNeg","areaNeg","posClip","negClip"],function(e){o[e]&&(t=s&&"group"===e?"hide":"destroy",o[e][t]())}),a.hoverSeries===o&&(a.hoverSeries=null),h(a.series,o);for(n in o)delete o[n]},getSegmentPath:function(t){var e=this,i=[],n=e.options.step;return xi(t,function(r,o){var a,s=r.plotX,l=r.plotY;e.getPointSpline?i.push.apply(i,e.getPointSpline(t,r,o)):(i.push(o?Qe:Je),n&&o&&(a=t[o-1],"right"===n?i.push(a.plotX,l):"center"===n?i.push((a.plotX+s)/2,a.plotY,(a.plotX+s)/2,l):i.push(s,a.plotY)),i.push(r.plotX,r.plotY))}),i},getGraphPath:function(){var t,e=this,i=[],n=[];return xi(e.segments,function(r){t=e.getSegmentPath(r),r.length>1?i=i.concat(t):n.push(r[0])}),e.singlePoints=n,e.graphPath=i,i},drawGraph:function(){var t=this,e=this.options,i=[["graph",e.lineColor||this.color]],n=e.lineWidth,r=e.dashStyle,o="square"!==e.linecap,a=this.getGraphPath(),s=e.negativeColor;s&&i.push(["graphNeg",s]),xi(i,function(i,s){var l,c=i[0],h=t[c];h?(Ai(h),h.animate({d:a})):n&&a.length&&(l={stroke:i[1],"stroke-width":n,fill:Ze,zIndex:1},r?l.dashstyle=r:o&&(l["stroke-linecap"]=l["stroke-linejoin"]="round"),t[c]=t.chart.renderer.path(a).attr(l).add(t.group).shadow(!s&&e.shadow))})},clipNeg:function(){var t,e,i,n,r,o=this.options,a=this.chart,s=a.renderer,l=o.negativeColor||o.negativeFillColor,c=this.graph,h=this.area,d=this.posClip,u=this.negClip,p=a.chartWidth,f=a.chartHeight,g=xe(p,f),m=this.yAxis;l&&(c||h)&&(t=ve(m.toPixels(o.threshold||0,!0)),0>t&&(g-=t),n={x:0,y:0,width:g,height:t},r={x:0,y:t,width:g,height:g},a.inverted&&(n.height=r.y=a.plotWidth-t,s.isVML&&(n={x:a.plotWidth-t-a.plotLeft,y:0,width:p,height:f},r={x:t+a.plotLeft-p,y:0,width:a.plotLeft+t,height:p})),m.reversed?(e=r,i=n):(e=n,i=r),d?(d.animate(e),u.animate(i)):(this.posClip=d=s.clipRect(e),this.negClip=u=s.clipRect(i),c&&this.graphNeg&&(c.clip(d),this.graphNeg.clip(u)),h&&(h.clip(d),this.areaNeg.clip(u))))},invertGroups:function(){function t(){var t={width:e.yAxis.len,height:e.xAxis.len};xi(["group","markerGroup"],function(i){e[i]&&e[i].attr(t).invert()})}var e=this,i=e.chart;e.xAxis&&(Ci(i,"resize",t),Ci(e,"destroy",function(){Ti(i,"resize",t)}),t(),e.invertGroups=t)},plotGroup:function(t,e,i,n,r){var o=this[t],a=!o;return a&&(this[t]=o=this.chart.renderer.g(e).attr({visibility:i,zIndex:n||.1}).add(r)),o[a?"attr":"animate"](this.getPlotBox()),o},getPlotBox:function(){return{translateX:this.xAxis?this.xAxis.left:this.chart.plotLeft,translateY:this.yAxis?this.yAxis.top:this.chart.plotTop,scaleX:1,scaleY:1}},render:function(){var t,e=this,i=e.chart,n=e.options,r=n.animation,o=r&&!!e.animate&&i.renderer.isSVG,a=e.visible?je:Ve,s=n.zIndex,l=e.hasRendered,c=i.seriesGroup;t=e.plotGroup("group","series",a,s,c),e.markerGroup=e.plotGroup("markerGroup","markers",a,s,c),o&&e.animate(!0),e.getAttribs(),t.inverted=e.isCartesian?i.inverted:!1,e.drawGraph&&(e.drawGraph(),e.clipNeg()),e.drawDataLabels&&e.drawDataLabels(),e.visible&&e.drawPoints(),e.drawTracker&&e.options.enableMouseTracking!==!1&&e.drawTracker(),i.inverted&&e.invertGroups(),n.clip===!1||e.sharedClipKey||l||t.clip(i.clipRect),o?e.animate():l||e.afterAnimate(),e.isDirty=e.isDirtyData=!1,e.hasRendered=!0},redraw:function(){var t=this,e=t.chart,i=t.isDirtyData,n=t.group,r=t.xAxis,o=t.yAxis;n&&(e.inverted&&n.attr({width:e.plotWidth,height:e.plotHeight}),n.animate({translateX:f(r&&r.left,e.plotLeft),translateY:f(o&&o.top,e.plotTop)})),t.translate(),t.setTooltipPoints(!0),t.render(),i&&Si(t,"updatedData")}},F.prototype={destroy:function(){$(this,this.axis)},render:function(t){var e=this.options,i=e.format,n=i?k(i,this):e.formatter.call(this);this.label?this.label.attr({text:n,visibility:Ve}):this.label=this.axis.chart.renderer.text(n,0,0,e.useHTML).css(e.style).attr({align:this.textAlign,rotation:e.rotation,visibility:Ve}).add(t)},setOffset:function(t,e){var i,n=this,r=n.axis,o=r.chart,a=o.inverted,s=this.isNegative,l=r.translate(this.percent?100:this.total,0,0,0,1),c=r.translate(0),h=we(l-c),d=o.xAxis[0].translate(this.x)+t,u=o.plotHeight,p={x:a?s?l:l-h:d,y:a?u-d-e:s?u-l-h:u-l,width:a?h:e,height:a?e:h},f=this.label;f&&(f.align(this.alignOptions,null,p),i=f.alignAttr,f[this.options.crop===!1||o.isInsidePlot(i.x,i.y)?"show":"hide"](!0))}},R.prototype.buildStacks=function(){var t=this.series,e=f(this.options.reversedStacks,!0),i=t.length;if(!this.isXAxis){for(this.usePercentage=!1;i--;)t[e?i:t.length-i-1].setStackedPoints();if(this.usePercentage)for(i=0;i<t.length;i++)t[i].setPercentStacks()}},R.prototype.renderStackTotals=function(){var t,e,i,n=this,r=n.chart,o=r.renderer,a=n.stacks,s=n.stackTotalGroup;s||(n.stackTotalGroup=s=o.g("stack-labels").attr({visibility:je,zIndex:6}).add()),s.translate(r.plotLeft,r.plotTop);for(t in a){e=a[t];for(i in e)e[i].render(s)}},tn.prototype.setStackedPoints=function(){if(this.options.stacking&&(this.visible===!0||this.chart.options.chart.ignoreHiddenSeries===!1)){var t,e,i,n,r,o,a,s=this,l=s.processedXData,c=s.processedYData,h=[],d=c.length,u=s.options,p=u.threshold,f=u.stack,g=u.stacking,m=s.stackKey,v="-"+m,b=s.negStacks,y=s.yAxis,x=y.stacks,_=y.oldStacks;for(r=0;d>r;r++)o=l[r],a=c[r],t=b&&p>a,n=t?v:m,x[n]||(x[n]={}),x[n][o]||(_[n]&&_[n][o]?(x[n][o]=_[n][o],x[n][o].total=null):x[n][o]=new F(y,y.options.stackLabels,t,o,f,g)),e=x[n][o],e.points[s.index]=[e.cum||0],"percent"===g?(i=t?m:v,b&&x[i]&&x[i][o]?(i=x[i][o],e.total=i.total=xe(i.total,e.total)+we(a)||0):e.total=O(e.total+(we(a)||0))):e.total=O(e.total+(a||0)),e.cum=(e.cum||0)+(a||0),e.points[s.index].push(e.cum),h[r]=e.cum;"percent"===g&&(y.usePercentage=!0),this.stackedYData=h,y.oldStacks={}}},tn.prototype.setPercentStacks=function(){var t=this,e=t.stackKey,i=t.yAxis.stacks,n=t.processedXData;xi([e,"-"+e],function(e){for(var r,o,a,s,l=n.length;l--;)r=n[l],o=i[e]&&i[e][r],a=o&&o.points[t.index],a&&(s=o.total?100/o.total:0,a[0]=O(a[0]*s),a[1]=O(a[1]*s),t.stackedYData[l]=a[1])})},t(B.prototype,{addSeries:function(t,e,i){var n,r=this;return t&&(e=f(e,!0),Si(r,"addSeries",{options:t},function(){n=r.initSeries(t),r.isDirtyLegend=!0,r.linkSeries(),e&&r.redraw(i)})),n},addAxis:function(t,i,n,r){var o,a=i?"xAxis":"yAxis",s=this.options;o=new R(this,e(t,{index:this[a].length,isX:i})),s[a]=p(s[a]||{}),s[a].push(t),f(n,!0)&&this.redraw(r)},showLoading:function(e){var i=this,n=i.options,r=i.loadingDiv,o=n.loading;r||(i.loadingDiv=r=m(Ge,{className:Ue+"loading"},t(o.style,{zIndex:10,display:Ze}),i.container),i.loadingSpan=m("span",null,o.labelStyle,r)),i.loadingSpan.innerHTML=e||n.lang.loading,i.loadingShown||(g(r,{opacity:0,display:"",left:i.plotLeft+Ke,top:i.plotTop+Ke,width:i.plotWidth+Ke,height:i.plotHeight+Ke}),Mi(r,{opacity:o.style.opacity},{duration:o.showDuration||0}),i.loadingShown=!0)},hideLoading:function(){var t=this.options,e=this.loadingDiv;e&&Mi(e,{opacity:0},{duration:t.loading.hideDuration||100,complete:function(){g(e,{display:Ze})}}),this.loadingShown=!1}}),t(Qi.prototype,{update:function(t,e,i){var n,r=this,a=r.series,s=r.graphic,l=a.data,c=a.chart,h=a.options;e=f(e,!0),r.firePointEvent("update",{options:t},function(){r.applyOptions(t),o(t)&&(a.getAttribs(),s&&(t&&t.marker&&t.marker.symbol?r.graphic=s.destroy():s.attr(r.pointAttr[r.state||""])),t&&t.dataLabels&&r.dataLabel&&(r.dataLabel=r.dataLabel.destroy())),n=yi(r,l),a.updateParallelArrays(r,n),h.data[n]=r.options,a.isDirty=a.isDirtyData=!0,!a.fixedBox&&a.hasCartesianSeries&&(c.isDirtyBox=!0),"point"===h.legendType&&c.legend.destroyItem(r),e&&c.redraw(i)})},remove:function(t,e){var i,n=this,r=n.series,o=r.points,a=r.chart,s=r.data;E(e,a),t=f(t,!0),n.firePointEvent("remove",null,function(){i=yi(n,s),s.length===o.length&&o.splice(i,1),s.splice(i,1),r.options.data.splice(i,1),r.updateParallelArrays(n,"splice",i,1),n.destroy(),r.isDirty=!0,r.isDirtyData=!0,t&&a.redraw()})}}),t(tn.prototype,{updateNavigator:function(t){this.chart.scroller&&(this.chart.redraw(),this.chart.scroller.updatedDataHandler(null,!0,t))},addPoint:function(t,e,i,n){var r,o,a,s,l=this,c=l.options,h=l.data,d=l.graph,u=l.area,p=l.chart,g=l.xAxis&&l.xAxis.names,m=d&&d.shift||0,v=c.data,b=l.xData;if(E(n,p),i&&xi([d,u,l.graphNeg,l.areaNeg],function(t){t&&(t.shift=m+1)}),u&&(u.isArea=!0),e=f(e,!0),r={series:l},l.pointClass.prototype.applyOptions.apply(r,[t]),a=r.x,s=b.length,l.requireSorting&&a<b[s-1])for(o=!0;s&&b[s-1]>a;)s--;l.updateParallelArrays(r,"splice",s,0,0),l.updateParallelArrays(r,s),g&&(g[a]=r.name),v.splice(s,0,t),o&&(l.data.splice(s,0,null),l.processData()),"point"===c.legendType&&l.generatePoints(),i&&(h[0]&&h[0].remove?h[0].remove(!1):(h.shift(),l.updateParallelArrays(r,"shift"),v.shift())),l.isDirty=!0,l.isDirtyData=!0,e&&(l.getAttribs(),p.redraw())},remove:function(t,e){var i=this,n=i.chart;t=f(t,!0),i.isRemoving||(i.isRemoving=!0,Si(i,"remove",null,function(){i.destroy(),n.isDirtyLegend=n.isDirtyBox=!0,n.linkSeries(),t&&n.redraw(e)})),i.isRemoving=!1},update:function(i,n){var r,o=this.chart,a=this.userOptions,s=this.type,l=pi[s].prototype;i=e(a,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},i),this.remove(!1);for(r in l)l.hasOwnProperty(r)&&(this[r]=X);t(this,pi[i.type||s].prototype),this.init(o,i),f(n,!0)&&o.redraw(!1)}}),t(R.prototype,{update:function(i,n){var r=this.chart;i=r.options[this.coll][this.options.index]=e(this.userOptions,i),this.destroy(!0),this._addedPlotLB=this.userMin=this.userMax=X,this.init(r,t(i,{events:X})),r.isDirtyBox=!0,f(n,!0)&&r.redraw()},remove:function(t){for(var e=this.chart,i=this.coll,n=this.series,r=n.length;r--;)n[r]&&n[r].remove(!1);h(e.axes,this),h(e[i],this),e.options[i].splice(this.options.index,1),xi(e[i],function(t,e){t.options.index=e}),this.destroy(),e.isDirtyBox=!0,f(t,!0)&&e.redraw()},setTitle:function(t,e){this.update({title:t},e)},setCategories:function(t,e){this.update({categories:t},e)}});var en=v(tn);pi.line=en,Pi.area=e(Di,{threshold:0});var nn=v(tn,{type:"area",getSegments:function(){var t,e,i,n,r,o=[],a=[],s=[],l=this.xAxis,c=this.yAxis,h=c.stacks[this.stackKey],d={},u=this.points,p=this.options.connectNulls;if(this.options.stacking&&!this.cropped){for(n=0;n<u.length;n++)d[u[n].x]=u[n];for(r in h)null!==h[r].total&&s.push(+r);s.sort(function(t,e){return t-e}),xi(s,function(n){(!p||d[n]&&null!==d[n].y)&&(d[n]?a.push(d[n]):(t=l.translate(n),i=h[n].percent?h[n].total?100*h[n].cum/h[n].total:0:h[n].cum,e=c.toPixels(i,!0),a.push({y:null,plotX:t,clientX:t,plotY:e,yBottom:e,onMouseOver:Re})))}),a.length&&o.push(a)}else tn.prototype.getSegments.call(this),o=this.segments;this.segments=o},getSegmentPath:function(t){var e,i,n=tn.prototype.getSegmentPath.call(this,t),r=[].concat(n),o=this.options,a=n.length,s=this.yAxis.getThreshold(o.threshold);if(3===a&&r.push(Qe,n[1],n[2]),o.stacking&&!this.closedStacks)for(e=t.length-1;e>=0;e--)i=f(t[e].yBottom,s),e<t.length-1&&o.step&&r.push(t[e+1].plotX,i),r.push(t[e].plotX,i);else this.closeSegment(r,t,s);return this.areaPath=this.areaPath.concat(r),n},closeSegment:function(t,e,i){t.push(Qe,e[e.length-1].plotX,i,Qe,e[0].plotX,i)},drawGraph:function(){this.areaPath=[],tn.prototype.drawGraph.apply(this);var t=this,e=this.areaPath,i=this.options,n=i.negativeColor,r=i.negativeFillColor,o=[["area",this.color,i.fillColor]];(n||r)&&o.push(["areaNeg",n,r]),xi(o,function(n){var r=n[0],o=t[r];o?o.animate({d:e}):t[r]=t.chart.renderer.path(e).attr({fill:f(n[2],zi(n[1]).setOpacity(f(i.fillOpacity,.75)).get()),zIndex:0}).add(t.group)})},drawLegendSymbol:Zi.drawRectangle});pi.area=nn,Pi.spline=e(Di);var rn=v(tn,{type:"spline",getPointSpline:function(t,e,i){var n,r,o,a,s,l=1.5,c=l+1,h=e.plotX,d=e.plotY,u=t[i-1],p=t[i+1];if(u&&p){var f,g=u.plotX,m=u.plotY,v=p.plotX,b=p.plotY;n=(l*h+g)/c,r=(l*d+m)/c,o=(l*h+v)/c,a=(l*d+b)/c,f=(a-r)*(o-h)/(o-n)+d-a,r+=f,a+=f,r>m&&r>d?(r=xe(m,d),a=2*d-r):m>r&&d>r&&(r=_e(m,d),a=2*d-r),a>b&&a>d?(a=xe(b,d),r=2*d-a):b>a&&d>a&&(a=_e(b,d),r=2*d-a),e.rightContX=o,e.rightContY=a}return i?(s=["C",u.rightContX||u.plotX,u.rightContY||u.plotY,n||h,r||d,h,d],u.rightContX=u.rightContY=null):s=[Je,h,d],s}});pi.spline=rn,Pi.areaspline=e(Pi.area);var on=nn.prototype,an=v(rn,{type:"areaspline",closedStacks:!0,getSegmentPath:on.getSegmentPath,closeSegment:on.closeSegment,drawGraph:on.drawGraph,drawLegendSymbol:Zi.drawRectangle});pi.areaspline=an,Pi.column=e(Di,{borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:.1,shadow:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},stickyTracking:!1,threshold:0});
var sn=v(tn,{type:"column",pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color",r:"borderRadius"},cropShoulder:0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){tn.prototype.init.apply(this,arguments);var t=this,e=t.chart;e.hasRendered&&xi(e.series,function(e){e.type===t.type&&(e.isDirty=!0)})},getColumnMetrics:function(){var t,e,i=this,n=i.options,r=i.xAxis,o=i.yAxis,a=r.reversed,s={},l=0;n.grouping===!1?l=1:xi(i.chart.series,function(n){var r=n.options,a=n.yAxis;n.type===i.type&&n.visible&&o.len===a.len&&o.pos===a.pos&&(r.stacking?(t=n.stackKey,s[t]===X&&(s[t]=l++),e=s[t]):r.grouping!==!1&&(e=l++),n.columnIndex=e)});var c=_e(we(r.transA)*(r.ordinalSlope||n.pointRange||r.closestPointRange||r.tickInterval||1),r.len),h=c*n.groupPadding,u=c-2*h,p=u/l,g=n.pointWidth,m=d(g)?(p-g)/2:p*n.pointPadding,v=f(g,p-2*m),b=(a?l-(i.columnIndex||0):i.columnIndex)||0,y=m+(h+b*p-c/2)*(a?-1:1);return i.columnMetrics={width:v,offset:y}},translate:function(){var t=this,e=t.chart,i=t.options,n=i.borderWidth,r=t.yAxis,o=i.threshold,a=t.translatedThreshold=r.getThreshold(o),s=f(i.minPointLength,5),l=t.getColumnMetrics(),c=l.width,h=t.barW=ye(xe(c,1+2*n)),d=t.pointXOffset=l.offset,u=-(n%2?.5:0),p=n%2?.5:1;e.renderer.isVML&&e.inverted&&(p+=1),tn.prototype.translate.apply(t),xi(t.points,function(t){var e,i,n,o,l=f(t.yBottom,a),g=_e(xe(-999-l,t.plotY),r.len+999+l),m=t.plotX+d,v=h,b=_e(g,l),y=xe(g,l)-b;we(y)<s&&s&&(y=s,b=ve(we(b-a)>s?l-s:a-(r.translate(t.y,0,1,0,1)<=a?s:0))),t.barX=m,t.pointWidth=c,o=we(m)<.5,e=ve(m+v)+u,m=ve(m)+u,v=e-m,n=we(b)<.5,i=ve(b+y)+p,b=ve(b)+p,y=i-b,o&&(m+=1,v-=1),n&&(b-=1,y+=1),t.shapeType="rect",t.shapeArgs={x:m,y:b,width:v,height:y}})},getSymbol:Re,drawLegendSymbol:Zi.drawRectangle,drawGraph:Re,drawPoints:function(){var t,i=this,n=this.chart,r=i.options,o=n.renderer,a=r.animationLimit||250;xi(i.points,function(n){var s=n.plotY,l=n.graphic;s===X||isNaN(s)||null===n.y?l&&(n.graphic=l.destroy()):(t=n.shapeArgs,l?(Ai(l),l[i.points.length<a?"animate":"attr"](e(t))):n.graphic=l=o[n.shapeType](t).attr(n.pointAttr[n.selected?ni:ei]).add(i.group).shadow(r.shadow,null,r.stacking&&!r.borderRadius))})},animate:function(t){var e,i=this,n=this.yAxis,r=i.options,o=this.chart.inverted,a={};He&&(t?(a.scaleY=.001,e=_e(n.pos+n.len,xe(n.pos,n.toPixels(r.threshold))),o?a.translateX=e-n.len:a.translateY=e,i.group.attr(a)):(a.scaleY=1,a[o?"translateX":"translateY"]=n.pos,i.group.animate(a,i.options.animation),i.animate=null))},remove:function(){var t=this,e=t.chart;e.hasRendered&&xi(e.series,function(e){e.type===t.type&&(e.isDirty=!0)}),tn.prototype.remove.apply(t,arguments)}});pi.column=sn,Pi.bar=e(Pi.column);var ln=v(sn,{type:"bar",inverted:!0});pi.bar=ln,Pi.scatter=e(Di,{lineWidth:0,tooltip:{headerFormat:'<span style="font-size: 10px; color:{series.color}">{series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>",followPointer:!0},stickyTracking:!1});var cn=v(tn,{type:"scatter",sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["markerGroup"],takeOrdinalPosition:!1,singularTooltips:!0,drawGraph:function(){this.options.lineWidth&&tn.prototype.drawGraph.call(this)}});pi.scatter=cn,Pi.pie=e(Di,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.point.name}},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,states:{hover:{brightness:.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}});var hn=v(Qi,{init:function(){Qi.prototype.init.apply(this,arguments);var e,i=this;return i.y<0&&(i.y=null),t(i,{visible:i.visible!==!1,name:f(i.name,"Slice")}),e=function(t){i.slice("select"===t.type)},Ci(i,"select",e),Ci(i,"unselect",e),i},setVisible:function(t){var e=this,i=e.series,n=i.chart;e.visible=e.options.visible=t=t===X?!e.visible:t,i.options.data[yi(e,i.data)]=e.options,xi(["graphic","dataLabel","connector","shadowGroup"],function(i){e[i]&&e[i][t?"show":"hide"](!0)}),e.legendItem&&n.legend.colorizeItem(e,t),!i.isDirty&&i.options.ignoreHiddenPoint&&(i.isDirty=!0,n.redraw())},slice:function(t,e,i){var n,r=this,o=r.series,a=o.chart;E(i,a),e=f(e,!0),r.sliced=r.options.sliced=t=d(t)?t:!r.sliced,o.options.data[yi(r,o.data)]=r.options,n=t?r.slicedTranslation:{translateX:0,translateY:0},r.graphic.animate(n),r.shadowGroup&&r.shadowGroup.animate(n)}}),dn={type:"pie",isCartesian:!1,pointClass:hn,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},singularTooltips:!0,getColor:Re,animate:function(t){var e=this,i=e.points,n=e.startAngleRad;t||(xi(i,function(t){var i=t.graphic,r=t.shapeArgs;i&&(i.attr({r:e.center[3]/2,start:n,end:n}),i.animate({r:r.r,start:r.start,end:r.end},e.options.animation))}),e.animate=null)},setData:function(t,e,i,n){tn.prototype.setData.call(this,t,!1,i,n),this.processData(),this.generatePoints(),f(e,!0)&&this.chart.redraw(i)},generatePoints:function(){var t,e,i,n,r=0,o=this.options.ignoreHiddenPoint;for(tn.prototype.generatePoints.call(this),e=this.points,i=e.length,t=0;i>t;t++)n=e[t],r+=o&&!n.visible?0:n.y;for(this.total=r,t=0;i>t;t++)n=e[t],n.percentage=r>0?100*(n.y/r):0,n.total=r},translate:function(t){this.generatePoints();var e,i,n,r,o,a,s,l=this,c=0,h=1e3,d=l.options,u=d.slicedOffset,p=u+d.borderWidth,g=d.startAngle||0,m=l.startAngleRad=Te/180*(g-90),v=l.endAngleRad=Te/180*(f(d.endAngle,g+360)-90),b=v-m,y=l.points,x=d.dataLabels.distance,_=d.ignoreHiddenPoint,w=y.length;for(t||(l.center=t=l.getCenter()),l.getX=function(e,i){return n=me.asin(_e((e-t[1])/(t[2]/2+x),1)),t[0]+(i?-1:1)*ke(n)*(t[2]/2+x)},a=0;w>a;a++)s=y[a],e=m+c*b,(!_||s.visible)&&(c+=s.percentage/100),i=m+c*b,s.shapeType="arc",s.shapeArgs={x:t[0],y:t[1],r:t[2]/2,innerR:t[3]/2,start:ve(e*h)/h,end:ve(i*h)/h},n=(i+e)/2,n>1.5*Te?n-=2*Te:-Te/2>n&&(n+=2*Te),s.slicedTranslation={translateX:ve(ke(n)*u),translateY:ve(Ce(n)*u)},r=ke(n)*t[2]/2,o=Ce(n)*t[2]/2,s.tooltipPos=[t[0]+.7*r,t[1]+.7*o],s.half=-Te/2>n||n>Te/2?1:0,s.angle=n,p=_e(p,x/2),s.labelPos=[t[0]+r+ke(n)*x,t[1]+o+Ce(n)*x,t[0]+r+ke(n)*p,t[1]+o+Ce(n)*p,t[0]+r,t[1]+o,0>x?"center":s.half?"right":"left",n]},drawGraph:null,drawPoints:function(){var e,i,n,r,o=this,a=o.chart,s=a.renderer,l=o.options.shadow;l&&!o.shadowGroup&&(o.shadowGroup=s.g("shadow").add(o.group)),xi(o.points,function(a){i=a.graphic,r=a.shapeArgs,n=a.shadowGroup,l&&!n&&(n=a.shadowGroup=s.g("shadow").add(o.shadowGroup)),e=a.sliced?a.slicedTranslation:{translateX:0,translateY:0},n&&n.attr(e),i?i.animate(t(r,e)):a.graphic=i=s[a.shapeType](r).setRadialReference(o.center).attr(a.pointAttr[a.selected?ni:ei]).attr({"stroke-linejoin":"round"}).attr(e).add(o.group).shadow(l,n),void 0!==a.visible&&a.setVisible(a.visible)})},sortByAngle:function(t,e){t.sort(function(t,i){return void 0!==t.angle&&(i.angle-t.angle)*e})},drawLegendSymbol:Zi.drawRectangle,getCenter:Ji.getCenter,getSymbol:Re};dn=v(tn,dn),pi.pie=dn,tn.prototype.drawDataLabels=function(){var i,n,r,o,a=this,s=a.options,l=s.cursor,c=s.dataLabels,h=a.points;(c.enabled||a._hasPointLabels)&&(a.dlProcessOptions&&a.dlProcessOptions(c),o=a.plotGroup("dataLabelsGroup","data-labels",a.visible?je:Ve,c.zIndex||6),n=c,xi(h,function(s){var h,u,p,g,m,v=s.dataLabel,b=s.connector,y=!0;if(i=s.options&&s.options.dataLabels,h=f(i&&i.enabled,n.enabled),v&&!h)s.dataLabel=v.destroy();else if(h){if(c=e(n,i),m=c.rotation,u=s.getLabelConfig(),r=c.format?k(c.format,u):c.formatter.call(u,c),c.style.color=f(c.color,c.style.color,a.color,"black"),v)d(r)?(v.attr({text:r}),y=!1):(s.dataLabel=v=v.destroy(),b&&(s.connector=b.destroy()));else if(d(r)){p={fill:c.backgroundColor,stroke:c.borderColor,"stroke-width":c.borderWidth,r:c.borderRadius||0,rotation:m,padding:c.padding,zIndex:1};for(g in p)p[g]===X&&delete p[g];v=s.dataLabel=a.chart.renderer[m?"text":"label"](r,0,-999,null,null,null,c.useHTML).attr(p).css(t(c.style,l&&{cursor:l})).add(o).shadow(c.shadow)}v&&a.alignDataLabel(s,v,c,null,y)}}))},tn.prototype.alignDataLabel=function(e,i,n,r,o){var a,s=this.chart,l=s.inverted,c=f(e.plotX,-999),h=f(e.plotY,-999),d=i.getBBox(),u=this.visible&&(e.series.forceDL||s.isInsidePlot(c,ve(h),l)||r&&s.isInsidePlot(c,l?r.x+1:r.y+r.height-1,l));u&&(r=t({x:l?s.plotWidth-h:c,y:ve(l?s.plotHeight-c:h),width:0,height:0},r),t(n,{width:d.width,height:d.height}),n.rotation?(a={align:n.align,x:r.x+n.x+r.width/2,y:r.y+n.y+r.height/2},i[o?"attr":"animate"](a)):(i.align(n,null,r),a=i.alignAttr,"justify"===f(n.overflow,"justify")?this.justifyDataLabel(i,n,a,d,r,o):f(n.crop,!0)&&(u=s.isInsidePlot(a.x,a.y)&&s.isInsidePlot(a.x+d.width,a.y+d.height)))),u||(i.attr({y:-999}),i.placed=!1)},tn.prototype.justifyDataLabel=function(t,e,i,n,r,o){var a,s,l=this.chart,c=e.align,h=e.verticalAlign;a=i.x,0>a&&("right"===c?e.align="left":e.x=-a,s=!0),a=i.x+n.width,a>l.plotWidth&&("left"===c?e.align="right":e.x=l.plotWidth-a,s=!0),a=i.y,0>a&&("bottom"===h?e.verticalAlign="top":e.y=-a,s=!0),a=i.y+n.height,a>l.plotHeight&&("top"===h?e.verticalAlign="bottom":e.y=l.plotHeight-a,s=!0),s&&(t.placed=!o,t.align(e,null,r))},pi.pie&&(pi.pie.prototype.drawDataLabels=function(){var t,e,i,n,r,o,a,s,l,c,h,d,u,p=this,g=p.data,m=p.chart,v=p.options.dataLabels,b=f(v.connectorPadding,10),y=f(v.connectorWidth,1),x=m.plotWidth,_=m.plotHeight,w=f(v.softConnector,!0),k=v.distance,C=p.center,T=C[2]/2,S=C[1],L=k>0,M=[[],[]],$=[0,0,0,0],P=function(t,e){return e.y-t.y};if(p.visible&&(v.enabled||p._hasPointLabels)){for(tn.prototype.drawDataLabels.apply(p),xi(g,function(t){t.dataLabel&&t.visible&&M[t.half].push(t)}),d=0;!a&&g[d];)a=g[d]&&g[d].dataLabel&&(g[d].dataLabel.getBBox().height||21),d++;for(d=2;d--;){var D,O,E,H=[],z=[],I=M[d],W=I.length;if(p.sortByAngle(I,d-.5),k>0){for(O=S-T-k;S+T+k>=O;O+=a)H.push(O);if(D=H.length,W>D){for(h=[].concat(I),h.sort(P),u=W;u--;)h[u].rank=u;for(u=W;u--;)I[u].rank>=D&&I.splice(u,1);W=I.length}for(u=0;W>u;u++){t=I[u],o=t.labelPos;var N,R,B=9999;for(R=0;D>R;R++)N=we(H[R]-o[1]),B>N&&(B=N,E=R);if(u>E&&null!==H[u])E=u;else if(W-u+E>D&&null!==H[u])for(E=D-W+u;null===H[E];)E++;else for(;null===H[E];)E++;z.push({i:E,y:H[E]}),H[E]=null}z.sort(P)}for(u=0;W>u;u++){var F,q;t=I[u],o=t.labelPos,n=t.dataLabel,c=t.visible===!1?Ve:je,q=o[1],k>0?(F=z.pop(),E=F.i,l=F.y,(q>l&&null!==H[E+1]||l>q&&null!==H[E-1])&&(l=q)):l=q,s=v.justify?C[0]+(d?-1:1)*(T+k):p.getX(0===E||E===H.length-1?q:l,d),n._attr={visibility:c,align:o[6]},n._pos={x:s+v.x+({left:b,right:-b}[o[6]]||0),y:l+v.y-10},n.connX=s,n.connY=l,null===this.options.size&&(r=n.width,b>s-r?$[3]=xe(ve(r-s+b),$[3]):s+r>x-b&&($[1]=xe(ve(s+r-x+b),$[1])),0>l-a/2?$[0]=xe(ve(-l+a/2),$[0]):l+a/2>_&&($[2]=xe(ve(l+a/2-_),$[2])))}}(0===A($)||this.verifyDataLabelOverflow($))&&(this.placeDataLabels(),L&&y&&xi(this.points,function(t){e=t.connector,o=t.labelPos,n=t.dataLabel,n&&n._pos?(c=n._attr.visibility,s=n.connX,l=n.connY,i=w?[Je,s+("left"===o[6]?5:-5),l,"C",s,l,2*o[2]-o[4],2*o[3]-o[5],o[2],o[3],Qe,o[4],o[5]]:[Je,s+("left"===o[6]?5:-5),l,Qe,o[2],o[3],Qe,o[4],o[5]],e?(e.animate({d:i}),e.attr("visibility",c)):t.connector=e=p.chart.renderer.path(i).attr({"stroke-width":y,stroke:v.connectorColor||t.color||"#606060",visibility:c}).add(p.group)):e&&(t.connector=e.destroy())}))}},pi.pie.prototype.placeDataLabels=function(){xi(this.points,function(t){var e,i=t.dataLabel;i&&(e=i._pos,e?(i.attr(i._attr),i[i.moved?"animate":"attr"](e),i.moved=!0):i&&i.attr({y:-999}))})},pi.pie.prototype.alignDataLabel=Re,pi.pie.prototype.verifyDataLabelOverflow=function(t){var e,i=this.center,n=this.options,r=n.center,o=n.minSize||80,a=o;return null!==r[0]?a=xe(i[2]-xe(t[1],t[3]),o):(a=xe(i[2]-t[1]-t[3],o),i[0]+=(t[3]-t[1])/2),null!==r[1]?a=xe(_e(a,i[2]-xe(t[0],t[2])),o):(a=xe(_e(a,i[2]-t[0]-t[2]),o),i[1]+=(t[0]-t[2])/2),a<i[2]?(i[2]=a,this.translate(i),xi(this.points,function(t){t.dataLabel&&(t.dataLabel._pos=null)}),this.drawDataLabels&&this.drawDataLabels()):e=!0,e}),pi.column&&(pi.column.prototype.alignDataLabel=function(t,i,n,r,o){var a=this.chart,s=a.inverted,l=t.dlBox||t.shapeArgs,c=t.below||t.plotY>f(this.translatedThreshold,a.plotSizeY),h=f(n.inside,!!this.options.stacking);l&&(r=e(l),s&&(r={x:a.plotWidth-r.y-r.height,y:a.plotHeight-r.x-r.width,width:r.height,height:r.width}),h||(s?(r.x+=c?0:r.width,r.width=0):(r.y+=c?r.height:0,r.height=0))),n.align=f(n.align,!s||h?"center":c?"right":"left"),n.verticalAlign=f(n.verticalAlign,s||h?"middle":c?"top":"bottom"),tn.prototype.alignDataLabel.call(this,t,i,n,r,o)});var un=fi.TrackerMixin={drawTrackerPoint:function(){var t=this,e=t.chart,i=e.pointer,n=t.options.cursor,r=n&&{cursor:n},o=function(i){var n,r=i.target;for(e.hoverSeries!==t&&t.onMouseOver();r&&!n;)n=r.point,r=r.parentNode;n!==X&&n!==e.hoverPoint&&n.onMouseOver(i)};xi(t.points,function(t){t.graphic&&(t.graphic.element.point=t),t.dataLabel&&(t.dataLabel.element.point=t)}),t._hasTracking||(xi(t.trackerGroups,function(e){t[e]&&(t[e].addClass(Ue+"tracker").on("mouseover",o).on("mouseout",function(t){i.onTrackerMouseOut(t)}).css(r),V&&t[e].on("touchstart",o))}),t._hasTracking=!0)},drawTrackerGraph:function(){var t,e,i=this,n=i.options,r=n.trackByArea,o=[].concat(r?i.areaPath:i.graphPath),a=o.length,s=i.chart,l=s.pointer,c=s.renderer,h=s.options.tooltip.snap,d=i.tracker,u=n.cursor,p=u&&{cursor:u},f=i.singlePoints,g=function(){s.hoverSeries!==i&&i.onMouseOver()},m="rgba(192,192,192,"+(He?1e-4:.002)+")";if(a&&!r)for(e=a+1;e--;)o[e]===Je&&o.splice(e+1,0,o[e+1]-h,o[e+2],Qe),(e&&o[e]===Je||e===a)&&o.splice(e,0,Qe,o[e-2]+h,o[e-1]);for(e=0;e<f.length;e++)t=f[e],o.push(Je,t.plotX-h,t.plotY,Qe,t.plotX+h,t.plotY);d?d.attr({d:o}):(i.tracker=c.path(o).attr({"stroke-linejoin":"round",visibility:i.visible?je:Ve,stroke:m,fill:r?m:Ze,"stroke-width":n.lineWidth+(r?0:2*h),zIndex:2}).add(i.group),xi([i.tracker,i.markerGroup],function(t){t.addClass(Ue+"tracker").on("mouseover",g).on("mouseout",function(t){l.onTrackerMouseOut(t)}).css(p),V&&t.on("touchstart",g)}))}};pi.column&&(sn.prototype.drawTracker=un.drawTrackerPoint),pi.pie&&(pi.pie.prototype.drawTracker=un.drawTrackerPoint),pi.scatter&&(cn.prototype.drawTracker=un.drawTrackerPoint),t(Ki.prototype,{setItemEvents:function(t,e,i,n,r){var o=this;(i?e:t.legendGroup).on("mouseover",function(){t.setState(ii),e.css(o.options.itemHoverStyle)}).on("mouseout",function(){e.css(t.visible?n:r),t.setState()}).on("click",function(e){var i="legendItemClick",n=function(){t.setVisible()};e={browserEvent:e},t.firePointEvent?t.firePointEvent(i,e,n):Si(t,i,e,n)})},createCheckboxForItem:function(t){var e=this;t.checkbox=m("input",{type:"checkbox",checked:t.selected,defaultChecked:t.selected},e.options.itemCheckboxStyle,e.chart.container),Ci(t.checkbox,"click",function(e){var i=e.target;Si(t,"checkboxClick",{checked:i.checked},function(){t.select()})})}}),j.legend.itemStyle.cursor="pointer",t(B.prototype,{showResetZoom:function(){var t=this,e=j.lang,i=t.options.chart.resetZoomButton,n=i.theme,r=n.states,o="chart"===i.relativeTo?null:"plotBox";this.resetZoomButton=t.renderer.button(e.resetZoom,null,null,function(){t.zoomOut()},n,r&&r.hover).attr({align:i.position.align,title:e.resetZoomTitle}).add().align(i.position,!1,o)},zoomOut:function(){var t=this;Si(t,"selection",{resetSelection:!0},function(){t.zoom()})},zoom:function(t){var e,i,n=this,r=n.pointer,a=!1;!t||t.resetSelection?xi(n.axes,function(t){e=t.zoom()}):xi(t.xAxis.concat(t.yAxis),function(t){var i=t.axis,n=i.isXAxis;(r[n?"zoomX":"zoomY"]||r[n?"pinchX":"pinchY"])&&(e=i.zoom(t.min,t.max),i.displayBtn&&(a=!0))}),i=n.resetZoomButton,a&&!i?n.showResetZoom():!a&&o(i)&&(n.resetZoomButton=i.destroy()),e&&n.redraw(f(n.options.chart.animation,t&&t.animation,n.pointCount<100))},pan:function(t,e){var i,n=this,r=n.hoverPoints;r&&xi(r,function(t){t.setState()}),xi("xy"===e?[1,0]:[1],function(e){var r=t[e?"chartX":"chartY"],o=n[e?"xAxis":"yAxis"][0],a=n[e?"mouseDownX":"mouseDownY"],s=(o.pointRange||0)/2,l=o.getExtremes(),c=o.toValue(a-r,!0)+s,h=o.toValue(a+n[e?"plotWidth":"plotHeight"]-r,!0)-s;o.series.length&&c>_e(l.dataMin,l.min)&&h<xe(l.dataMax,l.max)&&(o.setExtremes(c,h,!1,!1,{trigger:"pan"}),i=!0),n[e?"mouseDownX":"mouseDownY"]=r}),i&&n.redraw(!1),g(n.container,{cursor:"move"})}}),t(Qi.prototype,{select:function(t,e){var i=this,n=i.series,r=n.chart;t=f(t,!i.selected),i.firePointEvent(t?"select":"unselect",{accumulate:e},function(){i.selected=i.options.selected=t,n.options.data[yi(i,n.data)]=i.options,i.setState(t&&ni),e||xi(r.getSelectedPoints(),function(t){t.selected&&t!==i&&(t.selected=t.options.selected=!1,n.options.data[yi(t,n.data)]=t.options,t.setState(ei),t.firePointEvent("unselect"))})})},onMouseOver:function(t){var e=this,i=e.series,n=i.chart,r=n.tooltip,o=n.hoverPoint;o&&o!==e&&o.onMouseOut(),e.firePointEvent("mouseOver"),!r||r.shared&&!i.noSharedTooltip||r.refresh(e,t),e.setState(ii),n.hoverPoint=e},onMouseOut:function(){var t=this.series.chart,e=t.hoverPoints;e&&-1!==yi(this,e)||(this.firePointEvent("mouseOut"),this.setState(),t.hoverPoint=null)},firePointEvent:function(t,e,i){var n=this,r=this.series,o=r.options;(o.point.events[t]||n.options&&n.options.events&&n.options.events[t])&&this.importEvents(),"click"===t&&o.allowPointSelect&&(i=function(t){n.select(null,t.ctrlKey||t.metaKey||t.shiftKey)}),Si(this,t,e,i)},importEvents:function(){if(!this.hasImportedEvents){var t,i=this,n=e(i.series.options.point,i.options),r=n.events;i.events=r;for(t in r)Ci(i,t,r[t]);this.hasImportedEvents=!0}},setState:function(t,i){var n,r,o=this,a=o.plotX,s=o.plotY,l=o.series,c=l.options.states,h=Pi[l.type].marker&&l.options.marker,d=h&&!h.enabled,u=h&&h.states[t],p=u&&u.enabled===!1,f=l.stateMarkerGraphic,g=o.marker||{},m=l.chart,v=o.pointAttr;t=t||ei,i=i&&f,t===o.state&&!i||o.selected&&t!==ni||c[t]&&c[t].enabled===!1||t&&(p||d&&!u.enabled)||t&&g.states&&g.states[t]&&g.states[t].enabled===!1||(o.graphic?(n=h&&o.graphic.symbolName&&v[t].r,o.graphic.attr(e(v[t],n?{x:a-n,y:s-n,width:2*n,height:2*n}:{}))):(t&&u&&(n=u.radius,r=g.symbol||l.symbol,f&&f.currentSymbol!==r&&(f=f.destroy()),f?f[i?"animate":"attr"]({x:a-n,y:s-n}):(l.stateMarkerGraphic=f=m.renderer.symbol(r,a-n,s-n,2*n,2*n).attr(v[t]).add(l.markerGroup),f.currentSymbol=r)),f&&f[t&&m.isInsidePlot(a,s,m.inverted)?"show":"hide"]()),o.state=t)}}),t(tn.prototype,{onMouseOver:function(){var t=this,e=t.chart,i=e.hoverSeries;i&&i!==t&&i.onMouseOut(),t.options.events.mouseOver&&Si(t,"mouseOver"),t.setState(ii),e.hoverSeries=t},onMouseOut:function(){var t=this,e=t.options,i=t.chart,n=i.tooltip,r=i.hoverPoint;r&&r.onMouseOut(),t&&e.events.mouseOut&&Si(t,"mouseOut"),!n||e.stickyTracking||n.shared&&!t.noSharedTooltip||n.hide(),t.setState(),i.hoverSeries=null},setState:function(t){var e,i=this,n=i.options,r=i.graph,o=i.graphNeg,a=n.states,s=n.lineWidth;if(t=t||ei,i.state!==t){if(i.state=t,a[t]&&a[t].enabled===!1)return;t&&(s=a[t].lineWidth||s+1),r&&!r.dashstyle&&(e={"stroke-width":s},r.attr(e),o&&o.attr(e))}},setVisible:function(t,e){var i,n=this,r=n.chart,o=n.legendItem,a=r.options.chart.ignoreHiddenSeries,s=n.visible;n.visible=t=n.userOptions.visible=t===X?!s:t,i=t?"show":"hide",xi(["group","dataLabelsGroup","markerGroup","tracker"],function(t){n[t]&&n[t][i]()}),r.hoverSeries===n&&n.onMouseOut(),o&&r.legend.colorizeItem(n,t),n.isDirty=!0,n.options.stacking&&xi(r.series,function(t){t.options.stacking&&t.visible&&(t.isDirty=!0)}),xi(n.linkedSeries,function(e){e.setVisible(t,!1)}),a&&(r.isDirtyBox=!0),e!==!1&&r.redraw(),Si(n,i)},setTooltipPoints:function(t){var e,i,n,r,o,a,s,l=this,c=[],h=l.xAxis,d=h&&h.getExtremes(),u=h?h.tooltipLen||h.len:l.chart.plotSizeX,p=[];if(l.options.enableMouseTracking!==!1&&!l.singularTooltips){for(t&&(l.tooltipPoints=null),xi(l.segments||l.points,function(t){c=c.concat(t)}),h&&h.reversed&&(c=c.reverse()),l.orderTooltipPoints&&l.orderTooltipPoints(c),e=c.length,s=0;e>s;s++)if(r=c[s],o=r.x,o>=d.min&&o<=d.max)for(a=c[s+1],i=n===X?0:n+1,n=c[s+1]?_e(xe(0,be((r.clientX+(a?a.wrappedClientX||a.clientX:u))/2)),u):u;i>=0&&n>=i;)p[i++]=r;l.tooltipPoints=p}},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(t){var e=this;e.selected=t=t===X?!e.selected:t,e.checkbox&&(e.checkbox.checked=t),Si(e,t?"select":"unselect")},drawTracker:un.drawTrackerGraph}),x(tn.prototype,"init",function(t){var e,i=this;t.apply(this,Array.prototype.slice.call(arguments,1)),e=i.xAxis,e&&e.options.ordinal&&Ci(i,"updatedData",function(){delete e.ordinalIndex})}),x(R.prototype,"getTimeTicks",function(t,e,i,n,r,o,a,s){var l,c,h,u,p,f=0,g=0,m={},v=[],b=-Number.MAX_VALUE,y=this.options.tickPixelInterval;if(!this.options.ordinal||!o||o.length<3||i===X)return t.call(this,e,i,n,r);for(u=o.length;u>g;g++){if(p=g&&o[g-1]>n,o[g]<i&&(f=g),g===u-1||o[g+1]-o[g]>5*a||p){if(o[g]>b){for(l=t.call(this,e,o[f],o[g],r);l.length&&l[0]<=b;)l.shift();l.length&&(b=l[l.length-1]),v=v.concat(l)}f=g+1}if(p)break}if(h=l.info,s&&h.unitRange<=Q[si]){for(g=v.length-1,f=1;g>f;f++)new Date(v[f]-ie)[ae]()!==new Date(v[f-1]-ie)[ae]()&&(m[v[f]]=li,c=!0);c&&(m[v[0]]=li),h.higherRanks=m}if(v.info=h,s&&d(y)){for(var x,_,w,k,C,T=v.length,S=T,L=[],M=[];S--;)_=this.translate(v[S]),w&&(M[S]=w-_),L[S]=w=_;for(M.sort(),k=M[be(M.length/2)],.6*y>k&&(k=null),S=v[T-1]>n?T-1:T,w=void 0;S--;)_=L[S],C=w-_,w&&.8*y>C&&(null===k||.8*k>C)?(m[v[S]]&&!m[v[S+1]]?(x=S+1,w=_):x=S,v.splice(x,1)):w=_}return v}),t(R.prototype,{beforeSetTickPositions:function(){var t,e,i,n,r,o,a=this,s=[],l=!1,c=a.getExtremes(),h=c.min,d=c.max;if(a.options.ordinal){if(xi(a.series,function(e,i){if(e.visible!==!1&&e.takeOrdinalPosition!==!1&&(s=s.concat(e.processedXData),t=s.length,s.sort(function(t,e){return t-e}),t))for(i=t-1;i--;)s[i]===s[i+1]&&s.splice(i,1)}),t=s.length,t>2){for(e=s[1]-s[0],o=t-1;o--&&!l;)s[o+1]-s[o]!==e&&(l=!0);!a.options.keepOrdinalPadding&&(s[0]-h>e||d-s[s.length-1]>e)&&(l=!0)}l?(a.ordinalPositions=s,i=a.val2lin(xe(h,s[0]),!0),n=a.val2lin(_e(d,s[s.length-1]),!0),a.ordinalSlope=r=(d-h)/(n-i),a.ordinalOffset=h-i*r):a.ordinalPositions=a.ordinalSlope=a.ordinalOffset=X}a.groupIntervalFactor=null},val2lin:function(t,e){var i=this,n=i.ordinalPositions;if(n){var r;return n.length,r=_(n,t),e?r:i.ordinalSlope*(r||0)+i.ordinalOffset}return t},lin2val:function(t,e){var i=this,n=i.ordinalPositions;if(n){var r,o,a,s=i.ordinalSlope,l=i.ordinalOffset,c=n.length-1;if(e)0>t?t=n[0]:t>c?t=n[c]:(c=be(t),a=t-c);else for(;c--;)if(r=s*c+l,t>=r){o=s*(c+1)+l,a=(t-r)/(o-r);break}return a!==X&&n[c]!==X?n[c]+(a?a*(n[c+1]-n[c]):0):t}return t},getExtendedPositions:function(){var t,e,i=this,n=i.chart,r=i.series[0].currentDataGrouping,o=i.ordinalIndex,a=r?r.count+r.unitName:"raw",s=i.getExtremes();return o||(o=i.ordinalIndex={}),o[a]||(t={series:[],getExtremes:function(){return{min:s.dataMin,max:s.dataMax}},options:{ordinal:!0},val2lin:R.prototype.val2lin},xi(i.series,function(i){e={xAxis:t,xData:i.xData,chart:n,destroyGroupedData:Re},e.options={dataGrouping:r?{enabled:!0,forced:!0,approximation:"open",units:[[r.unitName,[r.count]]]}:{enabled:!1}},i.processData.apply(e),t.series.push(e)}),i.beforeSetTickPositions.apply(t),o[a]=t.ordinalPositions),o[a]},getGroupIntervalFactor:function(t,e,i){var n,r=0,o=i.processedXData,a=o.length,s=[],l=this.groupIntervalFactor;if(!l){for(;a-1>r;r++)s[r]=o[r+1]-o[r];s.sort(function(t,e){return t-e}),n=s[be(a/2)],t=xe(t,o[0]),e=_e(e,o[a-1]),this.groupIntervalFactor=l=a*n/(e-t)}return l},postProcessTickInterval:function(t){var e=this.ordinalSlope;return e?t/(e/this.closestPointRange):t}}),x(B.prototype,"pan",function(t,e){var i=this,n=i.xAxis[0],r=e.chartX,o=!1;if(n.options.ordinal&&n.series.length){var a,s,l,c,h=i.mouseDownX,d=n.getExtremes(),u=d.dataMax,p=d.min,f=d.max,m=i.hoverPoints,v=n.closestPointRange,b=n.translationSlope*(n.ordinalSlope||v),y=(h-r)/b,x={ordinalPositions:n.getExtendedPositions()},_=n.lin2val,w=n.val2lin;x.ordinalPositions?we(y)>1&&(m&&xi(m,function(t){t.setState()}),0>y?(l=x,c=n.ordinalPositions?n:x):(l=n.ordinalPositions?n:x,c=x),s=c.ordinalPositions,u>s[s.length-1]&&s.push(u),i.fixedRange=f-p,a=n.toFixedRange(null,null,_.apply(l,[w.apply(l,[p,!0])+y,!0]),_.apply(c,[w.apply(c,[f,!0])+y,!0])),a.min>=_e(d.dataMin,p)&&a.max<=xe(u,f)&&n.setExtremes(a.min,a.max,!0,!1,{trigger:"pan"}),i.mouseDownX=r,g(i.container,{cursor:"move"})):o=!0}else o=!0;o&&t.apply(this,Array.prototype.slice.call(arguments,1))}),x(tn.prototype,"getSegments",function(t){var e,i=this,n=i.options.gapSize,r=i.xAxis;t.apply(this,Array.prototype.slice.call(arguments,1)),n&&(e=i.segments,xi(e,function(t,i){for(var o=t.length-1;o--;)t[o+1].x-t[o].x>r.closestPointRange*n&&e.splice(i+1,0,t.splice(o+1,t.length-o))}))});var pn="dataGrouping",fn=tn.prototype,gn=qi.prototype,mn=fn.processData,vn=fn.generatePoints,bn=fn.destroy,yn=gn.tooltipHeaderFormatter,xn="number",_n={approximation:"average",groupPixelWidth:2,dateTimeLabelFormats:i(ri,["%A, %b %e, %H:%M:%S.%L","%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],oi,["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],ai,["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],si,["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],li,["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],ci,["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],hi,["%B %Y","%B","-%B %Y"],di,["%Y","%Y","-%Y"])},wn={line:{},spline:{},area:{},areaspline:{},column:{approximation:"sum",groupPixelWidth:10},arearange:{approximation:"range"},areasplinerange:{approximation:"range"},columnrange:{approximation:"range",groupPixelWidth:10},candlestick:{approximation:"ohlc",groupPixelWidth:10},ohlc:{approximation:"ohlc",groupPixelWidth:5}},kn=[[ri,[1,2,5,10,20,25,50,100,200,500]],[oi,[1,2,5,10,15,30]],[ai,[1,2,5,10,15,30]],[si,[1,2,3,4,6,8,12]],[li,[1]],[ci,[1]],[hi,[1,3,6]],[di,null]],Cn={sum:function(t){var e,i=t.length;if(!i&&t.hasNulls)e=null;else if(i)for(e=0;i--;)e+=t[i];return e},average:function(t){var e=t.length,i=Cn.sum(t);return typeof i===xn&&e&&(i/=e),i},open:function(t){return t.length?t[0]:t.hasNulls?null:X},high:function(t){return t.length?A(t):t.hasNulls?null:X},low:function(t){return t.length?M(t):t.hasNulls?null:X},close:function(t){return t.length?t[t.length-1]:t.hasNulls?null:X},ohlc:function(t,e,i,n){return t=Cn.open(t),e=Cn.high(e),i=Cn.low(i),n=Cn.close(n),typeof t===xn||typeof e===xn||typeof i===xn||typeof n===xn?[t,e,i,n]:void 0},range:function(t,e){return t=Cn.low(t),e=Cn.high(e),typeof t===xn||typeof e===xn?[t,e]:void 0}};fn.groupData=function(t,e,i,n){var r,o,a,s,l=this,c=l.data,h=l.options.data,d=[],u=[],p=t.length,f=!!e,g=[[],[],[],[]],m="function"==typeof n?n:Cn[n],v=l.pointArrayMap,b=v&&v.length;for(s=0;p>=s&&!(t[s]>=i[0]);s++);for(;p>=s;s++){for(;(i[1]!==X&&t[s]>=i[1]||s===p)&&(r=i.shift(),a=m.apply(0,g),a!==X&&(d.push(r),u.push(a)),g[0]=[],g[1]=[],g[2]=[],g[3]=[],s!==p););if(s===p)break;if(v){var y,x,_=l.cropStart+s,w=c&&c[_]||l.pointClass.prototype.applyOptions.apply({series:l},[h[_]]);for(y=0;b>y;y++)x=w[v[y]],typeof x===xn?g[y].push(x):null===x&&(g[y].hasNulls=!0)}else o=f?e[s]:null,typeof o===xn?g[0].push(o):null===o&&(g[0].hasNulls=!0)}return[d,u]},fn.processData=function(){var t,e=this,i=e.chart,n=e.options,r=n[pn],o=r&&f(r.enabled,i.options._stock);if(e.forceCrop=o,e.groupPixelWidth=null,e.hasProcessed=!0,mn.apply(e,arguments)!==!1&&o){e.destroyGroupedData();var a,s=e.processedXData,l=e.processedYData,c=i.plotSizeX,h=e.xAxis,u=h.options.ordinal,p=e.groupPixelWidth=h.getGroupPixelWidth&&h.getGroupPixelWidth(),g=e.pointRange;if(p){t=!0,e.points=null;var m=h.getExtremes(),v=m.min,b=m.max,y=u&&h.getGroupIntervalFactor(v,b,e)||1,x=p*(b-v)/c*y,_=h.getTimeTicks(h.normalizeTimeTickInterval(x,r.units||kn),v,b,null,s,e.closestPointRange),w=fn.groupData.apply(e,[s,l,_,r.approximation]),k=w[0],C=w[1];if(r.smoothed){for(a=k.length-1,k[a]=b;a--&&a>0;)k[a]+=x/2;k[0]=v}e.currentDataGrouping=_.info,null===n.pointRange&&(e.pointRange=_.info.totalRange),e.closestPointRange=_.info.totalRange,d(k[0])&&k[0]<h.dataMin&&(h.dataMin=k[0]),e.processedXData=k,e.processedYData=C}else e.currentDataGrouping=null,e.pointRange=g;e.hasGroupedData=t}},fn.destroyGroupedData=function(){var t=this.groupedData;xi(t||[],function(e,i){e&&(t[i]=e.destroy?e.destroy():null)}),this.groupedData=null},fn.generatePoints=function(){vn.apply(this),this.destroyGroupedData(),this.groupedData=this.hasGroupedData?this.points:null},gn.tooltipHeaderFormatter=function(t){var e,i,n,r,o,a,l,c=this,h=t.series,d=h.options,u=h.tooltipOptions,p=d.dataGrouping,f=u.xDateFormat,g=h.xAxis;if(g&&"datetime"===g.options.type&&p&&s(t.key)){if(i=h.currentDataGrouping,n=p.dateTimeLabelFormats,i)r=n[i.unitName],1===i.count?f=r[0]:(f=r[1],e=r[2]);else if(!f&&n)for(a in Q)if(Q[a]>=g.closestPointRange||Q[a]<=Q[li]&&t.key%Q[a]>0){f=n[a][0];break}o=K(f,t.key),e&&(o+=K(e,t.key+i.totalRange-1)),l=u.headerFormat.replace("{point.key}",o)}else l=yn.call(c,t);return l},fn.destroy=function(){for(var t=this,e=t.groupedData||[],i=e.length;i--;)e[i]&&e[i].destroy();bn.apply(t)},x(fn,"setOptions",function(t,i){var n=t.call(this,i),r=this.type,o=this.chart.options.plotOptions,a=Pi[r].dataGrouping;return wn[r]&&(a||(a=e(_n,wn[r])),n.dataGrouping=e(a,o.series&&o.series.dataGrouping,o[r].dataGrouping,i.dataGrouping)),this.chart.options._stock&&(this.requireSorting=!0),n}),x(R.prototype,"setScale",function(t){t.call(this),xi(this.series,function(t){t.hasProcessed=!1})}),R.prototype.getGroupPixelWidth=function(){var t,e,i,n=this.series,r=n.length,o=0,a=!1;for(t=r;t--;)i=n[t].options.dataGrouping,i&&(o=xe(o,i.groupPixelWidth));for(t=r;t--;)i=n[t].options.dataGrouping,i&&n[t].hasProcessed&&(e=(n[t].processedXData||n[t].data).length,(n[t].groupPixelWidth||e>this.chart.plotSizeX/o||e&&i.forced)&&(a=!0));return a?o:0},Pi.ohlc=e(Pi.column,{lineWidth:1,tooltip:{pointFormat:'<span style="color:{series.color};font-weight:bold">{series.name}</span><br/>Open: {point.open}<br/>High: {point.high}<br/>Low: {point.low}<br/>Close: {point.close}<br/>'},states:{hover:{lineWidth:3}},threshold:null});var Tn=v(pi.column,{type:"ohlc",pointArrayMap:["open","high","low","close"],toYData:function(t){return[t.open,t.high,t.low,t.close]},pointValKey:"high",pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth"},upColorProp:"stroke",getAttribs:function(){pi.column.prototype.getAttribs.apply(this,arguments);var t=this,i=t.options,n=i.states,r=i.upColor||t.color,o=e(t.pointAttr),a=t.upColorProp;o[""][a]=r,o.hover[a]=n.hover.upColor||r,o.select[a]=n.select.upColor||r,xi(t.points,function(t){t.open<t.close&&(t.pointAttr=o)})},translate:function(){var t=this,e=t.yAxis;pi.column.prototype.translate.apply(t),xi(t.points,function(t){null!==t.open&&(t.plotOpen=e.translate(t.open,0,1,0,1)),null!==t.close&&(t.plotClose=e.translate(t.close,0,1,0,1))})},drawPoints:function(){var t,e,i,n,r,o,a,s,l=this,c=l.points,h=l.chart;xi(c,function(c){c.plotY!==X&&(a=c.graphic,t=c.pointAttr[c.selected?"selected":""],n=t["stroke-width"]%2/2,s=ve(c.plotX)-n,r=ve(c.shapeArgs.width/2),o=["M",s,ve(c.yBottom),"L",s,ve(c.plotY)],null!==c.open&&(e=ve(c.plotOpen)+n,o.push("M",s,e,"L",s-r,e)),null!==c.close&&(i=ve(c.plotClose)+n,o.push("M",s,i,"L",s+r,i)),a?a.animate({d:o}):c.graphic=h.renderer.path(o).attr(t).add(l.group))})},animate:null});pi.ohlc=Tn,Pi.candlestick=e(Pi.column,{lineColor:"black",lineWidth:1,states:{hover:{lineWidth:2}},tooltip:Pi.ohlc.tooltip,threshold:null,upColor:"white"});var Sn=v(Tn,{type:"candlestick",pointAttrToOptions:{fill:"color",stroke:"lineColor","stroke-width":"lineWidth"},upColorProp:"fill",getAttribs:function(){pi.ohlc.prototype.getAttribs.apply(this,arguments);var t=this,e=t.options,i=e.states,n=e.upLineColor||e.lineColor,r=i.hover.upLineColor||n,o=i.select.upLineColor||n;xi(t.points,function(t){t.open<t.close&&(t.pointAttr[""].stroke=n,t.pointAttr.hover.stroke=r,t.pointAttr.select.stroke=o)})},drawPoints:function(){var t,e,i,n,r,o,a,s,l,c,h,d,u=this,p=u.points,f=u.chart,g=u.pointAttr[""];xi(p,function(p){c=p.graphic,p.plotY!==X&&(t=p.pointAttr[p.selected?"selected":""]||g,s=t["stroke-width"]%2/2,l=ve(p.plotX)-s,e=p.plotOpen,i=p.plotClose,n=me.min(e,i),r=me.max(e,i),d=ve(p.shapeArgs.width/2),o=ve(n)!==ve(p.plotY),a=r!==p.yBottom,n=ve(n)+s,r=ve(r)+s,h=["M",l-d,r,"L",l-d,n,"L",l+d,n,"L",l+d,r,"Z","M",l,n,"L",l,o?ve(p.plotY):n,"M",l,r,"L",l,a?ve(p.yBottom):r,"Z"],c?c.animate({d:h}):p.graphic=f.renderer.path(h).attr(t).add(u.group).shadow(u.options.shadow))})}});pi.candlestick=Sn;var Ln=Ii.prototype.symbols;Pi.flags=e(Pi.column,{dataGrouping:null,fillColor:"white",lineWidth:1,pointRange:0,shape:"flag",stackDistance:12,states:{hover:{lineColor:"black",fillColor:"#FCFFC5"}},style:{fontSize:"11px",fontWeight:"bold",textAlign:"center"},tooltip:{pointFormat:"{point.text}<br/>"},threshold:null,y:-30}),pi.flags=v(pi.column,{type:"flags",sorted:!1,noSharedTooltip:!0,takeOrdinalPosition:!1,trackerGroups:["markerGroup"],forceCrop:!0,init:tn.prototype.init,pointAttrToOptions:{fill:"fillColor",stroke:"color","stroke-width":"lineWidth",r:"radius"},translate:function(){pi.column.prototype.translate.apply(this);
var t,e,i,n,r,o,a=this,s=a.options,l=a.chart,c=a.points,h=c.length-1,d=s.onSeries,u=d&&l.get(d),p=u&&u.options.step,f=u&&u.points,g=f&&f.length,m=a.xAxis,v=m.getExtremes();if(u&&u.visible&&g)for(o=u.currentDataGrouping,n=f[g-1].x+(o?o.totalRange:0),c.sort(function(t,e){return t.x-e.x});g--&&c[h]&&(t=c[h],i=f[g],!(i.x<=t.x&&i.plotY!==X&&(t.x<=n&&(t.plotY=i.plotY,i.x<t.x&&!p&&(r=f[g+1],r&&r.plotY!==X&&(t.plotY+=(t.x-i.x)/(r.x-i.x)*(r.plotY-i.plotY)))),h--,g++,0>h))););xi(c,function(t,i){t.plotY===X&&(t.x>=v.min&&t.x<=v.max?t.plotY=l.chartHeight-m.bottom-(m.opposite?m.height:0)+m.offset-l.plotTop:t.shapeArgs={}),e=c[i-1],e&&e.plotX===t.plotX&&(e.stackIndex===X&&(e.stackIndex=0),t.stackIndex=e.stackIndex+1)})},drawPoints:function(){var t,i,n,r,o,a,s,l,c,h,d,u=this,p=u.pointAttr[""],f=u.points,g=u.chart,m=g.renderer,v=u.options,b=v.y,y=v.lineWidth%2/2;for(o=f.length;o--;)a=f[o],d=a.plotX>u.xAxis.len,i=a.plotX+(d?y:-y),l=a.stackIndex,r=a.options.shape||v.shape,n=a.plotY,n!==X&&(n=a.plotY+b+y-(l!==X&&l*v.stackDistance)),c=l?X:a.plotX+y,h=l?X:a.plotY,s=a.graphic,n!==X&&i>=0&&!d?(t=a.pointAttr[a.selected?"select":""]||p,s?s.attr({x:i,y:n,r:t.r,anchorX:c,anchorY:h}):s=a.graphic=m.label(a.options.title||v.title||"A",i,n,r,c,h,v.useHTML).css(e(v.style,a.style)).attr(t).attr({align:"flag"===r?"left":"center",width:v.width,height:v.height}).add(u.markerGroup).shadow(v.shadow),a.tooltipPos=[i,n]):s&&(a.graphic=s.destroy())},drawTracker:function(){var t=this,e=t.points;un.drawTrackerPoint.apply(this),xi(e,function(t){var i=t.graphic;i&&Ci(i.element,"mouseover",function(){t.stackIndex>0&&!t.raised&&(t._y=i.y,i.attr({y:t._y-8}),t.raised=!0),xi(e,function(e){e!==t&&e.raised&&e.graphic&&(e.graphic.attr({y:e._y}),e.raised=!1)})})})},animate:Re}),Ln.flag=function(t,e,i,n,r){var o=r&&r.anchorX||t,a=r&&r.anchorY||e;return["M",o,a,"L",t,e+n,t,e,t+i,e,t+i,e+n,t,e+n,"M",o,a,"Z"]},xi(["circle","square"],function(t){Ln[t+"pin"]=function(e,i,n,r,o){var a,s=o&&o.anchorX,l=o&&o.anchorY,c=Ln[t](e,i,n,r);return s&&l&&(a=i>l?i:i+r,c.push("M",s,a,"L",s,l)),c}}),Y===fi.VMLRenderer&&xi(["flag","circlepin","squarepin"],function(t){Wi.prototype.symbols[t]=Ln[t]});var Mn,An={linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#FFF"],[1,"#CCC"]]},$n=[].concat(kn);$n[4]=[li,[1,2,3,4]],$n[5]=[ci,[1,2,3]],Mn=pi.areaspline===X?"line":"areaspline",t(j,{navigator:{handles:{backgroundColor:"#FFF",borderColor:"#666"},height:40,margin:10,maskFill:"rgba(255, 255, 255, 0.75)",outlineColor:"#444",outlineWidth:1,series:{type:Mn,color:"#4572A7",compare:null,fillOpacity:.4,dataGrouping:{approximation:"average",enabled:!0,groupPixelWidth:2,smoothed:!0,units:$n},dataLabels:{enabled:!1,zIndex:2},id:Ue+"navigator-series",lineColor:"#4572A7",lineWidth:1,marker:{enabled:!1},pointRange:0,shadow:!1,threshold:null},xAxis:{tickWidth:0,lineWidth:0,gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",x:3,y:-4},crosshair:!1},yAxis:{gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:.1,maxPadding:.1,labels:{enabled:!1},crosshair:!1,title:{text:null},tickWidth:0}},scrollbar:{height:Oe?20:14,barBackgroundColor:An,barBorderRadius:2,barBorderWidth:1,barBorderColor:"#666",buttonArrowColor:"#666",buttonBackgroundColor:An,buttonBorderColor:"#666",buttonBorderRadius:2,buttonBorderWidth:1,minWidth:6,rifleColor:"#666",trackBackgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#EEE"],[1,"#FFF"]]},trackBorderColor:"#CCC",trackBorderWidth:1,liveRedraw:He&&!Oe}}),q.prototype={drawHandle:function(t,e){var i,n=this,r=n.chart,o=r.renderer,a=n.elementsToDestroy,s=n.handles,l=n.navigatorOptions.handles,c={fill:l.backgroundColor,stroke:l.borderColor,"stroke-width":1};n.rendered||(s[e]=o.g("navigator-handle-"+["left","right"][e]).css({cursor:"e-resize"}).attr({zIndex:4-e}).add(),i=o.rect(-4.5,0,9,16,3,1).attr(c).add(s[e]),a.push(i),i=o.path(["M",-1.5,4,"L",-1.5,12,"M",.5,4,"L",.5,12]).attr(c).add(s[e]),a.push(i)),s[e][r.isResizing?"animate":"attr"]({translateX:n.scrollerLeft+n.scrollbarHeight+parseInt(t,10),translateY:n.top+n.height/2-8})},drawScrollbarButton:function(t){var e,i=this,n=i.chart,r=n.renderer,o=i.elementsToDestroy,a=i.scrollbarButtons,s=i.scrollbarHeight,l=i.scrollbarOptions;i.rendered||(a[t]=r.g().add(i.scrollbarGroup),e=r.rect(-.5,-.5,s+1,s+1,l.buttonBorderRadius,l.buttonBorderWidth).attr({stroke:l.buttonBorderColor,"stroke-width":l.buttonBorderWidth,fill:l.buttonBackgroundColor}).add(a[t]),o.push(e),e=r.path(["M",s/2+(t?-1:1),s/2-3,"L",s/2+(t?-1:1),s/2+3,s/2+(t?2:-2),s/2]).attr({fill:l.buttonArrowColor}).add(a[t]),o.push(e)),t&&a[t].attr({translateX:i.scrollerWidth-s})},render:function(t,e,i,n){var r,o,a,s,l,c,h,d,u,p,g,m,v,b=this,y=b.chart,x=y.renderer,_=b.scrollbarGroup,w=b.navigatorGroup,k=b.scrollbar,C=b.xAxis,T=b.scrollbarTrack,S=b.scrollbarHeight,L=b.scrollbarEnabled,M=b.navigatorOptions,A=b.scrollbarOptions,$=A.minWidth,P=b.height,D=b.top,O=b.navigatorEnabled,E=M.outlineWidth,H=E/2,z=0,I=b.outlineHeight,W=A.barBorderRadius,N=A.barBorderWidth,R=D+H;isNaN(t)||(b.navigatorLeft=r=f(C.left,y.plotLeft+S),b.navigatorWidth=o=f(C.len,y.plotWidth-2*S),b.scrollerLeft=a=r-S,b.scrollerWidth=s=s=o+2*S,C.getExtremes&&(v=b.getUnionExtremes(!0),!v||v.dataMin===C.min&&v.dataMax===C.max||C.setExtremes(v.dataMin,v.dataMax,!0,!1)),i=f(i,C.translate(t)),n=f(n,C.translate(e)),(isNaN(i)||1/0===we(i))&&(i=0,n=s),C.translate(n,!0)-C.translate(i,!0)<y.xAxis[0].minRange||(b.zoomedMax=_e(xe(i,n),o),b.zoomedMin=xe(b.fixedWidth?b.zoomedMax-b.fixedWidth:_e(i,n),0),b.range=b.zoomedMax-b.zoomedMin,c=ve(b.zoomedMax),l=ve(b.zoomedMin),h=c-l,b.rendered||(O&&(b.navigatorGroup=w=x.g("navigator").attr({zIndex:3}).add(),b.leftShade=x.rect().attr({fill:M.maskFill}).add(w),b.rightShade=x.rect().attr({fill:M.maskFill}).add(w),b.outline=x.path().attr({"stroke-width":E,stroke:M.outlineColor}).add(w)),L&&(b.scrollbarGroup=_=x.g("scrollbar").add(),p=A.trackBorderWidth,b.scrollbarTrack=T=x.rect().attr({x:0,y:-p%2/2,fill:A.trackBackgroundColor,stroke:A.trackBorderColor,"stroke-width":p,r:A.trackBorderRadius||0,height:S}).add(_),b.scrollbar=k=x.rect().attr({y:-N%2/2,height:S,fill:A.barBackgroundColor,stroke:A.barBorderColor,"stroke-width":N,r:W}).add(_),b.scrollbarRifles=x.path().attr({stroke:A.rifleColor,"stroke-width":1}).add(_))),m=y.isResizing?"animate":"attr",O&&(b.leftShade[m]({x:r,y:D,width:l,height:P}),b.rightShade[m]({x:r+c,y:D,width:o-c,height:P}),b.outline[m]({d:[Je,a,R,Qe,r+l+H,R,r+l+H,R+I-S,Je,r+c-H,R+I-S,Qe,r+c-H,R,a+s,R]}),b.drawHandle(l+H,0),b.drawHandle(c+H,1)),L&&_&&(b.drawScrollbarButton(0),b.drawScrollbarButton(1),_[m]({translateX:a,translateY:ve(R+P)}),T[m]({width:s}),d=S+l,u=h-N,$>u&&(z=($-u)/2,u=$,d-=z),b.scrollbarPad=z,k[m]({x:be(d)+N%2/2,width:u}),g=S+l+h/2-.5,b.scrollbarRifles.attr({visibility:h>12?je:Ve})[m]({d:[Je,g-3,S/4,Qe,g-3,2*S/3,Je,g,S/4,Qe,g,2*S/3,Je,g+3,S/4,Qe,g+3,2*S/3]})),b.scrollbarPad=z,b.rendered=!0))},addEvents:function(){var t,e=this.chart.container,i=this.mouseDownHandler,n=this.mouseMoveHandler,r=this.mouseUpHandler;t=[[e,"mousedown",i],[e,"mousemove",n],[document,"mouseup",r]],V&&t.push([e,"touchstart",i],[e,"touchmove",n],[document,"touchend",r]),xi(t,function(t){Ci.apply(null,t)}),this._events=t},removeEvents:function(){xi(this._events,function(t){Ti.apply(null,t)}),this._events=X,this.navigatorEnabled&&this.baseSeries&&Ti(this.baseSeries,"updatedData",this.updatedDataHandler)},init:function(){var t,i,n,r,o,a=this,s=a.chart,l=a.scrollbarHeight,c=a.navigatorOptions,h=a.height,d=a.top,u=document.body.style,p=a.baseSeries;a.mouseDownHandler=function(e){e=s.pointer.normalize(e);var i,r,l,c,d=a.zoomedMin,p=a.zoomedMax,f=a.top,g=a.scrollbarHeight,m=a.scrollerLeft,v=a.scrollerWidth,b=a.navigatorLeft,y=a.navigatorWidth,x=a.scrollbarPad,_=a.range,w=e.chartX,k=e.chartY,C=s.xAxis[0],T=Oe?10:7;k>f&&f+h+g>k&&(c=!a.scrollbarEnabled||f+h>k,c&&me.abs(w-d-b)<T?(a.grabbedLeft=!0,a.otherHandlePos=p,a.fixedExtreme=C.max,s.fixedRange=null):c&&me.abs(w-p-b)<T?(a.grabbedRight=!0,a.otherHandlePos=d,a.fixedExtreme=C.min,s.fixedRange=null):w>b+d-x&&b+p+x>w?(a.grabbedCenter=w,a.fixedWidth=_,s.renderer.isSVG&&(o=u.cursor,u.cursor="ew-resize"),n=w-d):w>m&&m+v>w&&(l=c?w-b-_/2:b>w?d-.2*_:w>m+v-g?d+.2*_:b+d>w?d-_:p,0>l?l=0:l+_>=y&&(l=y-_,i=t.dataMax),l!==d&&(a.fixedWidth=_,r=t.toFixedRange(l,l+_,null,i),C.setExtremes(r.min,r.max,!0,!1,{trigger:"navigator"}))))},a.mouseMoveHandler=function(t){var e,i=a.scrollbarHeight,o=a.navigatorLeft,l=a.navigatorWidth,c=a.scrollerLeft,h=a.scrollerWidth,d=a.range;0!==t.pageX&&(t=s.pointer.normalize(t),e=t.chartX,o>e?e=o:e>c+h-i&&(e=c+h-i),a.grabbedLeft?(r=!0,a.render(0,0,e-o,a.otherHandlePos)):a.grabbedRight?(r=!0,a.render(0,0,a.otherHandlePos,e-o)):a.grabbedCenter&&(r=!0,n>e?e=n:e>l+n-d&&(e=l+n-d),a.render(0,0,e-n,e-n+d)),r&&a.scrollbarOptions.liveRedraw&&setTimeout(function(){a.mouseUpHandler(t)},0))},a.mouseUpHandler=function(e){var i,l,c;r&&(a.zoomedMin===a.otherHandlePos?l=a.fixedExtreme:a.zoomedMax===a.otherHandlePos&&(c=a.fixedExtreme),i=t.toFixedRange(a.zoomedMin,a.zoomedMax,l,c),s.xAxis[0].setExtremes(i.min,i.max,!0,!1,{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:e})),"mousemove"!==e.type&&(a.grabbedLeft=a.grabbedRight=a.grabbedCenter=a.fixedWidth=a.fixedExtreme=a.otherHandlePos=r=n=null,u.cursor=o||"")};var g=s.xAxis.length,m=s.yAxis.length;s.extraBottomMargin=a.outlineHeight+c.margin,a.navigatorEnabled?(a.xAxis=t=new R(s,e({ordinal:p&&p.xAxis.options.ordinal},c.xAxis,{id:"navigator-x-axis",isX:!0,type:"datetime",index:g,height:h,offset:0,offsetLeft:l,offsetRight:-l,keepOrdinalPadding:!0,startOnTick:!1,endOnTick:!1,minPadding:0,maxPadding:0,zoomEnabled:!1})),a.yAxis=i=new R(s,e(c.yAxis,{id:"navigator-y-axis",alignTicks:!1,height:h,offset:0,index:m,zoomEnabled:!1})),p||c.series.data?a.addBaseSeries():0===s.series.length&&x(s,"redraw",function(t,e){s.series.length>0&&!a.series&&(a.setBaseSeries(),s.redraw=t),t.call(s,e)})):a.xAxis=t={translate:function(t,e){var i=s.xAxis[0].getExtremes(),n=s.plotWidth-2*l,r=i.dataMin,o=i.dataMax-r;return e?t*o/n+r:n*(t-r)/o},toFixedRange:R.prototype.toFixedRange},x(s,"getMargins",function(e){var n=this.legend,r=n.options;e.call(this),a.top=d=a.navigatorOptions.top||this.chartHeight-a.height-a.scrollbarHeight-this.spacing[2]-("bottom"===r.verticalAlign&&r.enabled&&!r.floating?n.legendHeight+f(r.margin,10):0),t&&i&&(t.options.top=i.options.top=d,t.setAxisSize(),i.setAxisSize())}),a.addEvents()},getUnionExtremes:function(t){var e=this.chart.xAxis[0],i=this.xAxis,n=i.options;return t&&null===e.dataMin?void 0:{dataMin:f(n&&n.min,(d(e.dataMin)&&d(i.dataMin)?_e:f)(e.dataMin,i.dataMin)),dataMax:f(n&&n.max,(d(e.dataMax)&&d(i.dataMax)?xe:f)(e.dataMax,i.dataMax))}},setBaseSeries:function(t){var e=this.chart;t=t||e.options.navigator.baseSeries,this.series&&this.series.remove(),this.baseSeries=e.series[t]||"string"==typeof t&&e.get(t)||e.series[0],this.xAxis&&this.addBaseSeries()},addBaseSeries:function(){var i,n,r=this.baseSeries,o=r?r.options:{},a=o.data,s=this.navigatorOptions.series;n=s.data,this.hasNavigatorData=!!n,i=e(o,s,{clip:!1,enableMouseTracking:!1,group:"nav",padXAxis:!1,xAxis:"navigator-x-axis",yAxis:"navigator-y-axis",name:"Navigator",showInLegend:!1,isInternal:!0,visible:!0}),i.data=n||a,this.series=this.chart.initSeries(i),r&&this.navigatorOptions.adaptToUpdatedData!==!1&&(Ci(r,"updatedData",this.updatedDataHandler),r.userOptions.events=t(r.userOptions.event,{updatedData:this.updatedDataHandler}))},updatedDataHandler:function(t,e,i){"undefined"==typeof e&&(e=!1);var n,r,o,a,s,l=this.chart.scroller,c=l.baseSeries,h=c.xAxis,d=h.getExtremes(),u=d.min,p=d.max,f=d.dataMin,g=d.dataMax,m=p-u,v=l.series,b=v.xData,y=!!h.setExtremes;r=p>=b[b.length-1]-(this.closestPointRange||0),n=f>=u,e?(v.options.pointStart=v.xData[0],v.addPoint({x:i,y:0},!1),s=!0):l.hasNavigatorData||(v.options.pointStart=c.xData[0],v.setData(c.options.data,!1),s=!0),n&&(a=f,o=a+m),r&&(o=g,n||(a=xe(o-m,v.xData[0]))),y&&(n||r)?isNaN(a)||h.setExtremes(a,o,!0,!1,{trigger:"updatedData"}):(s&&this.chart.redraw(!1),l.render(xe(u,f),_e(p,g)))},destroy:function(){var t=this;t.removeEvents(),xi([t.xAxis,t.yAxis,t.leftShade,t.rightShade,t.outline,t.scrollbarTrack,t.scrollbarRifles,t.scrollbarGroup,t.scrollbar],function(t){t&&t.destroy&&t.destroy()}),t.xAxis=t.yAxis=t.leftShade=t.rightShade=t.outline=t.scrollbarTrack=t.scrollbarRifles=t.scrollbarGroup=t.scrollbar=null,xi([t.scrollbarButtons,t.handles,t.elementsToDestroy],function(t){$(t)})}},fi.Scroller=q,x(R.prototype,"zoom",function(t,e,i){var n,r,o=this.chart,a=o.options,s=a.chart.zoomType,l=a.navigator,c=a.rangeSelector;return this.isXAxis&&(l&&l.enabled||c&&c.enabled)&&("x"===s?o.resetZoomButton="blocked":"y"===s?r=!1:"xy"===s&&(n=this.previousZoom,d(e)?this.previousZoom=[this.min,this.max]:n&&(e=n[0],i=n[1],delete this.previousZoom))),r!==X?r:t.call(this,e,i)}),x(B.prototype,"init",function(t,e,i){Ci(this,"beforeRender",function(){var t=this.options;(t.navigator.enabled||t.scrollbar.enabled)&&(this.scroller=new q(this))}),t.call(this,e,i)}),x(tn.prototype,"addPoint",function(t,e,i,n,r){var s=this.options.turboThreshold;s&&this.xData.length>s&&o(e)&&!a(e)&&this.chart.scroller&&D(20,!0),t.call(this,e,i,n,r)}),t(j,{rangeSelector:{buttonTheme:{width:28,height:16,padding:1,r:0,stroke:"#68A",zIndex:7},inputPosition:{align:"right"},labelStyle:{color:"#666"}}}),j.lang=e(j.lang,{rangeSelectorZoom:"Zoom",rangeSelectorFrom:"From",rangeSelectorTo:"To"}),G.prototype={clickButton:function(t,i){var n,r,o,a,s,l,c=this,h=c.selected,d=c.chart,u=c.buttons,p=c.buttonOptions[t],g=d.xAxis[0],m=d.scroller&&d.scroller.getUnionExtremes()||g||{},v=m.dataMin,b=m.dataMax,y=g&&ve(_e(g.max,f(b,g.max))),x=new Date(y),_=p.type,w=p.count,k=p._range;if(null!==v&&null!==b&&t!==c.selected){if("month"===_||"year"===_)l={month:"Month",year:"FullYear"}[_],x["set"+l](x["get"+l]()-w),n=x.getTime(),v=f(v,Number.MIN_VALUE),isNaN(n)||v>n?(n=v,y=_e(n+k,b)):k=y-n;else if(k)n=xe(y-k,v),y=_e(n+k,b);else if("ytd"===_){if(!g)return Ci(d,"beforeRender",function(){c.clickButton(t)}),void 0;b===X&&(v=Number.MAX_VALUE,b=Number.MIN_VALUE,xi(d.series,function(t){var e=t.xData;v=_e(e[0],v),b=xe(e[e.length-1],b)}),i=!1),r=new Date(b),s=r.getFullYear(),n=a=xe(v||0,Date.UTC(s,0,1)),r=r.getTime(),y=_e(b||r,r)}else"all"===_&&g&&(n=v,y=b);u[h]&&u[h].setState(0),u[t]&&u[t].setState(2),d.fixedRange=k,g?(g.setExtremes(n,y,f(i,1),0,{trigger:"rangeSelectorButton",rangeSelectorButton:p}),c.setSelected(t)):(o=d.options.xAxis,o[0]=e(o[0],{range:k,min:a}),c.setSelected(t))}},setSelected:function(t){this.selected=this.options.selected=t},defaultButtons:[{type:"month",count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"ytd",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],init:function(t){var e=this,i=t.options.rangeSelector,n=i.buttons||[].concat(e.defaultButtons),r=i.selected,o=e.blurInputs=function(){var t=e.minInput,i=e.maxInput;t&&t.blur(),i&&i.blur()};e.chart=t,e.options=i,e.buttons=[],t.extraTopMargin=25,e.buttonOptions=n,Ci(t.container,"mousedown",o),Ci(t,"resize",o),xi(n,e.computeButtonRange),r!==X&&n[r]&&this.clickButton(r,!1),Ci(t,"load",function(){Ci(t.xAxis[0],"afterSetExtremes",function(){e.updateButtonStates(!0)})})},updateButtonStates:function(t){var e=this,i=this.chart,n=i.xAxis[0],r=i.scroller&&i.scroller.getUnionExtremes()||n,o=r.dataMin,a=r.dataMax,s=e.selected,l=e.buttons;t&&i.fixedRange!==ve(n.max-n.min)&&(l[s]&&l[s].setState(0),e.setSelected(null)),xi(e.buttonOptions,function(t,i){var r=t._range,c=r>a-o,h=r<n.minRange,d="all"===t.type&&n.max-n.min>=a-o&&2!==l[i].state,u="ytd"===t.type&&K("%Y",o)===K("%Y",a);r===ve(n.max-n.min)&&i!==s?(e.setSelected(i),l[i].setState(2)):c||h||d||u?l[i].setState(3):3===l[i].state&&l[i].setState(0)})},computeButtonRange:function(t){var e=t.type,i=t.count||1,n={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5};n[e]?t._range=n[e]*i:("month"===e||"year"===e)&&(t._range=36e5*24*{month:30,year:365}[e]*i)},setInputValue:function(t,e){var i=this.chart.options.rangeSelector;d(e)&&(this[t+"Input"].HCTime=e),this[t+"Input"].value=K(i.inputEditDateFormat||"%Y-%m-%d",this[t+"Input"].HCTime),this[t+"DateBox"].attr({text:K(i.inputDateFormat||"%b %e, %Y",this[t+"Input"].HCTime)})},drawInput:function(i){var r,o,a,s=this,l=s.chart,c=l.renderer.style,h=l.renderer,d=l.options.rangeSelector,u=j.lang,p=s.div,f="min"===i,v=this.inputGroup;this[i+"Label"]=o=h.label(u[f?"rangeSelectorFrom":"rangeSelectorTo"],this.inputGroup.offset).attr({padding:1}).css(e(c,d.labelStyle)).add(v),v.offset+=o.width+5,this[i+"DateBox"]=a=h.label("",v.offset).attr({padding:1,width:d.inputBoxWidth||90,height:d.inputBoxHeight||16,stroke:d.inputBoxBorderColor||"silver","stroke-width":1}).css(e({textAlign:"center"},c,d.inputStyle)).on("click",function(){s[i+"Input"].focus()}).add(v),v.offset+=a.width+(f?10:0),this[i+"Input"]=r=m("input",{name:i,className:Ue+"range-selector",type:"text"},t({position:Xe,border:0,width:"1px",height:"1px",padding:0,textAlign:"center",fontSize:c.fontSize,fontFamily:c.fontFamily,top:l.plotTop+Ke},d.inputStyle),p),r.onfocus=function(){g(this,{left:v.translateX+a.x+Ke,top:v.translateY+Ke,width:a.width-2+Ke,height:a.height-2+Ke,border:"2px solid silver"})},r.onblur=function(){g(this,{border:0,width:"1px",height:"1px"}),s.setInputValue(i)},r.onchange=function(){var t=r.value,e=(d.inputDateParser||Date.parse)(t),i=l.xAxis[0],o=i.dataMin,a=i.dataMax;isNaN(e)&&(e=t.split("-"),e=Date.UTC(n(e[0]),n(e[1])-1,n(e[2]))),isNaN(e)||(j.global.useUTC||(e+=1e3*60*(new Date).getTimezoneOffset()),f?e>s.maxInput.HCTime?e=X:o>e&&(e=o):e<s.minInput.HCTime?e=X:e>a&&(e=a),e!==X&&l.xAxis[0].setExtremes(f?e:i.min,f?i.max:e,X,X,{trigger:"rangeSelectorInput"}))}},render:function(e,i){var n,r,o=this,a=o.chart,s=a.renderer,l=a.container,c=a.options,h=c.exporting&&c.navigation&&c.navigation.buttonOptions,d=c.rangeSelector,u=o.buttons,p=j.lang,f=o.div,g=o.inputGroup,v=d.buttonTheme,b=d.inputEnabled!==!1,y=v&&v.states,x=a.plotLeft;o.rendered||(o.zoomText=s.text(p.rangeSelectorZoom,x,a.plotTop-10).css(d.labelStyle).add(),r=x+o.zoomText.getBBox().width+5,xi(o.buttonOptions,function(t,e){u[e]=s.button(t.text,r,a.plotTop-25,function(){o.clickButton(e),o.isActive=!0},v,y&&y.hover,y&&y.select).css({textAlign:"center"}).add(),r+=u[e].width+(d.buttonSpacing||0),o.selected===e&&u[e].setState(2)}),o.updateButtonStates(),b&&(o.div=f=m("div",null,{position:"relative",height:0,zIndex:1}),l.parentNode.insertBefore(f,l),o.inputGroup=g=s.g("input-group").add(),g.offset=0,o.drawInput("min"),o.drawInput("max"))),b&&(n=a.plotTop-35,g.align(t({y:n,width:g.offset,x:h&&n<(h.y||0)+h.height-a.spacing[0]?-40:0},d.inputPosition),!0,a.spacingBox),o.setInputValue("min",e),o.setInputValue("max",i)),o.rendered=!0},destroy:function(){var t,e=this.minInput,i=this.maxInput,n=this.chart,r=this.blurInputs;Ti(n.container,"mousedown",r),Ti(n,"resize",r),$(this.buttons),e&&(e.onfocus=e.onblur=e.onchange=null),i&&(i.onfocus=i.onblur=i.onchange=null);for(t in this)this[t]&&"chart"!==t&&(this[t].destroy?this[t].destroy():this[t].nodeType&&P(this[t])),this[t]=null}},R.prototype.toFixedRange=function(t,e,i,n){var r=this.chart&&this.chart.fixedRange,o=f(i,this.translate(t,!0)),a=f(n,this.translate(e,!0)),s=r&&(a-o)/r;return s>.7&&1.3>s&&(n?o=a-r:a=o+r),{min:o,max:a}},x(B.prototype,"init",function(t,e,i){Ci(this,"init",function(){this.options.rangeSelector.enabled&&(this.rangeSelector=new G(this))}),t.call(this,e,i)}),fi.RangeSelector=G,B.prototype.callbacks.push(function(t){function e(){a=t.xAxis[0].getExtremes(),s.render(a.min,a.max)}function i(){a=t.xAxis[0].getExtremes(),isNaN(a.min)||l.render(a.min,a.max)}function n(t){"navigator-drag"!==t.triggerOp&&s.render(t.min,t.max)}function r(t){l.render(t.min,t.max)}function o(){s&&Ti(t.xAxis[0],"afterSetExtremes",n),l&&(Ti(t,"resize",i),Ti(t.xAxis[0],"afterSetExtremes",r))}var a,s=t.scroller,l=t.rangeSelector;s&&(Ci(t.xAxis[0],"afterSetExtremes",n),x(t,"drawChartBox",function(t){var i=this.isDirtyBox;t.call(this),i&&e()}),e()),l&&(Ci(t.xAxis[0],"afterSetExtremes",r),Ci(t,"resize",i),i()),Ci(t,"destroy",o)}),fi.StockChart=function(t,i){var n,r=t.series,o=f(t.navigator&&t.navigator.enabled,!0),a=o?{startOnTick:!1,endOnTick:!1}:null,s={marker:{enabled:!1,states:{hover:{radius:5}}},states:{hover:{lineWidth:2}}},l={shadow:!1,borderWidth:0};return t.xAxis=ki(p(t.xAxis||{}),function(t){return e({minPadding:0,maxPadding:0,ordinal:!0,title:{text:null},labels:{overflow:"justify"},showLastLabel:!0},t,{type:"datetime",categories:null},a)}),t.yAxis=ki(p(t.yAxis||{}),function(t){return n=t.opposite,e({labels:{align:n?"right":"left",x:n?-2:2,y:-2},showLastLabel:!1,title:{text:null}},t)}),t.series=null,t=e({chart:{panning:!0,pinchType:"x"},navigator:{enabled:!0},scrollbar:{enabled:!0},rangeSelector:{enabled:!0},title:{text:null},tooltip:{shared:!0,crosshairs:!0},legend:{enabled:!1},plotOptions:{line:s,spline:s,area:s,areaspline:s,arearange:s,areasplinerange:s,column:l,columnrange:l,candlestick:l,ohlc:l}},t,{_stock:!0,chart:{inverted:!1}}),t.series=r,new B(t,i)},x(Xi.prototype,"init",function(t,e,i){var n=i.chart.pinchType||"";t.call(this,e,i),this.pinchX=this.pinchHor=-1!==n.indexOf("x"),this.pinchY=this.pinchVert=-1!==n.indexOf("y")}),R.prototype.getPlotLinePath=function(t,e,i,n,r){var o,a,s,l,c=this,h=this.isLinked?this.linkedParent.series:this.series,u=c.chart.renderer,p=c.left,g=c.top,m=[],v=this.isXAxis?d(this.options.yAxis)?[this.chart.yAxis[this.options.yAxis]]:ki(h,function(t){return t.yAxis}):d(this.options.xAxis)?[this.chart.xAxis[this.options.xAxis]]:ki(h,function(t){return t.xAxis}),b=[];return xi(v,function(t){-1===yi(t,b)&&b.push(t)}),r=f(r,c.translate(t,null,null,i)),isNaN(r)||(c.horiz?xi(b,function(t){a=t.top,l=a+t.len,o=s=ve(r+c.transB),(o>=p&&o<=p+c.width||n)&&m.push("M",o,a,"L",s,l)}):xi(b,function(t){o=t.left,s=o+t.width,a=l=ve(g+c.height-r),(a>=g&&a<=g+c.height||n)&&m.push("M",o,a,"L",s,l)})),m.length>0?u.crispPolyLine(m,e||1):null},Ii.prototype.crispPolyLine=function(t,e){var i;for(i=0;i<t.length;i+=6)t[i+1]===t[i+4]&&(t[i+1]=t[i+4]=ve(t[i+1])-e%2/2),t[i+2]===t[i+5]&&(t[i+2]=t[i+5]=ve(t[i+2])+e%2/2);return t},Y===fi.VMLRenderer&&(Wi.prototype.crispPolyLine=Ii.prototype.crispPolyLine),x(R.prototype,"hideCrosshair",function(t,e){t.call(this,e),d(this.crossLabelArray)&&(d(e)?this.crossLabelArray[e]&&this.crossLabelArray[e].hide():xi(this.crossLabelArray,function(t){t.hide()}))}),x(R.prototype,"drawCrosshair",function(e,i,n){if(e.call(this,i,n),d(this.crosshair.label)&&this.crosshair.label.enabled&&d(n)){var r,o,a,s,l=this.chart,c=this.options.crosshair.label,h=this.isXAxis?"x":"y",u=this.horiz,p=this.opposite,g=this.left,m=this.top,v=this.crossLabel,b=c.format,y="";if(v||(v=this.crossLabel=l.renderer.label().attr({align:c.align||(u?"center":p?"right"===this.labelAlign?"right":"left":"left"===this.labelAlign?"left":"center"),zIndex:12,height:u?16:X,fill:c.backgroundColor||this.series[0]&&this.series[0].color||"gray",padding:f(c.padding,2),stroke:c.borderColor||null,"stroke-width":c.borderWidth||0}).css(t({color:"white",fontWeight:"normal",fontSize:"11px",textAlign:"center"},c.style)).add()),u?(r=n.plotX+g,o=m+(p?0:this.height)):(r=p?this.width+g:0,o=n.plotY+m),m>o||o>m+this.height)return this.hideCrosshair(),void 0;b||c.formatter||(this.isDatetimeAxis&&(y="%b %d, %Y"),b="{value"+(y?":"+y:"")+"}"),v.attr({x:r,y:o,text:b?k(b,{value:n[h]}):c.formatter.call(this,n[h]),visibility:je}),a=v.box,u?("inside"===this.options.tickPosition&&!p||"inside"!==this.options.tickPosition&&p)&&(o=v.y-a.height):o=v.y-a.height/2,s=u?{left:g-a.x,right:g+this.width-a.x}:{left:"left"===this.labelAlign?g:0,right:"right"===this.labelAlign?g+this.width:l.chartWidth},v.translateX<s.left&&(r+=s.left-v.translateX),v.translateX+a.width>=s.right&&(r-=v.translateX+a.width-s.right),v.attr({x:r,y:o,visibility:je})}});var Pn=fn.init,Dn=fn.processData,On=Qi.prototype.tooltipFormatter;fn.init=function(){Pn.apply(this,arguments),this.setCompare(this.options.compare)},fn.setCompare=function(t){this.modifyValue="value"===t||"percent"===t?function(e,i){var n=this.compareValue;return e!==X&&(e="value"===t?e-n:e=100*(e/n)-100,i&&(i.change=e)),e}:null,this.chart.hasRendered&&(this.isDirty=!0)},fn.processData=function(){var t,e,i,n=this,r=0;if(Dn.apply(this,arguments),n.xAxis&&n.processedYData)for(t=n.processedXData,e=n.processedYData,i=e.length;i>r;r++)if(typeof e[r]===xn&&t[r]>=n.xAxis.min){n.compareValue=e[r];break}},x(fn,"getExtremes",function(t){t.call(this),this.modifyValue&&(this.dataMax=this.modifyValue(this.dataMax),this.dataMin=this.modifyValue(this.dataMin))}),R.prototype.setCompare=function(t,e){this.isXAxis||(xi(this.series,function(e){e.setCompare(t)}),f(e,!0)&&this.chart.redraw())},Qi.prototype.tooltipFormatter=function(t){var e=this;return t=t.replace("{point.change}",(e.change>0?"+":"")+b(e.change,f(e.series.tooltipOptions.changeDecimals,2))),On.apply(this,[t])},t(fi,{Axis:R,Chart:B,Color:zi,Point:Qi,Tick:N,Renderer:Y,Series:tn,SVGElement:W,SVGRenderer:Ii,arrayMin:M,arrayMax:A,charts:Be,dateFormat:K,format:k,pathAnim:J,getOptions:I,hasBidiBug:ze,isTouchDevice:Oe,numberFormat:b,seriesTypes:pi,setOptions:z,addEvent:Ci,removeEvent:Ti,createElement:m,discardElement:P,css:g,each:xi,extend:t,map:ki,merge:e,pick:f,splat:p,extendClass:v,pInt:n,wrap:x,svg:He,canvas:Ie,vml:!He&&!Ie,product:Fe,version:qe})}(),function(t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else{if("function"==typeof define&&define.amd)return define([],t);this.CodeMirror=t()}}(function(){function t(i,n){if(!(this instanceof t))return new t(i,n);this.options=n=n?bo(n):{},bo(Oa,n,!1),p(n);var r=n.value;"string"==typeof r&&(r=new ns(r,n.mode)),this.doc=r;var o=this.display=new e(i,r);o.wrapper.CodeMirror=this,c(this),s(this),n.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),n.autofocus&&!ha&&Ci(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,draggingText:!1,highlight:new ho,keySeq:null},Qo&&11>ta&&setTimeout(yo(ki,this,!0),20),Li(this),Po(),Je(this),this.curOp.forceUpdate=!0,Pr(this,r),n.autofocus&&!ha||Lo()==o.input?setTimeout(yo(Zi,this),20):Ji(this);for(var a in Ea)Ea.hasOwnProperty(a)&&Ea[a](this,n[a],Ha);y(this);for(var l=0;l<Na.length;++l)Na[l](this);ti(this)}function e(t,e){var i=this,n=i.input=ko("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");ea?n.style.width="1000px":n.setAttribute("wrap","off"),ca&&(n.style.border="1px solid black"),n.setAttribute("autocorrect","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("spellcheck","false"),i.inputDiv=ko("div",[n],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),i.scrollbarH=ko("div",[ko("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar"),i.scrollbarV=ko("div",[ko("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i.scrollbarFiller=ko("div",null,"CodeMirror-scrollbar-filler"),i.gutterFiller=ko("div",null,"CodeMirror-gutter-filler"),i.lineDiv=ko("div",null,"CodeMirror-code"),i.selectionDiv=ko("div",null,null,"position: relative; z-index: 1"),i.cursorDiv=ko("div",null,"CodeMirror-cursors"),i.measure=ko("div",null,"CodeMirror-measure"),i.lineMeasure=ko("div",null,"CodeMirror-measure"),i.lineSpace=ko("div",[i.measure,i.lineMeasure,i.selectionDiv,i.cursorDiv,i.lineDiv],null,"position: relative; outline: none"),i.mover=ko("div",[ko("div",[i.lineSpace],"CodeMirror-lines")],null,"position: relative"),i.sizer=ko("div",[i.mover],"CodeMirror-sizer"),i.heightForcer=ko("div",null,null,"position: absolute; height: "+ps+"px; width: 1px;"),i.gutters=ko("div",null,"CodeMirror-gutters"),i.lineGutter=null,i.scroller=ko("div",[i.sizer,i.heightForcer,i.gutters],"CodeMirror-scroll"),i.scroller.setAttribute("tabIndex","-1"),i.wrapper=ko("div",[i.inputDiv,i.scrollbarH,i.scrollbarV,i.scrollbarFiller,i.gutterFiller,i.scroller],"CodeMirror"),Qo&&8>ta&&(i.gutters.style.zIndex=-1,i.scroller.style.paddingRight=0),ca&&(n.style.width="0px"),ea||(i.scroller.draggable=!0),aa&&(i.inputDiv.style.height="1px",i.inputDiv.style.position="absolute"),Qo&&8>ta&&(i.scrollbarH.style.minHeight=i.scrollbarV.style.minWidth="18px"),t&&(t.appendChild?t.appendChild(i.wrapper):t(i.wrapper)),i.viewFrom=i.viewTo=e.first,i.view=[],i.externalMeasured=null,i.viewOffset=0,i.lastWrapHeight=i.lastWrapWidth=0,i.updateLineNumbers=null,i.lineNumWidth=i.lineNumInnerWidth=i.lineNumChars=null,i.prevInput="",i.alignWidgets=!1,i.pollingFast=!1,i.poll=new ho,i.cachedCharWidth=i.cachedTextHeight=i.cachedPaddingH=null,i.inaccurateSelection=!1,i.maxLine=null,i.maxLineLength=0,i.maxLineChanged=!1,i.wheelDX=i.wheelDY=i.wheelStartX=i.wheelStartY=null,i.shift=!1,i.selForContextMenu=null}function i(e){e.doc.mode=t.getMode(e.options,e.doc.modeOption),n(e)}function n(t){t.doc.iter(function(t){t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null)}),t.doc.frontier=t.doc.first,_e(t,100),t.state.modeGen++,t.curOp&&pi(t)}function r(t){t.options.lineWrapping?(As(t.display.wrapper,"CodeMirror-wrap"),t.display.sizer.style.minWidth=""):(Ms(t.display.wrapper,"CodeMirror-wrap"),u(t)),a(t),pi(t),Ne(t),setTimeout(function(){m(t)},100)}function o(t){var e=Ke(t.display),i=t.options.lineWrapping,n=i&&Math.max(5,t.display.scroller.clientWidth/Ze(t.display)-3);return function(r){if(nr(t.doc,r))return 0;var o=0;if(r.widgets)for(var a=0;a<r.widgets.length;a++)r.widgets[a].height&&(o+=r.widgets[a].height);return i?o+(Math.ceil(r.text.length/n)||1)*e:o+e}}function a(t){var e=t.doc,i=o(t);e.iter(function(t){var e=i(t);e!=t.height&&Hr(t,e)})}function s(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Ne(t)}function l(t){c(t),pi(t),setTimeout(function(){b(t)},20)}function c(t){var e=t.display.gutters,i=t.options.gutters;Co(e);for(var n=0;n<i.length;++n){var r=i[n],o=e.appendChild(ko("div",null,"CodeMirror-gutter "+r));"CodeMirror-linenumbers"==r&&(t.display.lineGutter=o,o.style.width=(t.display.lineNumWidth||1)+"px")}e.style.display=n?"":"none",h(t)}function h(t){var e=t.display.gutters.offsetWidth;t.display.sizer.style.marginLeft=e+"px",t.display.scrollbarH.style.left=t.options.fixedGutter?e+"px":0}function d(t){if(0==t.height)return 0;for(var e,i=t.text.length,n=t;e=Kn(n);){var r=e.find(0,!0);n=r.from.line,i+=r.from.ch-r.to.ch}for(n=t;e=Zn(n);){var r=e.find(0,!0);i-=n.text.length-r.from.ch,n=r.to.line,i+=n.text.length-r.to.ch}return i}function u(t){var e=t.display,i=t.doc;e.maxLine=Dr(i,i.first),e.maxLineLength=d(e.maxLine),e.maxLineChanged=!0,i.iter(function(t){var i=d(t);i>e.maxLineLength&&(e.maxLineLength=i,e.maxLine=t)})}function p(t){var e=go(t.gutters,"CodeMirror-linenumbers");-1==e&&t.lineNumbers?t.gutters=t.gutters.concat(["CodeMirror-linenumbers"]):e>-1&&!t.lineNumbers&&(t.gutters=t.gutters.slice(0),t.gutters.splice(e,1))}function f(t){return t.display.scroller.clientHeight-t.display.wrapper.clientHeight<ps-3}function g(t){var e=t.display.scroller;return{clientHeight:e.clientHeight,barHeight:t.display.scrollbarV.clientHeight,scrollWidth:e.scrollWidth,clientWidth:e.clientWidth,hScrollbarTakesSpace:f(t),barWidth:t.display.scrollbarH.clientWidth,docHeight:Math.round(t.doc.height+Se(t.display))}}function m(t,e){e||(e=g(t));var i=t.display,n=Oo(i.measure),r=e.docHeight+ps,o=e.scrollWidth>e.clientWidth;o&&e.scrollWidth<=e.clientWidth+1&&n>0&&!e.hScrollbarTakesSpace&&(o=!1);var a=r>e.clientHeight;if(a?(i.scrollbarV.style.display="block",i.scrollbarV.style.bottom=o?n+"px":"0",i.scrollbarV.firstChild.style.height=Math.max(0,r-e.clientHeight+(e.barHeight||i.scrollbarV.clientHeight))+"px"):(i.scrollbarV.style.display="",i.scrollbarV.firstChild.style.height="0"),o?(i.scrollbarH.style.display="block",i.scrollbarH.style.right=a?n+"px":"0",i.scrollbarH.firstChild.style.width=e.scrollWidth-e.clientWidth+(e.barWidth||i.scrollbarH.clientWidth)+"px"):(i.scrollbarH.style.display="",i.scrollbarH.firstChild.style.width="0"),o&&a?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=i.scrollbarFiller.style.width=n+"px"):i.scrollbarFiller.style.display="",o&&t.options.coverGutterNextToScrollbar&&t.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=n+"px",i.gutterFiller.style.width=i.gutters.offsetWidth+"px"):i.gutterFiller.style.display="",!t.state.checkedOverlayScrollbar&&e.clientHeight>0){if(0===n){var s=da&&!sa?"12px":"18px";i.scrollbarV.style.minWidth=i.scrollbarH.style.minHeight=s;var l=function(e){io(e)!=i.scrollbarV&&io(e)!=i.scrollbarH&&li(t,Pi)(e)};cs(i.scrollbarV,"mousedown",l),cs(i.scrollbarH,"mousedown",l)}t.state.checkedOverlayScrollbar=!0}}function v(t,e,i){var n=i&&null!=i.top?Math.max(0,i.top):t.scroller.scrollTop;
n=Math.floor(n-Te(t));var r=i&&null!=i.bottom?i.bottom:n+t.wrapper.clientHeight,o=Ir(e,n),a=Ir(e,r);if(i&&i.ensure){var s=i.ensure.from.line,l=i.ensure.to.line;if(o>s)return{from:s,to:Ir(e,Wr(Dr(e,s))+t.wrapper.clientHeight)};if(Math.min(l,e.lastLine())>=a)return{from:Ir(e,Wr(Dr(e,l))-t.wrapper.clientHeight),to:l}}return{from:o,to:Math.max(a,o+1)}}function b(t){var e=t.display,i=e.view;if(e.alignWidgets||e.gutters.firstChild&&t.options.fixedGutter){for(var n=_(e)-e.scroller.scrollLeft+t.doc.scrollLeft,r=e.gutters.offsetWidth,o=n+"px",a=0;a<i.length;a++)if(!i[a].hidden){t.options.fixedGutter&&i[a].gutter&&(i[a].gutter.style.left=o);var s=i[a].alignable;if(s)for(var l=0;l<s.length;l++)s[l].style.left=o}t.options.fixedGutter&&(e.gutters.style.left=n+r+"px")}}function y(t){if(!t.options.lineNumbers)return!1;var e=t.doc,i=x(t.options,e.first+e.size-1),n=t.display;if(i.length!=n.lineNumChars){var r=n.measure.appendChild(ko("div",[ko("div",i)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=r.firstChild.offsetWidth,a=r.offsetWidth-o;return n.lineGutter.style.width="",n.lineNumInnerWidth=Math.max(o,n.lineGutter.offsetWidth-a),n.lineNumWidth=n.lineNumInnerWidth+a,n.lineNumChars=n.lineNumInnerWidth?i.length:-1,n.lineGutter.style.width=n.lineNumWidth+"px",h(t),!0}return!1}function x(t,e){return String(t.lineNumberFormatter(e+t.firstLineNumber))}function _(t){return t.scroller.getBoundingClientRect().left-t.sizer.getBoundingClientRect().left}function w(t,e,i){var n=t.display;this.viewport=e,this.visible=v(n,t.doc,e),this.editorIsHidden=!n.wrapper.offsetWidth,this.wrapperHeight=n.wrapper.clientHeight,this.wrapperWidth=n.wrapper.clientWidth,this.oldViewFrom=n.viewFrom,this.oldViewTo=n.viewTo,this.oldScrollerWidth=n.scroller.clientWidth,this.force=i,this.dims=$(t)}function k(t,e){var i=t.display,n=t.doc;if(e.editorIsHidden)return gi(t),!1;if(!e.force&&e.visible.from>=i.viewFrom&&e.visible.to<=i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo)&&0==yi(t))return!1;y(t)&&(gi(t),e.dims=$(t));var r=n.first+n.size,o=Math.max(e.visible.from-t.options.viewportMargin,n.first),a=Math.min(r,e.visible.to+t.options.viewportMargin);i.viewFrom<o&&o-i.viewFrom<20&&(o=Math.max(n.first,i.viewFrom)),i.viewTo>a&&i.viewTo-a<20&&(a=Math.min(r,i.viewTo)),va&&(o=er(t.doc,o),a=ir(t.doc,a));var s=o!=i.viewFrom||a!=i.viewTo||i.lastWrapHeight!=e.wrapperHeight||i.lastWrapWidth!=e.wrapperWidth;bi(t,o,a),i.viewOffset=Wr(Dr(t.doc,i.viewFrom)),t.display.mover.style.top=i.viewOffset+"px";var l=yi(t);if(!s&&0==l&&!e.force&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo))return!1;var c=Lo();return l>4&&(i.lineDiv.style.display="none"),P(t,i.updateLineNumbers,e.dims),l>4&&(i.lineDiv.style.display=""),c&&Lo()!=c&&c.offsetHeight&&c.focus(),Co(i.cursorDiv),Co(i.selectionDiv),s&&(i.lastWrapHeight=e.wrapperHeight,i.lastWrapWidth=e.wrapperWidth,_e(t,400)),i.updateLineNumbers=null,!0}function C(t,e){for(var i=e.force,n=e.viewport,r=!0;;r=!1){if(r&&t.options.lineWrapping&&e.oldScrollerWidth!=t.display.scroller.clientWidth)i=!0;else if(i=!1,n&&null!=n.top&&(n={top:Math.min(t.doc.height+Se(t.display)-ps-t.display.scroller.clientHeight,n.top)}),e.visible=v(t.display,t.doc,n),e.visible.from>=t.display.viewFrom&&e.visible.to<=t.display.viewTo)break;if(!k(t,e))break;M(t);var o=g(t);ve(t),S(t,o),m(t,o)}ro(t,"update",t),(t.display.viewFrom!=e.oldViewFrom||t.display.viewTo!=e.oldViewTo)&&ro(t,"viewportChange",t,t.display.viewFrom,t.display.viewTo)}function T(t,e){var i=new w(t,e);if(k(t,i)){M(t),C(t,i);var n=g(t);ve(t),S(t,n),m(t,n)}}function S(t,e){t.display.sizer.style.minHeight=t.display.heightForcer.style.top=e.docHeight+"px",t.display.gutters.style.height=Math.max(e.docHeight,e.clientHeight-ps)+"px"}function L(t,e){t.display.sizer.offsetWidth+t.display.gutters.offsetWidth<t.display.scroller.clientWidth-1&&(t.display.sizer.style.minHeight=t.display.heightForcer.style.top="0px",t.display.gutters.style.height=e.docHeight+"px")}function M(t){for(var e=t.display,i=e.lineDiv.offsetTop,n=0;n<e.view.length;n++){var r,o=e.view[n];if(!o.hidden){if(Qo&&8>ta){var a=o.node.offsetTop+o.node.offsetHeight;r=a-i,i=a}else{var s=o.node.getBoundingClientRect();r=s.bottom-s.top}var l=o.line.height-r;if(2>r&&(r=Ke(e)),(l>.001||-.001>l)&&(Hr(o.line,r),A(o.line),o.rest))for(var c=0;c<o.rest.length;c++)A(o.rest[c])}}}function A(t){if(t.widgets)for(var e=0;e<t.widgets.length;++e)t.widgets[e].height=t.widgets[e].node.offsetHeight}function $(t){for(var e=t.display,i={},n={},r=e.gutters.clientLeft,o=e.gutters.firstChild,a=0;o;o=o.nextSibling,++a)i[t.options.gutters[a]]=o.offsetLeft+o.clientLeft+r,n[t.options.gutters[a]]=o.clientWidth;return{fixedPos:_(e),gutterTotalWidth:e.gutters.offsetWidth,gutterLeft:i,gutterWidth:n,wrapperWidth:e.wrapper.clientWidth}}function P(t,e,i){function n(e){var i=e.nextSibling;return ea&&da&&t.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),i}for(var r=t.display,o=t.options.lineNumbers,a=r.lineDiv,s=a.firstChild,l=r.view,c=r.viewFrom,h=0;h<l.length;h++){var d=l[h];if(d.hidden);else if(d.node){for(;s!=d.node;)s=n(s);var u=o&&null!=e&&c>=e&&d.lineNumber;d.changes&&(go(d.changes,"gutter")>-1&&(u=!1),D(t,d,c,i)),u&&(Co(d.lineNumber),d.lineNumber.appendChild(document.createTextNode(x(t.options,c)))),s=d.node.nextSibling}else{var p=R(t,d,c,i);a.insertBefore(p,s)}c+=d.size}for(;s;)s=n(s)}function D(t,e,i,n){for(var r=0;r<e.changes.length;r++){var o=e.changes[r];"text"==o?z(t,e):"gutter"==o?W(t,e,i,n):"class"==o?I(e):"widget"==o&&N(e,n)}e.changes=null}function O(t){return t.node==t.text&&(t.node=ko("div",null,null,"position: relative"),t.text.parentNode&&t.text.parentNode.replaceChild(t.node,t.text),t.node.appendChild(t.text),Qo&&8>ta&&(t.node.style.zIndex=2)),t.node}function E(t){var e=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(e&&(e+=" CodeMirror-linebackground"),t.background)e?t.background.className=e:(t.background.parentNode.removeChild(t.background),t.background=null);else if(e){var i=O(t);t.background=i.insertBefore(ko("div",null,e),i.firstChild)}}function H(t,e){var i=t.display.externalMeasured;return i&&i.line==e.line?(t.display.externalMeasured=null,e.measure=i.measure,i.built):yr(t,e)}function z(t,e){var i=e.text.className,n=H(t,e);e.text==e.node&&(e.node=n.pre),e.text.parentNode.replaceChild(n.pre,e.text),e.text=n.pre,n.bgClass!=e.bgClass||n.textClass!=e.textClass?(e.bgClass=n.bgClass,e.textClass=n.textClass,I(e)):i&&(e.text.className=i)}function I(t){E(t),t.line.wrapClass?O(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var e=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=e||""}function W(t,e,i,n){e.gutter&&(e.node.removeChild(e.gutter),e.gutter=null);var r=e.line.gutterMarkers;if(t.options.lineNumbers||r){var o=O(e),a=e.gutter=o.insertBefore(ko("div",null,"CodeMirror-gutter-wrapper","left: "+(t.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px; width: "+n.gutterTotalWidth+"px"),e.text);if(e.line.gutterClass&&(a.className+=" "+e.line.gutterClass),!t.options.lineNumbers||r&&r["CodeMirror-linenumbers"]||(e.lineNumber=a.appendChild(ko("div",x(t.options,i),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+t.display.lineNumInnerWidth+"px"))),r)for(var s=0;s<t.options.gutters.length;++s){var l=t.options.gutters[s],c=r.hasOwnProperty(l)&&r[l];c&&a.appendChild(ko("div",[c],"CodeMirror-gutter-elt","left: "+n.gutterLeft[l]+"px; width: "+n.gutterWidth[l]+"px"))}}}function N(t,e){t.alignable&&(t.alignable=null);for(var i,n=t.node.firstChild;n;n=i){var i=n.nextSibling;"CodeMirror-linewidget"==n.className&&t.node.removeChild(n)}B(t,e)}function R(t,e,i,n){var r=H(t,e);return e.text=e.node=r.pre,r.bgClass&&(e.bgClass=r.bgClass),r.textClass&&(e.textClass=r.textClass),I(e),W(t,e,i,n),B(e,n),e.node}function B(t,e){if(F(t.line,t,e,!0),t.rest)for(var i=0;i<t.rest.length;i++)F(t.rest[i],t,e,!1)}function F(t,e,i,n){if(t.widgets)for(var r=O(e),o=0,a=t.widgets;o<a.length;++o){var s=a[o],l=ko("div",[s.node],"CodeMirror-linewidget");s.handleMouseEvents||(l.ignoreEvents=!0),q(s,l,e,i),n&&s.above?r.insertBefore(l,e.gutter||e.text):r.appendChild(l),ro(s,"redraw")}}function q(t,e,i,n){if(t.noHScroll){(i.alignable||(i.alignable=[])).push(e);var r=n.wrapperWidth;e.style.left=n.fixedPos+"px",t.coverGutter||(r-=n.gutterTotalWidth,e.style.paddingLeft=n.gutterTotalWidth+"px"),e.style.width=r+"px"}t.coverGutter&&(e.style.zIndex=5,e.style.position="relative",t.noHScroll||(e.style.marginLeft=-n.gutterTotalWidth+"px"))}function G(t){return ba(t.line,t.ch)}function X(t,e){return ya(t,e)<0?e:t}function Y(t,e){return ya(t,e)<0?t:e}function V(t,e){this.ranges=t,this.primIndex=e}function U(t,e){this.anchor=t,this.head=e}function j(t,e){var i=t[e];t.sort(function(t,e){return ya(t.from(),e.from())}),e=go(t,i);for(var n=1;n<t.length;n++){var r=t[n],o=t[n-1];if(ya(o.to(),r.from())>=0){var a=Y(o.from(),r.from()),s=X(o.to(),r.to()),l=o.empty()?r.from()==r.head:o.from()==o.head;e>=n&&--e,t.splice(--n,2,new U(l?s:a,l?a:s))}}return new V(t,e)}function K(t,e){return new V([new U(t,e||t)],0)}function Z(t,e){return Math.max(t.first,Math.min(e,t.first+t.size-1))}function J(t,e){if(e.line<t.first)return ba(t.first,0);var i=t.first+t.size-1;return e.line>i?ba(i,Dr(t,i).text.length):Q(e,Dr(t,e.line).text.length)}function Q(t,e){var i=t.ch;return null==i||i>e?ba(t.line,e):0>i?ba(t.line,0):t}function te(t,e){return e>=t.first&&e<t.first+t.size}function ee(t,e){for(var i=[],n=0;n<e.length;n++)i[n]=J(t,e[n]);return i}function ie(t,e,i,n){if(t.cm&&t.cm.display.shift||t.extend){var r=e.anchor;if(n){var o=ya(i,r)<0;o!=ya(n,r)<0?(r=i,i=n):o!=ya(i,n)<0&&(i=n)}return new U(r,i)}return new U(n||i,i)}function ne(t,e,i,n){ce(t,new V([ie(t,t.sel.primary(),e,i)],0),n),t.cm&&ds(t.cm,"cursorMoved",t.cm)}function re(t,e,i){for(var n=[],r=0;r<t.sel.ranges.length;r++)n[r]=ie(t,t.sel.ranges[r],e[r],null);var o=j(n,t.sel.primIndex);ce(t,o,i)}function oe(t,e,i,n){var r=t.sel.ranges.slice(0);r[e]=i,ce(t,j(r,t.sel.primIndex),n)}function ae(t,e,i,n){ce(t,K(e,i),n)}function se(t,e){var i={ranges:e.ranges,update:function(e){this.ranges=[];for(var i=0;i<e.length;i++)this.ranges[i]=new U(J(t,e[i].anchor),J(t,e[i].head))}};return ds(t,"beforeSelectionChange",t,i),t.cm&&ds(t.cm,"beforeSelectionChange",t.cm,i),i.ranges!=e.ranges?j(i.ranges,i.ranges.length-1):e}function le(t,e,i){var n=t.history.done,r=fo(n);r&&r.ranges?(n[n.length-1]=e,he(t,e,i)):ce(t,e,i)}function ce(t,e,i){he(t,e,i),Yr(t,t.sel,t.cm?t.cm.curOp.id:0/0,i)}function he(t,e,i){(lo(t,"beforeSelectionChange")||t.cm&&lo(t.cm,"beforeSelectionChange"))&&(e=se(t,e));var n=i&&i.bias||(ya(e.primary().head,t.sel.primary().head)<0?-1:1);de(t,pe(t,e,n,!0)),i&&i.scroll===!1||!t.cm||yn(t.cm)}function de(t,e){e.equals(t.sel)||(t.sel=e,t.cm&&(t.cm.curOp.updateInput=t.cm.curOp.selectionChanged=!0,so(t.cm)),ro(t,"cursorActivity",t))}function ue(t){de(t,pe(t,t.sel,null,!1),gs)}function pe(t,e,i,n){for(var r,o=0;o<e.ranges.length;o++){var a=e.ranges[o],s=fe(t,a.anchor,i,n),l=fe(t,a.head,i,n);(r||s!=a.anchor||l!=a.head)&&(r||(r=e.ranges.slice(0,o)),r[o]=new U(s,l))}return r?j(r,e.primIndex):e}function fe(t,e,i,n){var r=!1,o=e,a=i||1;t.cantEdit=!1;t:for(;;){var s=Dr(t,o.line);if(s.markedSpans)for(var l=0;l<s.markedSpans.length;++l){var c=s.markedSpans[l],h=c.marker;if((null==c.from||(h.inclusiveLeft?c.from<=o.ch:c.from<o.ch))&&(null==c.to||(h.inclusiveRight?c.to>=o.ch:c.to>o.ch))){if(n&&(ds(h,"beforeCursorEnter"),h.explicitlyCleared)){if(s.markedSpans){--l;continue}break}if(!h.atomic)continue;var d=h.find(0>a?-1:1);if(0==ya(d,o)&&(d.ch+=a,d.ch<0?d=d.line>t.first?J(t,ba(d.line-1)):null:d.ch>s.text.length&&(d=d.line<t.first+t.size-1?ba(d.line+1,0):null),!d)){if(r)return n?(t.cantEdit=!0,ba(t.first,0)):fe(t,e,i,!0);r=!0,d=e,a=-a}o=d;continue t}}return o}}function ge(t){for(var e=t.display,i=t.doc,n={},r=n.cursors=document.createDocumentFragment(),o=n.selection=document.createDocumentFragment(),a=0;a<i.sel.ranges.length;a++){var s=i.sel.ranges[a],l=s.empty();(l||t.options.showCursorWhenSelecting)&&be(t,s,r),l||ye(t,s,o)}if(t.options.moveInputWithCursor){var c=Xe(t,i.sel.primary().head,"div"),h=e.wrapper.getBoundingClientRect(),d=e.lineDiv.getBoundingClientRect();n.teTop=Math.max(0,Math.min(e.wrapper.clientHeight-10,c.top+d.top-h.top)),n.teLeft=Math.max(0,Math.min(e.wrapper.clientWidth-10,c.left+d.left-h.left))}return n}function me(t,e){To(t.display.cursorDiv,e.cursors),To(t.display.selectionDiv,e.selection),null!=e.teTop&&(t.display.inputDiv.style.top=e.teTop+"px",t.display.inputDiv.style.left=e.teLeft+"px")}function ve(t){me(t,ge(t))}function be(t,e,i){var n=Xe(t,e.head,"div",null,null,!t.options.singleCursorHeightPerLine),r=i.appendChild(ko("div","Â ","CodeMirror-cursor"));if(r.style.left=n.left+"px",r.style.top=n.top+"px",r.style.height=Math.max(0,n.bottom-n.top)*t.options.cursorHeight+"px",n.other){var o=i.appendChild(ko("div","Â ","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=n.other.left+"px",o.style.top=n.other.top+"px",o.style.height=.85*(n.other.bottom-n.other.top)+"px"}}function ye(t,e,i){function n(t,e,i,n){0>e&&(e=0),e=Math.round(e),n=Math.round(n),s.appendChild(ko("div",null,"CodeMirror-selected","position: absolute; left: "+t+"px; top: "+e+"px; width: "+(null==i?h-t:i)+"px; height: "+(n-e)+"px"))}function r(e,i,r){function o(i,n){return Ge(t,ba(e,i),"div",d,n)}var s,l,d=Dr(a,e),u=d.text.length;return Io(Nr(d),i||0,null==r?u:r,function(t,e,a){var d,p,f,g=o(t,"left");if(t==e)d=g,p=f=g.left;else{if(d=o(e-1,"right"),"rtl"==a){var m=g;g=d,d=m}p=g.left,f=d.right}null==i&&0==t&&(p=c),d.top-g.top>3&&(n(p,g.top,null,g.bottom),p=c,g.bottom<d.top&&n(p,g.bottom,null,d.top)),null==r&&e==u&&(f=h),(!s||g.top<s.top||g.top==s.top&&g.left<s.left)&&(s=g),(!l||d.bottom>l.bottom||d.bottom==l.bottom&&d.right>l.right)&&(l=d),c+1>p&&(p=c),n(p,d.top,f-p,d.bottom)}),{start:s,end:l}}var o=t.display,a=t.doc,s=document.createDocumentFragment(),l=Le(t.display),c=l.left,h=o.lineSpace.offsetWidth-l.right,d=e.from(),u=e.to();if(d.line==u.line)r(d.line,d.ch,u.ch);else{var p=Dr(a,d.line),f=Dr(a,u.line),g=Qn(p)==Qn(f),m=r(d.line,d.ch,g?p.text.length+1:null).end,v=r(u.line,g?0:null,u.ch).start;g&&(m.top<v.top-2?(n(m.right,m.top,null,m.bottom),n(c,v.top,v.left,v.bottom)):n(m.right,m.top,v.left-m.right,m.bottom)),m.bottom<v.top&&n(c,m.bottom,null,v.top)}i.appendChild(s)}function xe(t){if(t.state.focused){var e=t.display;clearInterval(e.blinker);var i=!0;e.cursorDiv.style.visibility="",t.options.cursorBlinkRate>0?e.blinker=setInterval(function(){e.cursorDiv.style.visibility=(i=!i)?"":"hidden"},t.options.cursorBlinkRate):t.options.cursorBlinkRate<0&&(e.cursorDiv.style.visibility="hidden")}}function _e(t,e){t.doc.mode.startState&&t.doc.frontier<t.display.viewTo&&t.state.highlight.set(e,yo(we,t))}function we(t){var e=t.doc;if(e.frontier<e.first&&(e.frontier=e.first),!(e.frontier>=t.display.viewTo)){var i=+new Date+t.options.workTime,n=Ba(e.mode,Ce(t,e.frontier)),r=[];e.iter(e.frontier,Math.min(e.first+e.size,t.display.viewTo+500),function(o){if(e.frontier>=t.display.viewFrom){var a=o.styles,s=gr(t,o,n,!0);o.styles=s.styles;var l=o.styleClasses,c=s.classes;c?o.styleClasses=c:l&&(o.styleClasses=null);for(var h=!a||a.length!=o.styles.length||l!=c&&(!l||!c||l.bgClass!=c.bgClass||l.textClass!=c.textClass),d=0;!h&&d<a.length;++d)h=a[d]!=o.styles[d];h&&r.push(e.frontier),o.stateAfter=Ba(e.mode,n)}else vr(t,o.text,n),o.stateAfter=0==e.frontier%5?Ba(e.mode,n):null;return++e.frontier,+new Date>i?(_e(t,t.options.workDelay),!0):void 0}),r.length&&si(t,function(){for(var e=0;e<r.length;e++)fi(t,r[e],"text")})}}function ke(t,e,i){for(var n,r,o=t.doc,a=i?-1:e-(t.doc.mode.innerMode?1e3:100),s=e;s>a;--s){if(s<=o.first)return o.first;var l=Dr(o,s-1);if(l.stateAfter&&(!i||s<=o.frontier))return s;var c=bs(l.text,null,t.options.tabSize);(null==r||n>c)&&(r=s-1,n=c)}return r}function Ce(t,e,i){var n=t.doc,r=t.display;if(!n.mode.startState)return!0;var o=ke(t,e,i),a=o>n.first&&Dr(n,o-1).stateAfter;return a=a?Ba(n.mode,a):Fa(n.mode),n.iter(o,e,function(i){vr(t,i.text,a);var s=o==e-1||0==o%5||o>=r.viewFrom&&o<r.viewTo;i.stateAfter=s?Ba(n.mode,a):null,++o}),i&&(n.frontier=o),a}function Te(t){return t.lineSpace.offsetTop}function Se(t){return t.mover.offsetHeight-t.lineSpace.offsetHeight}function Le(t){if(t.cachedPaddingH)return t.cachedPaddingH;var e=To(t.measure,ko("pre","x")),i=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,n={left:parseInt(i.paddingLeft),right:parseInt(i.paddingRight)};return isNaN(n.left)||isNaN(n.right)||(t.cachedPaddingH=n),n}function Me(t,e,i){var n=t.options.lineWrapping,r=n&&t.display.scroller.clientWidth;if(!e.measure.heights||n&&e.measure.width!=r){var o=e.measure.heights=[];if(n){e.measure.width=r;for(var a=e.text.firstChild.getClientRects(),s=0;s<a.length-1;s++){var l=a[s],c=a[s+1];Math.abs(l.bottom-c.bottom)>2&&o.push((l.bottom+c.top)/2-i.top)}}o.push(i.bottom-i.top)}}function Ae(t,e,i){if(t.line==e)return{map:t.measure.map,cache:t.measure.cache};for(var n=0;n<t.rest.length;n++)if(t.rest[n]==e)return{map:t.measure.maps[n],cache:t.measure.caches[n]};for(var n=0;n<t.rest.length;n++)if(zr(t.rest[n])>i)return{map:t.measure.maps[n],cache:t.measure.caches[n],before:!0}}function $e(t,e){e=Qn(e);var i=zr(e),n=t.display.externalMeasured=new di(t.doc,e,i);n.lineN=i;var r=n.built=yr(t,n);return n.text=r.pre,To(t.display.lineMeasure,r.pre),n}function Pe(t,e,i,n){return Ee(t,Oe(t,e),i,n)}function De(t,e){if(e>=t.display.viewFrom&&e<t.display.viewTo)return t.display.view[mi(t,e)];var i=t.display.externalMeasured;return i&&e>=i.lineN&&e<i.lineN+i.size?i:void 0}function Oe(t,e){var i=zr(e),n=De(t,i);n&&!n.text?n=null:n&&n.changes&&D(t,n,i,$(t)),n||(n=$e(t,e));var r=Ae(n,e,i);return{line:e,view:n,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function Ee(t,e,i,n,r){e.before&&(i=-1);var o,a=i+(n||"");return e.cache.hasOwnProperty(a)?o=e.cache[a]:(e.rect||(e.rect=e.view.text.getBoundingClientRect()),e.hasHeights||(Me(t,e.view,e.rect),e.hasHeights=!0),o=He(t,e,i,n),o.bogus||(e.cache[a]=o)),{left:o.left,right:o.right,top:r?o.rtop:o.top,bottom:r?o.rbottom:o.bottom}}function He(t,e,i,n){for(var r,o,a,s,l=e.map,c=0;c<l.length;c+=3){var h=l[c],d=l[c+1];if(h>i?(o=0,a=1,s="left"):d>i?(o=i-h,a=o+1):(c==l.length-3||i==d&&l[c+3]>i)&&(a=d-h,o=a-1,i>=d&&(s="right")),null!=o){if(r=l[c+2],h==d&&n==(r.insertLeft?"left":"right")&&(s=n),"left"==n&&0==o)for(;c&&l[c-2]==l[c-3]&&l[c-1].insertLeft;)r=l[(c-=3)+2],s="left";if("right"==n&&o==d-h)for(;c<l.length-3&&l[c+3]==l[c+4]&&!l[c+5].insertLeft;)r=l[(c+=3)+2],s="right";break}}var u;if(3==r.nodeType){for(var c=0;4>c;c++){for(;o&&wo(e.line.text.charAt(h+o));)--o;for(;d>h+a&&wo(e.line.text.charAt(h+a));)++a;if(Qo&&9>ta&&0==o&&a==d-h)u=r.parentNode.getBoundingClientRect();else if(Qo&&t.options.lineWrapping){var p=_s(r,o,a).getClientRects();u=p.length?p["right"==n?p.length-1:0]:ka}else u=_s(r,o,a).getBoundingClientRect()||ka;if(u.left||u.right||0==o)break;a=o,o-=1,s="right"}Qo&&11>ta&&(u=ze(t.display.measure,u))}else{o>0&&(s=n="right");var p;u=t.options.lineWrapping&&(p=r.getClientRects()).length>1?p["right"==n?p.length-1:0]:r.getBoundingClientRect()}if(Qo&&9>ta&&!o&&(!u||!u.left&&!u.right)){var f=r.parentNode.getClientRects()[0];u=f?{left:f.left,right:f.left+Ze(t.display),top:f.top,bottom:f.bottom}:ka}for(var g=u.top-e.rect.top,m=u.bottom-e.rect.top,v=(g+m)/2,b=e.view.measure.heights,c=0;c<b.length-1&&!(v<b[c]);c++);var y=c?b[c-1]:0,x=b[c],_={left:("right"==s?u.right:u.left)-e.rect.left,right:("left"==s?u.left:u.right)-e.rect.left,top:y,bottom:x};return u.left||u.right||(_.bogus=!0),t.options.singleCursorHeightPerLine||(_.rtop=g,_.rbottom=m),_}function ze(t,e){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!zo(t))return e;var i=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI;return{left:e.left*i,right:e.right*i,top:e.top*n,bottom:e.bottom*n}}function Ie(t){if(t.measure&&(t.measure.cache={},t.measure.heights=null,t.rest))for(var e=0;e<t.rest.length;e++)t.measure.caches[e]={}}function We(t){t.display.externalMeasure=null,Co(t.display.lineMeasure);for(var e=0;e<t.display.view.length;e++)Ie(t.display.view[e])}function Ne(t){We(t),t.display.cachedCharWidth=t.display.cachedTextHeight=t.display.cachedPaddingH=null,t.options.lineWrapping||(t.display.maxLineChanged=!0),t.display.lineNumChars=null}function Re(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Be(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function Fe(t,e,i,n){if(e.widgets)for(var r=0;r<e.widgets.length;++r)if(e.widgets[r].above){var o=ar(e.widgets[r]);i.top+=o,i.bottom+=o}if("line"==n)return i;n||(n="local");var a=Wr(e);if("local"==n?a+=Te(t.display):a-=t.display.viewOffset,"page"==n||"window"==n){var s=t.display.lineSpace.getBoundingClientRect();a+=s.top+("window"==n?0:Be());var l=s.left+("window"==n?0:Re());i.left+=l,i.right+=l}return i.top+=a,i.bottom+=a,i}function qe(t,e,i){if("div"==i)return e;var n=e.left,r=e.top;if("page"==i)n-=Re(),r-=Be();else if("local"==i||!i){var o=t.display.sizer.getBoundingClientRect();n+=o.left,r+=o.top}var a=t.display.lineSpace.getBoundingClientRect();return{left:n-a.left,top:r-a.top}}function Ge(t,e,i,n,r){return n||(n=Dr(t.doc,e.line)),Fe(t,n,Pe(t,n,e.ch,r),i)}function Xe(t,e,i,n,r,o){function a(e,a){var s=Ee(t,r,e,a?"right":"left",o);return a?s.left=s.right:s.right=s.left,Fe(t,n,s,i)}function s(t,e){var i=l[e],n=i.level%2;return t==Wo(i)&&e&&i.level<l[e-1].level?(i=l[--e],t=No(i)-(i.level%2?0:1),n=!0):t==No(i)&&e<l.length-1&&i.level<l[e+1].level&&(i=l[++e],t=Wo(i)-i.level%2,n=!1),n&&t==i.to&&t>i.from?a(t-1):a(t,n)}n=n||Dr(t.doc,e.line),r||(r=Oe(t,n));var l=Nr(n),c=e.ch;if(!l)return a(c);var h=Yo(l,c),d=s(c,h);return null!=Is&&(d.other=s(c,Is)),d}function Ye(t,e){var i=0,e=J(t.doc,e);t.options.lineWrapping||(i=Ze(t.display)*e.ch);var n=Dr(t.doc,e.line),r=Wr(n)+Te(t.display);return{left:i,right:i,top:r,bottom:r+n.height}}function Ve(t,e,i,n){var r=ba(t,e);return r.xRel=n,i&&(r.outside=!0),r}function Ue(t,e,i){var n=t.doc;if(i+=t.display.viewOffset,0>i)return Ve(n.first,0,!0,-1);var r=Ir(n,i),o=n.first+n.size-1;if(r>o)return Ve(n.first+n.size-1,Dr(n,o).text.length,!0,1);0>e&&(e=0);for(var a=Dr(n,r);;){var s=je(t,a,r,e,i),l=Zn(a),c=l&&l.find(0,!0);if(!l||!(s.ch>c.from.ch||s.ch==c.from.ch&&s.xRel>0))return s;r=zr(a=c.to.line)}}function je(t,e,i,n,r){function o(n){var r=Xe(t,ba(i,n),"line",e,c);return s=!0,a>r.bottom?r.left-l:a<r.top?r.left+l:(s=!1,r.left)}var a=r-Wr(e),s=!1,l=2*t.display.wrapper.clientWidth,c=Oe(t,e),h=Nr(e),d=e.text.length,u=Ro(e),p=Bo(e),f=o(u),g=s,m=o(p),v=s;if(n>m)return Ve(i,p,v,1);for(;;){if(h?p==u||p==Uo(e,u,1):1>=p-u){for(var b=f>n||m-n>=n-f?u:p,y=n-(b==u?f:m);wo(e.text.charAt(b));)++b;var x=Ve(i,b,b==u?g:v,-1>y?-1:y>1?1:0);return x}var _=Math.ceil(d/2),w=u+_;if(h){w=u;for(var k=0;_>k;++k)w=Uo(e,w,1)}var C=o(w);C>n?(p=w,m=C,(v=s)&&(m+=1e3),d=_):(u=w,f=C,g=s,d-=_)}}function Ke(t){if(null!=t.cachedTextHeight)return t.cachedTextHeight;if(null==xa){xa=ko("pre");for(var e=0;49>e;++e)xa.appendChild(document.createTextNode("x")),xa.appendChild(ko("br"));xa.appendChild(document.createTextNode("x"))}To(t.measure,xa);var i=xa.offsetHeight/50;return i>3&&(t.cachedTextHeight=i),Co(t.measure),i||1}function Ze(t){if(null!=t.cachedCharWidth)return t.cachedCharWidth;var e=ko("span","xxxxxxxxxx"),i=ko("pre",[e]);To(t.measure,i);var n=e.getBoundingClientRect(),r=(n.right-n.left)/10;return r>2&&(t.cachedCharWidth=r),r||10}function Je(t){t.curOp={cm:t,viewChanged:!1,startHeight:t.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,id:++Ta},Ca?Ca.ops.push(t.curOp):t.curOp.ownsGroup=Ca={ops:[t.curOp],delayedCallbacks:[]}}function Qe(t){var e=t.delayedCallbacks,i=0;do{for(;i<e.length;i++)e[i]();for(var n=0;n<t.ops.length;n++){var r=t.ops[n];if(r.cursorActivityHandlers)for(;r.cursorActivityCalled<r.cursorActivityHandlers.length;)r.cursorActivityHandlers[r.cursorActivityCalled++](r.cm)}}while(i<e.length)}function ti(t){var e=t.curOp,i=e.ownsGroup;if(i)try{Qe(i)}finally{Ca=null;for(var n=0;n<i.ops.length;n++)i.ops[n].cm.curOp=null;ei(i)}}function ei(t){for(var e=t.ops,i=0;i<e.length;i++)ii(e[i]);for(var i=0;i<e.length;i++)ni(e[i]);for(var i=0;i<e.length;i++)ri(e[i]);for(var i=0;i<e.length;i++)oi(e[i]);for(var i=0;i<e.length;i++)ai(e[i])}function ii(t){var e=t.cm,i=e.display;t.updateMaxLine&&u(e),t.mustUpdate=t.viewChanged||t.forceUpdate||null!=t.scrollTop||t.scrollToPos&&(t.scrollToPos.from.line<i.viewFrom||t.scrollToPos.to.line>=i.viewTo)||i.maxLineChanged&&e.options.lineWrapping,t.update=t.mustUpdate&&new w(e,t.mustUpdate&&{top:t.scrollTop,ensure:t.scrollToPos},t.forceUpdate)}function ni(t){t.updatedDisplay=t.mustUpdate&&k(t.cm,t.update)}function ri(t){var e=t.cm,i=e.display;t.updatedDisplay&&M(e),t.barMeasure=g(e),i.maxLineChanged&&!e.options.lineWrapping&&(t.adjustWidthTo=Pe(e,i.maxLine,i.maxLine.text.length).left+3,t.maxScrollLeft=Math.max(0,i.sizer.offsetLeft+t.adjustWidthTo+ps-i.scroller.clientWidth)),(t.updatedDisplay||t.selectionChanged)&&(t.newSelectionNodes=ge(e))}function oi(t){var e=t.cm;null!=t.adjustWidthTo&&(e.display.sizer.style.minWidth=t.adjustWidthTo+"px",t.maxScrollLeft<e.doc.scrollLeft&&Ri(e,Math.min(e.display.scroller.scrollLeft,t.maxScrollLeft),!0),e.display.maxLineChanged=!1),t.newSelectionNodes&&me(e,t.newSelectionNodes),t.updatedDisplay&&S(e,t.barMeasure),(t.updatedDisplay||t.startHeight!=e.doc.height)&&m(e,t.barMeasure),t.selectionChanged&&xe(e),e.state.focused&&t.updateInput&&ki(e,t.typing)}function ai(t){var e=t.cm,i=e.display,n=e.doc;if(null!=t.adjustWidthTo&&Math.abs(t.barMeasure.scrollWidth-e.display.scroller.scrollWidth)>1&&m(e),t.updatedDisplay&&C(e,t.update),null==i.wheelStartX||null==t.scrollTop&&null==t.scrollLeft&&!t.scrollToPos||(i.wheelStartX=i.wheelStartY=null),null!=t.scrollTop&&(i.scroller.scrollTop!=t.scrollTop||t.forceScroll)){var r=Math.max(0,Math.min(i.scroller.scrollHeight-i.scroller.clientHeight,t.scrollTop));i.scroller.scrollTop=i.scrollbarV.scrollTop=n.scrollTop=r}if(null!=t.scrollLeft&&(i.scroller.scrollLeft!=t.scrollLeft||t.forceScroll)){var o=Math.max(0,Math.min(i.scroller.scrollWidth-i.scroller.clientWidth,t.scrollLeft));i.scroller.scrollLeft=i.scrollbarH.scrollLeft=n.scrollLeft=o,b(e)}if(t.scrollToPos){var a=gn(e,J(n,t.scrollToPos.from),J(n,t.scrollToPos.to),t.scrollToPos.margin);t.scrollToPos.isCursor&&e.state.focused&&fn(e,a)}var s=t.maybeHiddenMarkers,l=t.maybeUnhiddenMarkers;if(s)for(var c=0;c<s.length;++c)s[c].lines.length||ds(s[c],"hide");if(l)for(var c=0;c<l.length;++c)l[c].lines.length&&ds(l[c],"unhide");i.wrapper.offsetHeight&&(n.scrollTop=e.display.scroller.scrollTop),t.updatedDisplay&&ea&&(e.options.lineWrapping&&L(e,t.barMeasure),t.barMeasure.scrollWidth>t.barMeasure.clientWidth&&t.barMeasure.scrollWidth<t.barMeasure.clientWidth+1&&!f(e)&&m(e)),t.changeObjs&&ds(e,"changes",e,t.changeObjs)}function si(t,e){if(t.curOp)return e();Je(t);try{return e()}finally{ti(t)}}function li(t,e){return function(){if(t.curOp)return e.apply(t,arguments);Je(t);try{return e.apply(t,arguments)}finally{ti(t)}}}function ci(t){return function(){if(this.curOp)return t.apply(this,arguments);Je(this);try{return t.apply(this,arguments)}finally{ti(this)}}}function hi(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);Je(e);try{return t.apply(this,arguments)}finally{ti(e)}}}function di(t,e,i){this.line=e,this.rest=tr(e),this.size=this.rest?zr(fo(this.rest))-i+1:1,this.node=this.text=null,this.hidden=nr(t,e)}function ui(t,e,i){for(var n,r=[],o=e;i>o;o=n){var a=new di(t.doc,Dr(t.doc,o),o);n=o+a.size,r.push(a)}return r}function pi(t,e,i,n){null==e&&(e=t.doc.first),null==i&&(i=t.doc.first+t.doc.size),n||(n=0);var r=t.display;if(n&&i<r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>e)&&(r.updateLineNumbers=e),t.curOp.viewChanged=!0,e>=r.viewTo)va&&er(t.doc,e)<r.viewTo&&gi(t);else if(i<=r.viewFrom)va&&ir(t.doc,i+n)>r.viewFrom?gi(t):(r.viewFrom+=n,r.viewTo+=n);else if(e<=r.viewFrom&&i>=r.viewTo)gi(t);else if(e<=r.viewFrom){var o=vi(t,i,i+n,1);o?(r.view=r.view.slice(o.index),r.viewFrom=o.lineN,r.viewTo+=n):gi(t)}else if(i>=r.viewTo){var o=vi(t,e,e,-1);o?(r.view=r.view.slice(0,o.index),r.viewTo=o.lineN):gi(t)}else{var a=vi(t,e,e,-1),s=vi(t,i,i+n,1);a&&s?(r.view=r.view.slice(0,a.index).concat(ui(t,a.lineN,s.lineN)).concat(r.view.slice(s.index)),r.viewTo+=n):gi(t)}var l=r.externalMeasured;l&&(i<l.lineN?l.lineN+=n:e<l.lineN+l.size&&(r.externalMeasured=null))}function fi(t,e,i){t.curOp.viewChanged=!0;var n=t.display,r=t.display.externalMeasured;if(r&&e>=r.lineN&&e<r.lineN+r.size&&(n.externalMeasured=null),!(e<n.viewFrom||e>=n.viewTo)){var o=n.view[mi(t,e)];if(null!=o.node){var a=o.changes||(o.changes=[]);-1==go(a,i)&&a.push(i)}}}function gi(t){t.display.viewFrom=t.display.viewTo=t.doc.first,t.display.view=[],t.display.viewOffset=0}function mi(t,e){if(e>=t.display.viewTo)return null;if(e-=t.display.viewFrom,0>e)return null;for(var i=t.display.view,n=0;n<i.length;n++)if(e-=i[n].size,0>e)return n}function vi(t,e,i,n){var r,o=mi(t,e),a=t.display.view;if(!va||i==t.doc.first+t.doc.size)return{index:o,lineN:i};for(var s=0,l=t.display.viewFrom;o>s;s++)l+=a[s].size;if(l!=e){if(n>0){if(o==a.length-1)return null;r=l+a[o].size-e,o++}else r=l-e;e+=r,i+=r}for(;er(t.doc,i)!=i;){if(o==(0>n?0:a.length-1))return null;i+=n*a[o-(0>n?1:0)].size,o+=n}return{index:o,lineN:i}}function bi(t,e,i){var n=t.display,r=n.view;0==r.length||e>=n.viewTo||i<=n.viewFrom?(n.view=ui(t,e,i),n.viewFrom=e):(n.viewFrom>e?n.view=ui(t,e,n.viewFrom).concat(n.view):n.viewFrom<e&&(n.view=n.view.slice(mi(t,e))),n.viewFrom=e,n.viewTo<i?n.view=n.view.concat(ui(t,n.viewTo,i)):n.viewTo>i&&(n.view=n.view.slice(0,mi(t,i)))),n.viewTo=i}function yi(t){for(var e=t.display.view,i=0,n=0;n<e.length;n++){var r=e[n];r.hidden||r.node&&!r.changes||++i}return i}function xi(t){t.display.pollingFast||t.display.poll.set(t.options.pollInterval,function(){wi(t),t.state.focused&&xi(t)})}function _i(t){function e(){var n=wi(t);n||i?(t.display.pollingFast=!1,xi(t)):(i=!0,t.display.poll.set(60,e))}var i=!1;t.display.pollingFast=!0,t.display.poll.set(20,e)}function wi(t){var e=t.display.input,i=t.display.prevInput,n=t.doc;if(!t.state.focused||Os(e)&&!i||Si(t)||t.options.disableInput||t.state.keySeq)return!1;t.state.pasteIncoming&&t.state.fakedLastChar&&(e.value=e.value.substring(0,e.value.length-1),t.state.fakedLastChar=!1);var r=e.value;if(r==i&&!t.somethingSelected())return!1;if(Qo&&ta>=9&&t.display.inputHasSelection===r||da&&/[\uf700-\uf7ff]/.test(r))return ki(t),!1;var o=!t.curOp;o&&Je(t),t.display.shift=!1,8203!=r.charCodeAt(0)||n.sel!=t.display.selForContextMenu||i||(i="â€‹");for(var a=0,s=Math.min(i.length,r.length);s>a&&i.charCodeAt(a)==r.charCodeAt(a);)++a;var l=r.slice(a),c=Ds(l),h=null;t.state.pasteIncoming&&n.sel.ranges.length>1&&(Sa&&Sa.join("\n")==l?h=0==n.sel.ranges.length%Sa.length&&mo(Sa,Ds):c.length==n.sel.ranges.length&&(h=mo(c,function(t){return[t]})));for(var d=n.sel.ranges.length-1;d>=0;d--){var u=n.sel.ranges[d],p=u.from(),f=u.to();a<i.length?p=ba(p.line,p.ch-(i.length-a)):t.state.overwrite&&u.empty()&&!t.state.pasteIncoming&&(f=ba(f.line,Math.min(Dr(n,f.line).text.length,f.ch+fo(c).length)));var g=t.curOp.updateInput,m={from:p,to:f,text:h?h[d%h.length]:c,origin:t.state.pasteIncoming?"paste":t.state.cutIncoming?"cut":"+input"};if(sn(t.doc,m),ro(t,"inputRead",t,m),l&&!t.state.pasteIncoming&&t.options.electricChars&&t.options.smartIndent&&u.head.ch<100&&(!d||n.sel.ranges[d-1].head.line!=u.head.line)){var v=t.getModeAt(u.head),b=Da(m);if(v.electricChars){for(var y=0;y<v.electricChars.length;y++)if(l.indexOf(v.electricChars.charAt(y))>-1){_n(t,b.line,"smart");break}}else v.electricInput&&v.electricInput.test(Dr(n,b.line).text.slice(0,b.ch))&&_n(t,b.line,"smart")}}return yn(t),t.curOp.updateInput=g,t.curOp.typing=!0,r.length>1e3||r.indexOf("\n")>-1?e.value=t.display.prevInput="":t.display.prevInput=r,o&&ti(t),t.state.pasteIncoming=t.state.cutIncoming=!1,!0}function ki(t,e){if(!t.display.contextMenuPending){var i,n,r=t.doc;if(t.somethingSelected()){t.display.prevInput="";var o=r.sel.primary();i=Es&&(o.to().line-o.from().line>100||(n=t.getSelection()).length>1e3);var a=i?"-":n||t.getSelection();t.display.input.value=a,t.state.focused&&xs(t.display.input),Qo&&ta>=9&&(t.display.inputHasSelection=a)}else e||(t.display.prevInput=t.display.input.value="",Qo&&ta>=9&&(t.display.inputHasSelection=null));t.display.inaccurateSelection=i
}}function Ci(t){"nocursor"==t.options.readOnly||ha&&Lo()==t.display.input||t.display.input.focus()}function Ti(t){t.state.focused||(Ci(t),Zi(t))}function Si(t){return t.options.readOnly||t.doc.cantEdit}function Li(t){function e(){t.state.focused&&setTimeout(yo(Ci,t),0)}function i(e){ao(t,e)||ls(e)}function n(e){if(t.somethingSelected())Sa=t.getSelections(),r.inaccurateSelection&&(r.prevInput="",r.inaccurateSelection=!1,r.input.value=Sa.join("\n"),xs(r.input));else{for(var i=[],n=[],o=0;o<t.doc.sel.ranges.length;o++){var a=t.doc.sel.ranges[o].head.line,s={anchor:ba(a,0),head:ba(a+1,0)};n.push(s),i.push(t.getRange(s.anchor,s.head))}"cut"==e.type?t.setSelections(n,null,gs):(r.prevInput="",r.input.value=i.join("\n"),xs(r.input)),Sa=i}"cut"==e.type&&(t.state.cutIncoming=!0)}var r=t.display;cs(r.scroller,"mousedown",li(t,Pi)),Qo&&11>ta?cs(r.scroller,"dblclick",li(t,function(e){if(!ao(t,e)){var i=$i(t,e);if(i&&!zi(t,e)&&!Ai(t.display,e)){as(e);var n=t.findWordAt(i);ne(t.doc,n.anchor,n.head)}}})):cs(r.scroller,"dblclick",function(e){ao(t,e)||as(e)}),cs(r.lineSpace,"selectstart",function(t){Ai(r,t)||as(t)}),ga||cs(r.scroller,"contextmenu",function(e){Qi(t,e)}),cs(r.scroller,"scroll",function(){r.scroller.clientHeight&&(Ni(t,r.scroller.scrollTop),Ri(t,r.scroller.scrollLeft,!0),ds(t,"scroll",t))}),cs(r.scrollbarV,"scroll",function(){r.scroller.clientHeight&&Ni(t,r.scrollbarV.scrollTop)}),cs(r.scrollbarH,"scroll",function(){r.scroller.clientHeight&&Ri(t,r.scrollbarH.scrollLeft)}),cs(r.scroller,"mousewheel",function(e){Bi(t,e)}),cs(r.scroller,"DOMMouseScroll",function(e){Bi(t,e)}),cs(r.scrollbarH,"mousedown",e),cs(r.scrollbarV,"mousedown",e),cs(r.wrapper,"scroll",function(){r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),cs(r.input,"keyup",function(e){ji.call(t,e)}),cs(r.input,"input",function(){Qo&&ta>=9&&t.display.inputHasSelection&&(t.display.inputHasSelection=null),_i(t)}),cs(r.input,"keydown",li(t,Vi)),cs(r.input,"keypress",li(t,Ki)),cs(r.input,"focus",yo(Zi,t)),cs(r.input,"blur",yo(Ji,t)),t.options.dragDrop&&(cs(r.scroller,"dragstart",function(e){Wi(t,e)}),cs(r.scroller,"dragenter",i),cs(r.scroller,"dragover",i),cs(r.scroller,"drop",li(t,Ii))),cs(r.scroller,"paste",function(e){Ai(r,e)||(t.state.pasteIncoming=!0,Ci(t),_i(t))}),cs(r.input,"paste",function(){if(ea&&!t.state.fakedLastChar&&!(new Date-t.state.lastMiddleDown<200)){var e=r.input.selectionStart,i=r.input.selectionEnd;r.input.value+="$",r.input.selectionEnd=i,r.input.selectionStart=e,t.state.fakedLastChar=!0}t.state.pasteIncoming=!0,_i(t)}),cs(r.input,"cut",n),cs(r.input,"copy",n),aa&&cs(r.sizer,"mouseup",function(){Lo()==r.input&&r.input.blur(),Ci(t)})}function Mi(t){var e=t.display;(e.lastWrapHeight!=e.wrapper.clientHeight||e.lastWrapWidth!=e.wrapper.clientWidth)&&(e.cachedCharWidth=e.cachedTextHeight=e.cachedPaddingH=null,t.setSize())}function Ai(t,e){for(var i=io(e);i!=t.wrapper;i=i.parentNode)if(!i||i.ignoreEvents||i.parentNode==t.sizer&&i!=t.mover)return!0}function $i(t,e,i,n){var r=t.display;if(!i){var o=io(e);if(o==r.scrollbarH||o==r.scrollbarV||o==r.scrollbarFiller||o==r.gutterFiller)return null}var a,s,l=r.lineSpace.getBoundingClientRect();try{a=e.clientX-l.left,s=e.clientY-l.top}catch(e){return null}var c,h=Ue(t,a,s);if(n&&1==h.xRel&&(c=Dr(t.doc,h.line).text).length==h.ch){var d=bs(c,c.length,t.options.tabSize)-c.length;h=ba(h.line,Math.max(0,Math.round((a-Le(t.display).left)/Ze(t.display))-d))}return h}function Pi(t){if(!ao(this,t)){var e=this,i=e.display;if(i.shift=t.shiftKey,Ai(i,t))return ea||(i.scroller.draggable=!1,setTimeout(function(){i.scroller.draggable=!0},100)),void 0;if(!zi(e,t)){var n=$i(e,t);switch(window.focus(),no(t)){case 1:n?Di(e,t,n):io(t)==i.scroller&&as(t);break;case 2:ea&&(e.state.lastMiddleDown=+new Date),n&&ne(e.doc,n),setTimeout(yo(Ci,e),20),as(t);break;case 3:ga&&Qi(e,t)}}}}function Di(t,e,i){setTimeout(yo(Ti,t),0);var n,r=+new Date;wa&&wa.time>r-400&&0==ya(wa.pos,i)?n="triple":_a&&_a.time>r-400&&0==ya(_a.pos,i)?(n="double",wa={time:r,pos:i}):(n="single",_a={time:r,pos:i});var o=t.doc.sel,a=da?e.metaKey:e.ctrlKey;t.options.dragDrop&&Ps&&!Si(t)&&"single"==n&&o.contains(i)>-1&&o.somethingSelected()?Oi(t,e,i,a):Ei(t,e,i,n,a)}function Oi(t,e,i,n){var r=t.display,o=li(t,function(a){ea&&(r.scroller.draggable=!1),t.state.draggingText=!1,hs(document,"mouseup",o),hs(r.scroller,"drop",o),Math.abs(e.clientX-a.clientX)+Math.abs(e.clientY-a.clientY)<10&&(as(a),n||ne(t.doc,i),Ci(t),Qo&&9==ta&&setTimeout(function(){document.body.focus(),Ci(t)},20))});ea&&(r.scroller.draggable=!0),t.state.draggingText=o,r.scroller.dragDrop&&r.scroller.dragDrop(),cs(document,"mouseup",o),cs(r.scroller,"drop",o)}function Ei(t,e,i,n,r){function o(e){if(0!=ya(g,e))if(g=e,"rect"==n){for(var r=[],o=t.options.tabSize,a=bs(Dr(c,i.line).text,i.ch,o),s=bs(Dr(c,e.line).text,e.ch,o),l=Math.min(a,s),p=Math.max(a,s),f=Math.min(i.line,e.line),m=Math.min(t.lastLine(),Math.max(i.line,e.line));m>=f;f++){var v=Dr(c,f).text,b=uo(v,l,o);l==p?r.push(new U(ba(f,b),ba(f,b))):v.length>b&&r.push(new U(ba(f,b),ba(f,uo(v,p,o))))}r.length||r.push(new U(i,i)),ce(c,j(u.ranges.slice(0,d).concat(r),d),{origin:"*mouse",scroll:!1}),t.scrollIntoView(e)}else{var y=h,x=y.anchor,_=e;if("single"!=n){if("double"==n)var w=t.findWordAt(e);else var w=new U(ba(e.line,0),J(c,ba(e.line+1,0)));ya(w.anchor,x)>0?(_=w.head,x=Y(y.from(),w.anchor)):(_=w.anchor,x=X(y.to(),w.head))}var r=u.ranges.slice(0);r[d]=new U(J(c,x),_),ce(c,j(r,d),ms)}}function a(e){var i=++b,r=$i(t,e,!0,"rect"==n);if(r)if(0!=ya(r,g)){Ti(t),o(r);var s=v(l,c);(r.line>=s.to||r.line<s.from)&&setTimeout(li(t,function(){b==i&&a(e)}),150)}else{var h=e.clientY<m.top?-20:e.clientY>m.bottom?20:0;h&&setTimeout(li(t,function(){b==i&&(l.scroller.scrollTop+=h,a(e))}),50)}}function s(e){b=1/0,as(e),Ci(t),hs(document,"mousemove",y),hs(document,"mouseup",x),c.history.lastSelOrigin=null}var l=t.display,c=t.doc;as(e);var h,d,u=c.sel;if(r&&!e.shiftKey?(d=c.sel.contains(i),h=d>-1?c.sel.ranges[d]:new U(i,i)):h=c.sel.primary(),e.altKey)n="rect",r||(h=new U(i,i)),i=$i(t,e,!0,!0),d=-1;else if("double"==n){var p=t.findWordAt(i);h=t.display.shift||c.extend?ie(c,h,p.anchor,p.head):p}else if("triple"==n){var f=new U(ba(i.line,0),J(c,ba(i.line+1,0)));h=t.display.shift||c.extend?ie(c,h,f.anchor,f.head):f}else h=ie(c,h,i);r?d>-1?oe(c,d,h,ms):(d=c.sel.ranges.length,ce(c,j(c.sel.ranges.concat([h]),d),{scroll:!1,origin:"*mouse"})):(d=0,ce(c,new V([h],0),ms),u=c.sel);var g=i,m=l.wrapper.getBoundingClientRect(),b=0,y=li(t,function(t){no(t)?a(t):s(t)}),x=li(t,s);cs(document,"mousemove",y),cs(document,"mouseup",x)}function Hi(t,e,i,n,r){try{var o=e.clientX,a=e.clientY}catch(e){return!1}if(o>=Math.floor(t.display.gutters.getBoundingClientRect().right))return!1;n&&as(e);var s=t.display,l=s.lineDiv.getBoundingClientRect();if(a>l.bottom||!lo(t,i))return eo(e);a-=l.top-s.viewOffset;for(var c=0;c<t.options.gutters.length;++c){var h=s.gutters.childNodes[c];if(h&&h.getBoundingClientRect().right>=o){var d=Ir(t.doc,a),u=t.options.gutters[c];return r(t,i,t,d,u,e),eo(e)}}}function zi(t,e){return Hi(t,e,"gutterClick",!0,ro)}function Ii(t){var e=this;if(!ao(e,t)&&!Ai(e.display,t)){as(t),Qo&&(La=+new Date);var i=$i(e,t,!0),n=t.dataTransfer.files;if(i&&!Si(e))if(n&&n.length&&window.FileReader&&window.File)for(var r=n.length,o=Array(r),a=0,s=function(t,n){var s=new FileReader;s.onload=li(e,function(){if(o[n]=s.result,++a==r){i=J(e.doc,i);var t={from:i,to:i,text:Ds(o.join("\n")),origin:"paste"};sn(e.doc,t),le(e.doc,K(i,Da(t)))}}),s.readAsText(t)},l=0;r>l;++l)s(n[l],l);else{if(e.state.draggingText&&e.doc.sel.contains(i)>-1)return e.state.draggingText(t),setTimeout(yo(Ci,e),20),void 0;try{var o=t.dataTransfer.getData("Text");if(o){if(e.state.draggingText&&!(da?t.metaKey:t.ctrlKey))var c=e.listSelections();if(he(e.doc,K(i,i)),c)for(var l=0;l<c.length;++l)pn(e.doc,"",c[l].anchor,c[l].head,"drag");e.replaceSelection(o,"around","paste"),Ci(e)}}catch(t){}}}}function Wi(t,e){if(Qo&&(!t.state.draggingText||+new Date-La<100))return ls(e),void 0;if(!ao(t,e)&&!Ai(t.display,e)&&(e.dataTransfer.setData("Text",t.getSelection()),e.dataTransfer.setDragImage&&!oa)){var i=ko("img",null,null,"position: fixed; left: 0; top: 0;");i.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",ra&&(i.width=i.height=1,t.display.wrapper.appendChild(i),i._top=i.offsetTop),e.dataTransfer.setDragImage(i,0,0),ra&&i.parentNode.removeChild(i)}}function Ni(t,e){Math.abs(t.doc.scrollTop-e)<2||(t.doc.scrollTop=e,Ko||T(t,{top:e}),t.display.scroller.scrollTop!=e&&(t.display.scroller.scrollTop=e),t.display.scrollbarV.scrollTop!=e&&(t.display.scrollbarV.scrollTop=e),Ko&&T(t),_e(t,100))}function Ri(t,e,i){(i?e==t.doc.scrollLeft:Math.abs(t.doc.scrollLeft-e)<2)||(e=Math.min(e,t.display.scroller.scrollWidth-t.display.scroller.clientWidth),t.doc.scrollLeft=e,b(t),t.display.scroller.scrollLeft!=e&&(t.display.scroller.scrollLeft=e),t.display.scrollbarH.scrollLeft!=e&&(t.display.scrollbarH.scrollLeft=e))}function Bi(t,e){var i=e.wheelDeltaX,n=e.wheelDeltaY;null==i&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(i=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta);var r=t.display,o=r.scroller;if(i&&o.scrollWidth>o.clientWidth||n&&o.scrollHeight>o.clientHeight){if(n&&da&&ea)t:for(var a=e.target,s=r.view;a!=o;a=a.parentNode)for(var l=0;l<s.length;l++)if(s[l].node==a){t.display.currentWheelTarget=a;break t}if(i&&!Ko&&!ra&&null!=Aa)return n&&Ni(t,Math.max(0,Math.min(o.scrollTop+n*Aa,o.scrollHeight-o.clientHeight))),Ri(t,Math.max(0,Math.min(o.scrollLeft+i*Aa,o.scrollWidth-o.clientWidth))),as(e),r.wheelStartX=null,void 0;if(n&&null!=Aa){var c=n*Aa,h=t.doc.scrollTop,d=h+r.wrapper.clientHeight;0>c?h=Math.max(0,h+c-50):d=Math.min(t.doc.height,d+c+50),T(t,{top:h,bottom:d})}20>Ma&&(null==r.wheelStartX?(r.wheelStartX=o.scrollLeft,r.wheelStartY=o.scrollTop,r.wheelDX=i,r.wheelDY=n,setTimeout(function(){if(null!=r.wheelStartX){var t=o.scrollLeft-r.wheelStartX,e=o.scrollTop-r.wheelStartY,i=e&&r.wheelDY&&e/r.wheelDY||t&&r.wheelDX&&t/r.wheelDX;r.wheelStartX=r.wheelStartY=null,i&&(Aa=(Aa*Ma+i)/(Ma+1),++Ma)}},200)):(r.wheelDX+=i,r.wheelDY+=n))}}function Fi(t,e,i){if("string"==typeof e&&(e=qa[e],!e))return!1;t.display.pollingFast&&wi(t)&&(t.display.pollingFast=!1);var n=t.display.shift,r=!1;try{Si(t)&&(t.state.suppressEdits=!0),i&&(t.display.shift=!1),r=e(t)!=fs}finally{t.display.shift=n,t.state.suppressEdits=!1}return r}function qi(t,e,i){for(var n=0;n<t.state.keyMaps.length;n++){var r=Xa(e,t.state.keyMaps[n],i);if(r)return r}return t.options.extraKeys&&Xa(e,t.options.extraKeys,i)||Xa(e,t.options.keyMap,i)}function Gi(t,e,i,n){var r=t.state.keySeq;if(r){if(Ya(e))return"handled";$a.set(50,function(){t.state.keySeq==r&&(t.state.keySeq=null,ki(t))}),e=r+" "+e}var o=qi(t,e,n);return"multi"==o&&(t.state.keySeq=e),"handled"==o&&ro(t,"keyHandled",t,e,i),("handled"==o||"multi"==o)&&(as(i),xe(t)),r&&!o&&/\'$/.test(e)?(as(i),!0):!!o}function Xi(t,e){var i=Va(e,!0);return i?e.shiftKey&&!t.state.keySeq?Gi(t,"Shift-"+i,e,function(e){return Fi(t,e,!0)})||Gi(t,i,e,function(e){return("string"==typeof e?/^go[A-Z]/.test(e):e.motion)?Fi(t,e):void 0}):Gi(t,i,e,function(e){return Fi(t,e)}):!1}function Yi(t,e,i){return Gi(t,"'"+i+"'",e,function(e){return Fi(t,e,!0)})}function Vi(t){var e=this;if(Ti(e),!ao(e,t)){Qo&&11>ta&&27==t.keyCode&&(t.returnValue=!1);var i=t.keyCode;e.display.shift=16==i||t.shiftKey;var n=Xi(e,t);ra&&(Pa=n?i:null,!n&&88==i&&!Es&&(da?t.metaKey:t.ctrlKey)&&e.replaceSelection("",null,"cut")),18!=i||/\bCodeMirror-crosshair\b/.test(e.display.lineDiv.className)||Ui(e)}}function Ui(t){function e(t){18!=t.keyCode&&t.altKey||(Ms(i,"CodeMirror-crosshair"),hs(document,"keyup",e),hs(document,"mouseover",e))}var i=t.display.lineDiv;As(i,"CodeMirror-crosshair"),cs(document,"keyup",e),cs(document,"mouseover",e)}function ji(t){16==t.keyCode&&(this.doc.sel.shift=!1),ao(this,t)}function Ki(t){var e=this;if(!(ao(e,t)||t.ctrlKey&&!t.altKey||da&&t.metaKey)){var i=t.keyCode,n=t.charCode;if(ra&&i==Pa)return Pa=null,as(t),void 0;if(!(ra&&(!t.which||t.which<10)||aa)||!Xi(e,t)){var r=String.fromCharCode(null==n?i:n);Yi(e,t,r)||(Qo&&ta>=9&&(e.display.inputHasSelection=null),_i(e))}}}function Zi(t){"nocursor"!=t.options.readOnly&&(t.state.focused||(ds(t,"focus",t),t.state.focused=!0,As(t.display.wrapper,"CodeMirror-focused"),t.curOp||t.display.selForContextMenu==t.doc.sel||(ki(t),ea&&setTimeout(yo(ki,t,!0),0))),xi(t),xe(t))}function Ji(t){t.state.focused&&(ds(t,"blur",t),t.state.focused=!1,Ms(t.display.wrapper,"CodeMirror-focused")),clearInterval(t.display.blinker),setTimeout(function(){t.state.focused||(t.display.shift=!1)},150)}function Qi(t,e){function i(){if(null!=r.input.selectionStart){var e=t.somethingSelected(),i=r.input.value="â€‹"+(e?r.input.value:"");r.prevInput=e?"":"â€‹",r.input.selectionStart=1,r.input.selectionEnd=i.length,r.selForContextMenu=t.doc.sel}}function n(){if(r.contextMenuPending=!1,r.inputDiv.style.position="relative",r.input.style.cssText=l,Qo&&9>ta&&(r.scrollbarV.scrollTop=r.scroller.scrollTop=a),xi(t),null!=r.input.selectionStart){(!Qo||Qo&&9>ta)&&i();var e=0,n=function(){r.selForContextMenu==t.doc.sel&&0==r.input.selectionStart?li(t,qa.selectAll)(t):e++<10?r.detectingSelectAll=setTimeout(n,500):ki(t)};r.detectingSelectAll=setTimeout(n,200)}}if(!ao(t,e,"contextmenu")){var r=t.display;if(!Ai(r,e)&&!tn(t,e)){var o=$i(t,e),a=r.scroller.scrollTop;if(o&&!ra){var s=t.options.resetSelectionOnContextMenu;s&&-1==t.doc.sel.contains(o)&&li(t,ce)(t.doc,K(o),gs);var l=r.input.style.cssText;if(r.inputDiv.style.position="absolute",r.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: "+(Qo?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",ea)var c=window.scrollY;if(Ci(t),ea&&window.scrollTo(null,c),ki(t),t.somethingSelected()||(r.input.value=r.prevInput=" "),r.contextMenuPending=!0,r.selForContextMenu=t.doc.sel,clearTimeout(r.detectingSelectAll),Qo&&ta>=9&&i(),ga){ls(e);var h=function(){hs(window,"mouseup",h),setTimeout(n,20)};cs(window,"mouseup",h)}else setTimeout(n,50)}}}}function tn(t,e){return lo(t,"gutterContextMenu")?Hi(t,e,"gutterContextMenu",!1,ds):!1}function en(t,e){if(ya(t,e.from)<0)return t;if(ya(t,e.to)<=0)return Da(e);var i=t.line+e.text.length-(e.to.line-e.from.line)-1,n=t.ch;return t.line==e.to.line&&(n+=Da(e).ch-e.to.ch),ba(i,n)}function nn(t,e){for(var i=[],n=0;n<t.sel.ranges.length;n++){var r=t.sel.ranges[n];i.push(new U(en(r.anchor,e),en(r.head,e)))}return j(i,t.sel.primIndex)}function rn(t,e,i){return t.line==e.line?ba(i.line,t.ch-e.ch+i.ch):ba(i.line+(t.line-e.line),t.ch)}function on(t,e,i){for(var n=[],r=ba(t.first,0),o=r,a=0;a<e.length;a++){var s=e[a],l=rn(s.from,r,o),c=rn(Da(s),r,o);if(r=s.to,o=c,"around"==i){var h=t.sel.ranges[a],d=ya(h.head,h.anchor)<0;n[a]=new U(d?c:l,d?l:c)}else n[a]=new U(l,l)}return new V(n,t.sel.primIndex)}function an(t,e,i){var n={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){this.canceled=!0}};return i&&(n.update=function(e,i,n,r){e&&(this.from=J(t,e)),i&&(this.to=J(t,i)),n&&(this.text=n),void 0!==r&&(this.origin=r)}),ds(t,"beforeChange",t,n),t.cm&&ds(t.cm,"beforeChange",t.cm,n),n.canceled?null:{from:n.from,to:n.to,text:n.text,origin:n.origin}}function sn(t,e,i){if(t.cm){if(!t.cm.curOp)return li(t.cm,sn)(t,e,i);if(t.cm.state.suppressEdits)return}if(!(lo(t,"beforeChange")||t.cm&&lo(t.cm,"beforeChange"))||(e=an(t,e,!0))){var n=ma&&!i&&qn(t,e.from,e.to);if(n)for(var r=n.length-1;r>=0;--r)ln(t,{from:n[r].from,to:n[r].to,text:r?[""]:e.text});else ln(t,e)}}function ln(t,e){if(1!=e.text.length||""!=e.text[0]||0!=ya(e.from,e.to)){var i=nn(t,e);Gr(t,e,i,t.cm?t.cm.curOp.id:0/0),dn(t,e,i,Rn(t,e));var n=[];$r(t,function(t,i){i||-1!=go(n,t.history)||(to(t.history,e),n.push(t.history)),dn(t,e,null,Rn(t,e))})}}function cn(t,e,i){if(!t.cm||!t.cm.state.suppressEdits){for(var n,r=t.history,o=t.sel,a="undo"==e?r.done:r.undone,s="undo"==e?r.undone:r.done,l=0;l<a.length&&(n=a[l],i?!n.ranges||n.equals(t.sel):n.ranges);l++);if(l!=a.length){for(r.lastOrigin=r.lastSelOrigin=null;n=a.pop(),n.ranges;){if(Vr(n,s),i&&!n.equals(t.sel))return ce(t,n,{clearRedo:!1}),void 0;o=n}var c=[];Vr(o,s),s.push({changes:c,generation:r.generation}),r.generation=n.generation||++r.maxGeneration;for(var h=lo(t,"beforeChange")||t.cm&&lo(t.cm,"beforeChange"),l=n.changes.length-1;l>=0;--l){var d=n.changes[l];if(d.origin=e,h&&!an(t,d,!1))return a.length=0,void 0;c.push(Br(t,d));var u=l?nn(t,d):fo(a);dn(t,d,u,Fn(t,d)),!l&&t.cm&&t.cm.scrollIntoView({from:d.from,to:Da(d)});var p=[];$r(t,function(t,e){e||-1!=go(p,t.history)||(to(t.history,d),p.push(t.history)),dn(t,d,null,Fn(t,d))})}}}}function hn(t,e){if(0!=e&&(t.first+=e,t.sel=new V(mo(t.sel.ranges,function(t){return new U(ba(t.anchor.line+e,t.anchor.ch),ba(t.head.line+e,t.head.ch))}),t.sel.primIndex),t.cm)){pi(t.cm,t.first,t.first-e,e);for(var i=t.cm.display,n=i.viewFrom;n<i.viewTo;n++)fi(t.cm,n,"gutter")}}function dn(t,e,i,n){if(t.cm&&!t.cm.curOp)return li(t.cm,dn)(t,e,i,n);if(e.to.line<t.first)return hn(t,e.text.length-1-(e.to.line-e.from.line)),void 0;if(!(e.from.line>t.lastLine())){if(e.from.line<t.first){var r=e.text.length-1-(t.first-e.from.line);hn(t,r),e={from:ba(t.first,0),to:ba(e.to.line+r,e.to.ch),text:[fo(e.text)],origin:e.origin}}var o=t.lastLine();e.to.line>o&&(e={from:e.from,to:ba(o,Dr(t,o).text.length),text:[e.text[0]],origin:e.origin}),e.removed=Or(t,e.from,e.to),i||(i=nn(t,e)),t.cm?un(t.cm,e,n):Lr(t,e,n),he(t,i,gs)}}function un(t,e,i){var n=t.doc,r=t.display,a=e.from,s=e.to,l=!1,c=a.line;t.options.lineWrapping||(c=zr(Qn(Dr(n,a.line))),n.iter(c,s.line+1,function(t){return t==r.maxLine?(l=!0,!0):void 0})),n.sel.contains(e.from,e.to)>-1&&so(t),Lr(n,e,i,o(t)),t.options.lineWrapping||(n.iter(c,a.line+e.text.length,function(t){var e=d(t);e>r.maxLineLength&&(r.maxLine=t,r.maxLineLength=e,r.maxLineChanged=!0,l=!1)}),l&&(t.curOp.updateMaxLine=!0)),n.frontier=Math.min(n.frontier,a.line),_e(t,400);var h=e.text.length-(s.line-a.line)-1;a.line!=s.line||1!=e.text.length||Sr(t.doc,e)?pi(t,a.line,s.line+1,h):fi(t,a.line,"text");var u=lo(t,"changes"),p=lo(t,"change");if(p||u){var f={from:a,to:s,text:e.text,removed:e.removed,origin:e.origin};p&&ro(t,"change",t,f),u&&(t.curOp.changeObjs||(t.curOp.changeObjs=[])).push(f)}t.display.selForContextMenu=null}function pn(t,e,i,n,r){if(n||(n=i),ya(n,i)<0){var o=n;n=i,i=o}"string"==typeof e&&(e=Ds(e)),sn(t,{from:i,to:n,text:e,origin:r})}function fn(t,e){if(!ao(t,"scrollCursorIntoView")){var i=t.display,n=i.sizer.getBoundingClientRect(),r=null;if(e.top+n.top<0?r=!0:e.bottom+n.top>(window.innerHeight||document.documentElement.clientHeight)&&(r=!1),null!=r&&!la){var o=ko("div","â€‹",null,"position: absolute; top: "+(e.top-i.viewOffset-Te(t.display))+"px; height: "+(e.bottom-e.top+ps)+"px; left: "+e.left+"px; width: 2px;");t.display.lineSpace.appendChild(o),o.scrollIntoView(r),t.display.lineSpace.removeChild(o)}}}function gn(t,e,i,n){null==n&&(n=0);for(var r=0;5>r;r++){var o=!1,a=Xe(t,e),s=i&&i!=e?Xe(t,i):a,l=vn(t,Math.min(a.left,s.left),Math.min(a.top,s.top)-n,Math.max(a.left,s.left),Math.max(a.bottom,s.bottom)+n),c=t.doc.scrollTop,h=t.doc.scrollLeft;if(null!=l.scrollTop&&(Ni(t,l.scrollTop),Math.abs(t.doc.scrollTop-c)>1&&(o=!0)),null!=l.scrollLeft&&(Ri(t,l.scrollLeft),Math.abs(t.doc.scrollLeft-h)>1&&(o=!0)),!o)return a}}function mn(t,e,i,n,r){var o=vn(t,e,i,n,r);null!=o.scrollTop&&Ni(t,o.scrollTop),null!=o.scrollLeft&&Ri(t,o.scrollLeft)}function vn(t,e,i,n,r){var o=t.display,a=Ke(t.display);0>i&&(i=0);var s=t.curOp&&null!=t.curOp.scrollTop?t.curOp.scrollTop:o.scroller.scrollTop,l=o.scroller.clientHeight-ps,c={};r-i>l&&(r=i+l);var h=t.doc.height+Se(o),d=a>i,u=r>h-a;if(s>i)c.scrollTop=d?0:i;else if(r>s+l){var p=Math.min(i,(u?h:r)-l);p!=s&&(c.scrollTop=p)}var f=t.curOp&&null!=t.curOp.scrollLeft?t.curOp.scrollLeft:o.scroller.scrollLeft,g=o.scroller.clientWidth-ps-o.gutters.offsetWidth,m=n-e>g;return m&&(n=e+g),10>e?c.scrollLeft=0:f>e?c.scrollLeft=Math.max(0,e-(m?0:10)):n>g+f-3&&(c.scrollLeft=n+(m?0:10)-g),c}function bn(t,e,i){(null!=e||null!=i)&&xn(t),null!=e&&(t.curOp.scrollLeft=(null==t.curOp.scrollLeft?t.doc.scrollLeft:t.curOp.scrollLeft)+e),null!=i&&(t.curOp.scrollTop=(null==t.curOp.scrollTop?t.doc.scrollTop:t.curOp.scrollTop)+i)}function yn(t){xn(t);var e=t.getCursor(),i=e,n=e;t.options.lineWrapping||(i=e.ch?ba(e.line,e.ch-1):e,n=ba(e.line,e.ch+1)),t.curOp.scrollToPos={from:i,to:n,margin:t.options.cursorScrollMargin,isCursor:!0}}function xn(t){var e=t.curOp.scrollToPos;if(e){t.curOp.scrollToPos=null;var i=Ye(t,e.from),n=Ye(t,e.to),r=vn(t,Math.min(i.left,n.left),Math.min(i.top,n.top)-e.margin,Math.max(i.right,n.right),Math.max(i.bottom,n.bottom)+e.margin);t.scrollTo(r.scrollLeft,r.scrollTop)}}function _n(t,e,i,n){var r,o=t.doc;null==i&&(i="add"),"smart"==i&&(o.mode.indent?r=Ce(t,e):i="prev");var a=t.options.tabSize,s=Dr(o,e),l=bs(s.text,null,a);s.stateAfter&&(s.stateAfter=null);var c,h=s.text.match(/^\s*/)[0];if(n||/\S/.test(s.text)){if("smart"==i&&(c=o.mode.indent(r,s.text.slice(h.length),s.text),c==fs||c>150)){if(!n)return;i="prev"}}else c=0,i="not";"prev"==i?c=e>o.first?bs(Dr(o,e-1).text,null,a):0:"add"==i?c=l+t.options.indentUnit:"subtract"==i?c=l-t.options.indentUnit:"number"==typeof i&&(c=l+i),c=Math.max(0,c);var d="",u=0;if(t.options.indentWithTabs)for(var p=Math.floor(c/a);p;--p)u+=a,d+="	";if(c>u&&(d+=po(c-u)),d!=h)pn(o,d,ba(e,0),ba(e,h.length),"+input");else for(var p=0;p<o.sel.ranges.length;p++){var f=o.sel.ranges[p];if(f.head.line==e&&f.head.ch<h.length){var u=ba(e,h.length);oe(o,p,new U(u,u));break}}s.stateAfter=null}function wn(t,e,i,n){var r=e,o=e;return"number"==typeof e?o=Dr(t,Z(t,e)):r=zr(e),null==r?null:(n(o,r)&&t.cm&&fi(t.cm,r,i),o)}function kn(t,e){for(var i=t.doc.sel.ranges,n=[],r=0;r<i.length;r++){for(var o=e(i[r]);n.length&&ya(o.from,fo(n).to)<=0;){var a=n.pop();if(ya(a.from,o.from)<0){o.from=a.from;break}}n.push(o)}si(t,function(){for(var e=n.length-1;e>=0;e--)pn(t.doc,"",n[e].from,n[e].to,"+delete");yn(t)})}function Cn(t,e,i,n,r){function o(){var e=s+i;return e<t.first||e>=t.first+t.size?d=!1:(s=e,h=Dr(t,e))}function a(t){var e=(r?Uo:jo)(h,l,i,!0);if(null==e){if(t||!o())return d=!1;l=r?(0>i?Bo:Ro)(h):0>i?h.text.length:0}else l=e;return!0}var s=e.line,l=e.ch,c=i,h=Dr(t,s),d=!0;if("char"==n)a();else if("column"==n)a(!0);else if("word"==n||"group"==n)for(var u=null,p="group"==n,f=t.cm&&t.cm.getHelper(e,"wordChars"),g=!0;!(0>i)||a(!g);g=!1){var m=h.text.charAt(l)||"\n",v=xo(m,f)?"w":p&&"\n"==m?"n":!p||/\s/.test(m)?null:"p";if(!p||g||v||(v="s"),u&&u!=v){0>i&&(i=1,a());break}if(v&&(u=v),i>0&&!a(!g))break}var b=fe(t,ba(s,l),c,!0);return d||(b.hitSide=!0),b}function Tn(t,e,i,n){var r,o=t.doc,a=e.left;if("page"==n){var s=Math.min(t.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);r=e.top+i*(s-(0>i?1.5:.5)*Ke(t.display))}else"line"==n&&(r=i>0?e.bottom+3:e.top-3);for(;;){var l=Ue(t,a,r);if(!l.outside)break;if(0>i?0>=r:r>=o.height){l.hitSide=!0;break}r+=5*i}return l}function Sn(e,i,n,r){t.defaults[e]=i,n&&(Ea[e]=r?function(t,e,i){i!=Ha&&n(t,e,i)}:n)}function Ln(t){for(var e,i,n,r,o=t.split(/-(?!$)/),t=o[o.length-1],a=0;a<o.length-1;a++){var s=o[a];if(/^(cmd|meta|m)$/i.test(s))r=!0;else if(/^a(lt)?$/i.test(s))e=!0;else if(/^(c|ctrl|control)$/i.test(s))i=!0;else{if(!/^s(hift)$/i.test(s))throw new Error("Unrecognized modifier name: "+s);n=!0}}return e&&(t="Alt-"+t),i&&(t="Ctrl-"+t),r&&(t="Cmd-"+t),n&&(t="Shift-"+t),t}function Mn(t){return"string"==typeof t?Ga[t]:t}function An(t,e,i,n,r){if(n&&n.shared)return $n(t,e,i,n,r);if(t.cm&&!t.cm.curOp)return li(t.cm,An)(t,e,i,n,r);var o=new ja(t,r),a=ya(e,i);if(n&&bo(n,o,!1),a>0||0==a&&o.clearWhenEmpty!==!1)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=ko("span",[o.replacedWith],"CodeMirror-widget"),n.handleMouseEvents||(o.widgetNode.ignoreEvents=!0),n.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(Jn(t,e.line,e,i,o)||e.line!=i.line&&Jn(t,i.line,e,i,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");va=!0}o.addToHistory&&Gr(t,{from:e,to:i,origin:"markText"},t.sel,0/0);var s,l=e.line,c=t.cm;if(t.iter(l,i.line+1,function(t){c&&o.collapsed&&!c.options.lineWrapping&&Qn(t)==c.display.maxLine&&(s=!0),o.collapsed&&l!=e.line&&Hr(t,0),In(t,new En(o,l==e.line?e.ch:null,l==i.line?i.ch:null)),++l}),o.collapsed&&t.iter(e.line,i.line+1,function(e){nr(t,e)&&Hr(e,0)}),o.clearOnEnter&&cs(o,"beforeCursorEnter",function(){o.clear()}),o.readOnly&&(ma=!0,(t.history.done.length||t.history.undone.length)&&t.clearHistory()),o.collapsed&&(o.id=++Ka,o.atomic=!0),c){if(s&&(c.curOp.updateMaxLine=!0),o.collapsed)pi(c,e.line,i.line+1);else if(o.className||o.title||o.startStyle||o.endStyle)for(var h=e.line;h<=i.line;h++)fi(c,h,"text");o.atomic&&ue(c.doc),ro(c,"markerAdded",c,o)}return o}function $n(t,e,i,n,r){n=bo(n),n.shared=!1;var o=[An(t,e,i,n,r)],a=o[0],s=n.widgetNode;return $r(t,function(t){s&&(n.widgetNode=s.cloneNode(!0)),o.push(An(t,J(t,e),J(t,i),n,r));for(var l=0;l<t.linked.length;++l)if(t.linked[l].isParent)return;a=fo(o)}),new Za(o,a)}function Pn(t){return t.findMarks(ba(t.first,0),t.clipPos(ba(t.lastLine())),function(t){return t.parent})}function Dn(t,e){for(var i=0;i<e.length;i++){var n=e[i],r=n.find(),o=t.clipPos(r.from),a=t.clipPos(r.to);if(ya(o,a)){var s=An(t,o,a,n.primary,n.primary.type);n.markers.push(s),s.parent=n}}}function On(t){for(var e=0;e<t.length;e++){var i=t[e],n=[i.primary.doc];$r(i.primary.doc,function(t){n.push(t)});for(var r=0;r<i.markers.length;r++){var o=i.markers[r];-1==go(n,o.doc)&&(o.parent=null,i.markers.splice(r--,1))}}}function En(t,e,i){this.marker=t,this.from=e,this.to=i}function Hn(t,e){if(t)for(var i=0;i<t.length;++i){var n=t[i];if(n.marker==e)return n}}function zn(t,e){for(var i,n=0;n<t.length;++n)t[n]!=e&&(i||(i=[])).push(t[n]);return i}function In(t,e){t.markedSpans=t.markedSpans?t.markedSpans.concat([e]):[e],e.marker.attachLine(t)}function Wn(t,e,i){if(t)for(var n,r=0;r<t.length;++r){var o=t[r],a=o.marker,s=null==o.from||(a.inclusiveLeft?o.from<=e:o.from<e);if(s||o.from==e&&"bookmark"==a.type&&(!i||!o.marker.insertLeft)){var l=null==o.to||(a.inclusiveRight?o.to>=e:o.to>e);(n||(n=[])).push(new En(a,o.from,l?null:o.to))}}return n}function Nn(t,e,i){if(t)for(var n,r=0;r<t.length;++r){var o=t[r],a=o.marker,s=null==o.to||(a.inclusiveRight?o.to>=e:o.to>e);if(s||o.from==e&&"bookmark"==a.type&&(!i||o.marker.insertLeft)){var l=null==o.from||(a.inclusiveLeft?o.from<=e:o.from<e);(n||(n=[])).push(new En(a,l?null:o.from-e,null==o.to?null:o.to-e))}}return n}function Rn(t,e){var i=te(t,e.from.line)&&Dr(t,e.from.line).markedSpans,n=te(t,e.to.line)&&Dr(t,e.to.line).markedSpans;if(!i&&!n)return null;var r=e.from.ch,o=e.to.ch,a=0==ya(e.from,e.to),s=Wn(i,r,a),l=Nn(n,o,a),c=1==e.text.length,h=fo(e.text).length+(c?r:0);if(s)for(var d=0;d<s.length;++d){var u=s[d];if(null==u.to){var p=Hn(l,u.marker);p?c&&(u.to=null==p.to?null:p.to+h):u.to=r}}if(l)for(var d=0;d<l.length;++d){var u=l[d];if(null!=u.to&&(u.to+=h),null==u.from){var p=Hn(s,u.marker);p||(u.from=h,c&&(s||(s=[])).push(u))}else u.from+=h,c&&(s||(s=[])).push(u)}s&&(s=Bn(s)),l&&l!=s&&(l=Bn(l));var f=[s];if(!c){var g,m=e.text.length-2;if(m>0&&s)for(var d=0;d<s.length;++d)null==s[d].to&&(g||(g=[])).push(new En(s[d].marker,null,null));for(var d=0;m>d;++d)f.push(g);f.push(l)}return f}function Bn(t){for(var e=0;e<t.length;++e){var i=t[e];null!=i.from&&i.from==i.to&&i.marker.clearWhenEmpty!==!1&&t.splice(e--,1)}return t.length?t:null}function Fn(t,e){var i=Kr(t,e),n=Rn(t,e);if(!i)return n;if(!n)return i;for(var r=0;r<i.length;++r){var o=i[r],a=n[r];if(o&&a)t:for(var s=0;s<a.length;++s){for(var l=a[s],c=0;c<o.length;++c)if(o[c].marker==l.marker)continue t;o.push(l)}else a&&(i[r]=a)}return i}function qn(t,e,i){var n=null;if(t.iter(e.line,i.line+1,function(t){if(t.markedSpans)for(var e=0;e<t.markedSpans.length;++e){var i=t.markedSpans[e].marker;!i.readOnly||n&&-1!=go(n,i)||(n||(n=[])).push(i)}}),!n)return null;for(var r=[{from:e,to:i}],o=0;o<n.length;++o)for(var a=n[o],s=a.find(0),l=0;l<r.length;++l){var c=r[l];if(!(ya(c.to,s.from)<0||ya(c.from,s.to)>0)){var h=[l,1],d=ya(c.from,s.from),u=ya(c.to,s.to);(0>d||!a.inclusiveLeft&&!d)&&h.push({from:c.from,to:s.from}),(u>0||!a.inclusiveRight&&!u)&&h.push({from:s.to,to:c.to}),r.splice.apply(r,h),l+=h.length-1}}return r}function Gn(t){var e=t.markedSpans;if(e){for(var i=0;i<e.length;++i)e[i].marker.detachLine(t);t.markedSpans=null}}function Xn(t,e){if(e){for(var i=0;i<e.length;++i)e[i].marker.attachLine(t);t.markedSpans=e}}function Yn(t){return t.inclusiveLeft?-1:0}function Vn(t){return t.inclusiveRight?1:0}function Un(t,e){var i=t.lines.length-e.lines.length;if(0!=i)return i;var n=t.find(),r=e.find(),o=ya(n.from,r.from)||Yn(t)-Yn(e);if(o)return-o;var a=ya(n.to,r.to)||Vn(t)-Vn(e);return a?a:e.id-t.id}function jn(t,e){var i,n=va&&t.markedSpans;if(n)for(var r,o=0;o<n.length;++o)r=n[o],r.marker.collapsed&&null==(e?r.from:r.to)&&(!i||Un(i,r.marker)<0)&&(i=r.marker);return i}function Kn(t){return jn(t,!0)}function Zn(t){return jn(t,!1)}function Jn(t,e,i,n,r){var o=Dr(t,e),a=va&&o.markedSpans;if(a)for(var s=0;s<a.length;++s){var l=a[s];if(l.marker.collapsed){var c=l.marker.find(0),h=ya(c.from,i)||Yn(l.marker)-Yn(r),d=ya(c.to,n)||Vn(l.marker)-Vn(r);if(!(h>=0&&0>=d||0>=h&&d>=0)&&(0>=h&&(ya(c.to,i)>0||l.marker.inclusiveRight&&r.inclusiveLeft)||h>=0&&(ya(c.from,n)<0||l.marker.inclusiveLeft&&r.inclusiveRight)))return!0}}}function Qn(t){for(var e;e=Kn(t);)t=e.find(-1,!0).line;return t}function tr(t){for(var e,i;e=Zn(t);)t=e.find(1,!0).line,(i||(i=[])).push(t);return i}function er(t,e){var i=Dr(t,e),n=Qn(i);return i==n?e:zr(n)}function ir(t,e){if(e>t.lastLine())return e;var i,n=Dr(t,e);if(!nr(t,n))return e;for(;i=Zn(n);)n=i.find(1,!0).line;return zr(n)+1}function nr(t,e){var i=va&&e.markedSpans;if(i)for(var n,r=0;r<i.length;++r)if(n=i[r],n.marker.collapsed){if(null==n.from)return!0;if(!n.marker.widgetNode&&0==n.from&&n.marker.inclusiveLeft&&rr(t,e,n))return!0}}function rr(t,e,i){if(null==i.to){var n=i.marker.find(1,!0);return rr(t,n.line,Hn(n.line.markedSpans,i.marker))}if(i.marker.inclusiveRight&&i.to==e.text.length)return!0;for(var r,o=0;o<e.markedSpans.length;++o)if(r=e.markedSpans[o],r.marker.collapsed&&!r.marker.widgetNode&&r.from==i.to&&(null==r.to||r.to!=i.from)&&(r.marker.inclusiveLeft||i.marker.inclusiveRight)&&rr(t,e,r))return!0}function or(t,e,i){Wr(e)<(t.curOp&&t.curOp.scrollTop||t.doc.scrollTop)&&bn(t,null,i)}function ar(t){if(null!=t.height)return t.height;if(!So(document.body,t.node)){var e="position: relative;";t.coverGutter&&(e+="margin-left: -"+t.cm.getGutterElement().offsetWidth+"px;"),To(t.cm.display.measure,ko("div",[t.node],null,e))}return t.height=t.node.offsetHeight}function sr(t,e,i,n){var r=new Ja(t,i,n);return r.noHScroll&&(t.display.alignWidgets=!0),wn(t.doc,e,"widget",function(e){var i=e.widgets||(e.widgets=[]);if(null==r.insertAt?i.push(r):i.splice(Math.min(i.length-1,Math.max(0,r.insertAt)),0,r),r.line=e,!nr(t.doc,e)){var n=Wr(e)<t.doc.scrollTop;Hr(e,e.height+ar(r)),n&&bn(t,null,r.height),t.curOp.forceUpdate=!0}return!0}),r}function lr(t,e,i,n){t.text=e,t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null),null!=t.order&&(t.order=null),Gn(t),Xn(t,i);var r=n?n(t):1;r!=t.height&&Hr(t,r)}function cr(t){t.parent=null,Gn(t)}function hr(t,e){if(t)for(;;){var i=t.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!i)break;t=t.slice(0,i.index)+t.slice(i.index+i[0].length);var n=i[1]?"bgClass":"textClass";null==e[n]?e[n]=i[2]:new RegExp("(?:^|s)"+i[2]+"(?:$|s)").test(e[n])||(e[n]+=" "+i[2])}return t}function dr(e,i){if(e.blankLine)return e.blankLine(i);if(e.innerMode){var n=t.innerMode(e,i);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function ur(e,i,n,r){for(var o=0;10>o;o++){r&&(r[0]=t.innerMode(e,n).mode);var a=e.token(i,n);if(i.pos>i.start)return a}throw new Error("Mode "+e.name+" failed to advance stream.")}function pr(t,e,i,n){function r(t){return{start:d.start,end:d.pos,string:d.current(),type:o||null,state:t?Ba(a.mode,h):h}}var o,a=t.doc,s=a.mode;e=J(a,e);var l,c=Dr(a,e.line),h=Ce(t,e.line,i),d=new Ua(c.text,t.options.tabSize);for(n&&(l=[]);(n||d.pos<e.ch)&&!d.eol();)d.start=d.pos,o=ur(s,d,h),n&&l.push(r(!0));return n?l:r()}function fr(t,e,i,n,r,o,a){var s=i.flattenSpans;null==s&&(s=t.options.flattenSpans);var l,c=0,h=null,d=new Ua(e,t.options.tabSize),u=t.options.addModeClass&&[null];for(""==e&&hr(dr(i,n),o);!d.eol();){if(d.pos>t.options.maxHighlightLength?(s=!1,a&&vr(t,e,n,d.pos),d.pos=e.length,l=null):l=hr(ur(i,d,n,u),o),u){var p=u[0].name;p&&(l="m-"+(l?p+" "+l:p))}s&&h==l||(c<d.start&&r(d.start,h),c=d.start,h=l),d.start=d.pos
}for(;c<d.pos;){var f=Math.min(d.pos,c+5e4);r(f,h),c=f}}function gr(t,e,i,n){var r=[t.state.modeGen],o={};fr(t,e.text,t.doc.mode,i,function(t,e){r.push(t,e)},o,n);for(var a=0;a<t.state.overlays.length;++a){var s=t.state.overlays[a],l=1,c=0;fr(t,e.text,s.mode,!0,function(t,e){for(var i=l;t>c;){var n=r[l];n>t&&r.splice(l,1,t,r[l+1],n),l+=2,c=Math.min(t,n)}if(e)if(s.opaque)r.splice(i,l-i,t,"cm-overlay "+e),l=i+2;else for(;l>i;i+=2){var o=r[i+1];r[i+1]=(o?o+" ":"")+"cm-overlay "+e}},o)}return{styles:r,classes:o.bgClass||o.textClass?o:null}}function mr(t,e,i){if(!e.styles||e.styles[0]!=t.state.modeGen){var n=gr(t,e,e.stateAfter=Ce(t,zr(e)));e.styles=n.styles,n.classes?e.styleClasses=n.classes:e.styleClasses&&(e.styleClasses=null),i===t.doc.frontier&&t.doc.frontier++}return e.styles}function vr(t,e,i,n){var r=t.doc.mode,o=new Ua(e,t.options.tabSize);for(o.start=o.pos=n||0,""==e&&dr(r,i);!o.eol()&&o.pos<=t.options.maxHighlightLength;)ur(r,o,i),o.start=o.pos}function br(t,e){if(!t||/^\s*$/.test(t))return null;var i=e.addModeClass?es:ts;return i[t]||(i[t]=t.replace(/\S+/g,"cm-$&"))}function yr(t,e){var i=ko("span",null,null,ea?"padding-right: .1px":null),n={pre:ko("pre",[i]),content:i,col:0,pos:0,cm:t};e.measure={};for(var r=0;r<=(e.rest?e.rest.length:0);r++){var o,a=r?e.rest[r-1]:e.line;n.pos=0,n.addToken=_r,(Qo||ea)&&t.getOption("lineWrapping")&&(n.addToken=wr(n.addToken)),Ho(t.display.measure)&&(o=Nr(a))&&(n.addToken=kr(n.addToken,o)),n.map=[];var s=e!=t.display.externalMeasured&&zr(a);Tr(a,n,mr(t,a,s)),a.styleClasses&&(a.styleClasses.bgClass&&(n.bgClass=Ao(a.styleClasses.bgClass,n.bgClass||"")),a.styleClasses.textClass&&(n.textClass=Ao(a.styleClasses.textClass,n.textClass||""))),0==n.map.length&&n.map.push(0,0,n.content.appendChild(Eo(t.display.measure))),0==r?(e.measure.map=n.map,e.measure.cache={}):((e.measure.maps||(e.measure.maps=[])).push(n.map),(e.measure.caches||(e.measure.caches=[])).push({}))}return ea&&/\bcm-tab\b/.test(n.content.lastChild.className)&&(n.content.className="cm-tab-wrap-hack"),ds(t,"renderLine",t,e.line,n.pre),n.pre.className&&(n.textClass=Ao(n.pre.className,n.textClass||"")),n}function xr(t){var e=ko("span","â€¢","cm-invalidchar");return e.title="\\u"+t.charCodeAt(0).toString(16),e}function _r(t,e,i,n,r,o){if(e){var a=t.cm.options.specialChars,s=!1;if(a.test(e))for(var l=document.createDocumentFragment(),c=0;;){a.lastIndex=c;var h=a.exec(e),d=h?h.index-c:e.length-c;if(d){var u=document.createTextNode(e.slice(c,c+d));Qo&&9>ta?l.appendChild(ko("span",[u])):l.appendChild(u),t.map.push(t.pos,t.pos+d,u),t.col+=d,t.pos+=d}if(!h)break;if(c+=d+1,"	"==h[0]){var p=t.cm.options.tabSize,f=p-t.col%p,u=l.appendChild(ko("span",po(f),"cm-tab"));t.col+=f}else{var u=t.cm.options.specialCharPlaceholder(h[0]);Qo&&9>ta?l.appendChild(ko("span",[u])):l.appendChild(u),t.col+=1}t.map.push(t.pos,t.pos+1,u),t.pos++}else{t.col+=e.length;var l=document.createTextNode(e);t.map.push(t.pos,t.pos+e.length,l),Qo&&9>ta&&(s=!0),t.pos+=e.length}if(i||n||r||s){var g=i||"";n&&(g+=n),r&&(g+=r);var m=ko("span",[l],g);return o&&(m.title=o),t.content.appendChild(m)}t.content.appendChild(l)}}function wr(t){function e(t){for(var e=" ",i=0;i<t.length-2;++i)e+=i%2?" ":"Â ";return e+=" "}return function(i,n,r,o,a,s){t(i,n.replace(/ {3,}/g,e),r,o,a,s)}}function kr(t,e){return function(i,n,r,o,a,s){r=r?r+" cm-force-border":"cm-force-border";for(var l=i.pos,c=l+n.length;;){for(var h=0;h<e.length;h++){var d=e[h];if(d.to>l&&d.from<=l)break}if(d.to>=c)return t(i,n,r,o,a,s);t(i,n.slice(0,d.to-l),r,o,null,s),o=null,n=n.slice(d.to-l),l=d.to}}}function Cr(t,e,i,n){var r=!n&&i.widgetNode;r&&(t.map.push(t.pos,t.pos+e,r),t.content.appendChild(r)),t.pos+=e}function Tr(t,e,i){var n=t.markedSpans,r=t.text,o=0;if(n)for(var a,s,l,c,h,d,u=r.length,p=0,f=1,g="",m=0;;){if(m==p){s=l=c=h="",d=null,m=1/0;for(var v=[],b=0;b<n.length;++b){var y=n[b],x=y.marker;y.from<=p&&(null==y.to||y.to>p)?(null!=y.to&&m>y.to&&(m=y.to,l=""),x.className&&(s+=" "+x.className),x.startStyle&&y.from==p&&(c+=" "+x.startStyle),x.endStyle&&y.to==m&&(l+=" "+x.endStyle),x.title&&!h&&(h=x.title),x.collapsed&&(!d||Un(d.marker,x)<0)&&(d=y)):y.from>p&&m>y.from&&(m=y.from),"bookmark"==x.type&&y.from==p&&x.widgetNode&&v.push(x)}if(d&&(d.from||0)==p&&(Cr(e,(null==d.to?u+1:d.to)-p,d.marker,null==d.from),null==d.to))return;if(!d&&v.length)for(var b=0;b<v.length;++b)Cr(e,0,v[b])}if(p>=u)break;for(var _=Math.min(u,m);;){if(g){var w=p+g.length;if(!d){var k=w>_?g.slice(0,_-p):g;e.addToken(e,k,a?a+s:s,c,p+k.length==m?l:"",h)}if(w>=_){g=g.slice(_-p),p=_;break}p=w,c=""}g=r.slice(o,o=i[f++]),a=br(i[f++],e.cm.options)}}else for(var f=1;f<i.length;f+=2)e.addToken(e,r.slice(o,o=i[f]),br(i[f+1],e.cm.options))}function Sr(t,e){return 0==e.from.ch&&0==e.to.ch&&""==fo(e.text)&&(!t.cm||t.cm.options.wholeLineUpdateBefore)}function Lr(t,e,i,n){function r(t){return i?i[t]:null}function o(t,i,r){lr(t,i,r,n),ro(t,"change",t,e)}var a=e.from,s=e.to,l=e.text,c=Dr(t,a.line),h=Dr(t,s.line),d=fo(l),u=r(l.length-1),p=s.line-a.line;if(Sr(t,e)){for(var f=0,g=[];f<l.length-1;++f)g.push(new Qa(l[f],r(f),n));o(h,h.text,u),p&&t.remove(a.line,p),g.length&&t.insert(a.line,g)}else if(c==h)if(1==l.length)o(c,c.text.slice(0,a.ch)+d+c.text.slice(s.ch),u);else{for(var g=[],f=1;f<l.length-1;++f)g.push(new Qa(l[f],r(f),n));g.push(new Qa(d+c.text.slice(s.ch),u,n)),o(c,c.text.slice(0,a.ch)+l[0],r(0)),t.insert(a.line+1,g)}else if(1==l.length)o(c,c.text.slice(0,a.ch)+l[0]+h.text.slice(s.ch),r(0)),t.remove(a.line+1,p);else{o(c,c.text.slice(0,a.ch)+l[0],r(0)),o(h,d+h.text.slice(s.ch),u);for(var f=1,g=[];f<l.length-1;++f)g.push(new Qa(l[f],r(f),n));p>1&&t.remove(a.line+1,p-1),t.insert(a.line+1,g)}ro(t,"change",t,e)}function Mr(t){this.lines=t,this.parent=null;for(var e=0,i=0;e<t.length;++e)t[e].parent=this,i+=t[e].height;this.height=i}function Ar(t){this.children=t;for(var e=0,i=0,n=0;n<t.length;++n){var r=t[n];e+=r.chunkSize(),i+=r.height,r.parent=this}this.size=e,this.height=i,this.parent=null}function $r(t,e,i){function n(t,r,o){if(t.linked)for(var a=0;a<t.linked.length;++a){var s=t.linked[a];if(s.doc!=r){var l=o&&s.sharedHist;(!i||l)&&(e(s.doc,l),n(s.doc,t,l))}}}n(t,null,!0)}function Pr(t,e){if(e.cm)throw new Error("This document is already in use.");t.doc=e,e.cm=t,a(t),i(t),t.options.lineWrapping||u(t),t.options.mode=e.modeOption,pi(t)}function Dr(t,e){if(e-=t.first,0>e||e>=t.size)throw new Error("There is no line "+(e+t.first)+" in the document.");for(var i=t;!i.lines;)for(var n=0;;++n){var r=i.children[n],o=r.chunkSize();if(o>e){i=r;break}e-=o}return i.lines[e]}function Or(t,e,i){var n=[],r=e.line;return t.iter(e.line,i.line+1,function(t){var o=t.text;r==i.line&&(o=o.slice(0,i.ch)),r==e.line&&(o=o.slice(e.ch)),n.push(o),++r}),n}function Er(t,e,i){var n=[];return t.iter(e,i,function(t){n.push(t.text)}),n}function Hr(t,e){var i=e-t.height;if(i)for(var n=t;n;n=n.parent)n.height+=i}function zr(t){if(null==t.parent)return null;for(var e=t.parent,i=go(e.lines,t),n=e.parent;n;e=n,n=n.parent)for(var r=0;n.children[r]!=e;++r)i+=n.children[r].chunkSize();return i+e.first}function Ir(t,e){var i=t.first;t:do{for(var n=0;n<t.children.length;++n){var r=t.children[n],o=r.height;if(o>e){t=r;continue t}e-=o,i+=r.chunkSize()}return i}while(!t.lines);for(var n=0;n<t.lines.length;++n){var a=t.lines[n],s=a.height;if(s>e)break;e-=s}return i+n}function Wr(t){t=Qn(t);for(var e=0,i=t.parent,n=0;n<i.lines.length;++n){var r=i.lines[n];if(r==t)break;e+=r.height}for(var o=i.parent;o;i=o,o=i.parent)for(var n=0;n<o.children.length;++n){var a=o.children[n];if(a==i)break;e+=a.height}return e}function Nr(t){var e=t.order;return null==e&&(e=t.order=Ws(t.text)),e}function Rr(t){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=t||1}function Br(t,e){var i={from:G(e.from),to:Da(e),text:Or(t,e.from,e.to)};return Ur(t,i,e.from.line,e.to.line+1),$r(t,function(t){Ur(t,i,e.from.line,e.to.line+1)},!0),i}function Fr(t){for(;t.length;){var e=fo(t);if(!e.ranges)break;t.pop()}}function qr(t,e){return e?(Fr(t.done),fo(t.done)):t.done.length&&!fo(t.done).ranges?fo(t.done):t.done.length>1&&!t.done[t.done.length-2].ranges?(t.done.pop(),fo(t.done)):void 0}function Gr(t,e,i,n){var r=t.history;r.undone.length=0;var o,a=+new Date;if((r.lastOp==n||r.lastOrigin==e.origin&&e.origin&&("+"==e.origin.charAt(0)&&t.cm&&r.lastModTime>a-t.cm.options.historyEventDelay||"*"==e.origin.charAt(0)))&&(o=qr(r,r.lastOp==n))){var s=fo(o.changes);0==ya(e.from,e.to)&&0==ya(e.from,s.to)?s.to=Da(e):o.changes.push(Br(t,e))}else{var l=fo(r.done);for(l&&l.ranges||Vr(t.sel,r.done),o={changes:[Br(t,e)],generation:r.generation},r.done.push(o);r.done.length>r.undoDepth;)r.done.shift(),r.done[0].ranges||r.done.shift()}r.done.push(i),r.generation=++r.maxGeneration,r.lastModTime=r.lastSelTime=a,r.lastOp=r.lastSelOp=n,r.lastOrigin=r.lastSelOrigin=e.origin,s||ds(t,"historyAdded")}function Xr(t,e,i,n){var r=e.charAt(0);return"*"==r||"+"==r&&i.ranges.length==n.ranges.length&&i.somethingSelected()==n.somethingSelected()&&new Date-t.history.lastSelTime<=(t.cm?t.cm.options.historyEventDelay:500)}function Yr(t,e,i,n){var r=t.history,o=n&&n.origin;i==r.lastSelOp||o&&r.lastSelOrigin==o&&(r.lastModTime==r.lastSelTime&&r.lastOrigin==o||Xr(t,o,fo(r.done),e))?r.done[r.done.length-1]=e:Vr(e,r.done),r.lastSelTime=+new Date,r.lastSelOrigin=o,r.lastSelOp=i,n&&n.clearRedo!==!1&&Fr(r.undone)}function Vr(t,e){var i=fo(e);i&&i.ranges&&i.equals(t)||e.push(t)}function Ur(t,e,i,n){var r=e["spans_"+t.id],o=0;t.iter(Math.max(t.first,i),Math.min(t.first+t.size,n),function(i){i.markedSpans&&((r||(r=e["spans_"+t.id]={}))[o]=i.markedSpans),++o})}function jr(t){if(!t)return null;for(var e,i=0;i<t.length;++i)t[i].marker.explicitlyCleared?e||(e=t.slice(0,i)):e&&e.push(t[i]);return e?e.length?e:null:t}function Kr(t,e){var i=e["spans_"+t.id];if(!i)return null;for(var n=0,r=[];n<e.text.length;++n)r.push(jr(i[n]));return r}function Zr(t,e,i){for(var n=0,r=[];n<t.length;++n){var o=t[n];if(o.ranges)r.push(i?V.prototype.deepCopy.call(o):o);else{var a=o.changes,s=[];r.push({changes:s});for(var l=0;l<a.length;++l){var c,h=a[l];if(s.push({from:h.from,to:h.to,text:h.text}),e)for(var d in h)(c=d.match(/^spans_(\d+)$/))&&go(e,Number(c[1]))>-1&&(fo(s)[d]=h[d],delete h[d])}}}return r}function Jr(t,e,i,n){i<t.line?t.line+=n:e<t.line&&(t.line=e,t.ch=0)}function Qr(t,e,i,n){for(var r=0;r<t.length;++r){var o=t[r],a=!0;if(o.ranges){o.copied||(o=t[r]=o.deepCopy(),o.copied=!0);for(var s=0;s<o.ranges.length;s++)Jr(o.ranges[s].anchor,e,i,n),Jr(o.ranges[s].head,e,i,n)}else{for(var s=0;s<o.changes.length;++s){var l=o.changes[s];if(i<l.from.line)l.from=ba(l.from.line+n,l.from.ch),l.to=ba(l.to.line+n,l.to.ch);else if(e<=l.to.line){a=!1;break}}a||(t.splice(0,r+1),r=0)}}}function to(t,e){var i=e.from.line,n=e.to.line,r=e.text.length-(n-i)-1;Qr(t.done,i,n,r),Qr(t.undone,i,n,r)}function eo(t){return null!=t.defaultPrevented?t.defaultPrevented:0==t.returnValue}function io(t){return t.target||t.srcElement}function no(t){var e=t.which;return null==e&&(1&t.button?e=1:2&t.button?e=3:4&t.button&&(e=2)),da&&t.ctrlKey&&1==e&&(e=3),e}function ro(t,e){function i(t){return function(){t.apply(null,o)}}var n=t._handlers&&t._handlers[e];if(n){var r,o=Array.prototype.slice.call(arguments,2);Ca?r=Ca.delayedCallbacks:us?r=us:(r=us=[],setTimeout(oo,0));for(var a=0;a<n.length;++a)r.push(i(n[a]))}}function oo(){var t=us;us=null;for(var e=0;e<t.length;++e)t[e]()}function ao(t,e,i){return"string"==typeof e&&(e={type:e,preventDefault:function(){this.defaultPrevented=!0}}),ds(t,i||e.type,t,e),eo(e)||e.codemirrorIgnore}function so(t){var e=t._handlers&&t._handlers.cursorActivity;if(e)for(var i=t.curOp.cursorActivityHandlers||(t.curOp.cursorActivityHandlers=[]),n=0;n<e.length;++n)-1==go(i,e[n])&&i.push(e[n])}function lo(t,e){var i=t._handlers&&t._handlers[e];return i&&i.length>0}function co(t){t.prototype.on=function(t,e){cs(this,t,e)},t.prototype.off=function(t,e){hs(this,t,e)}}function ho(){this.id=null}function uo(t,e,i){for(var n=0,r=0;;){var o=t.indexOf("	",n);-1==o&&(o=t.length);var a=o-n;if(o==t.length||r+a>=e)return n+Math.min(a,e-r);if(r+=o-n,r+=i-r%i,n=o+1,r>=e)return n}}function po(t){for(;ys.length<=t;)ys.push(fo(ys)+" ");return ys[t]}function fo(t){return t[t.length-1]}function go(t,e){for(var i=0;i<t.length;++i)if(t[i]==e)return i;return-1}function mo(t,e){for(var i=[],n=0;n<t.length;n++)i[n]=e(t[n],n);return i}function vo(t,e){var i;if(Object.create)i=Object.create(t);else{var n=function(){};n.prototype=t,i=new n}return e&&bo(e,i),i}function bo(t,e,i){e||(e={});for(var n in t)!t.hasOwnProperty(n)||i===!1&&e.hasOwnProperty(n)||(e[n]=t[n]);return e}function yo(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e)}}function xo(t,e){return e?e.source.indexOf("\\w")>-1&&ks(t)?!0:e.test(t):ks(t)}function _o(t){for(var e in t)if(t.hasOwnProperty(e)&&t[e])return!1;return!0}function wo(t){return t.charCodeAt(0)>=768&&Cs.test(t)}function ko(t,e,i,n){var r=document.createElement(t);if(i&&(r.className=i),n&&(r.style.cssText=n),"string"==typeof e)r.appendChild(document.createTextNode(e));else if(e)for(var o=0;o<e.length;++o)r.appendChild(e[o]);return r}function Co(t){for(var e=t.childNodes.length;e>0;--e)t.removeChild(t.firstChild);return t}function To(t,e){return Co(t).appendChild(e)}function So(t,e){if(t.contains)return t.contains(e);for(;e=e.parentNode;)if(e==t)return!0}function Lo(){return document.activeElement}function Mo(t){return new RegExp("(^|\\s)"+t+"(?:$|\\s)\\s*")}function Ao(t,e){for(var i=t.split(" "),n=0;n<i.length;n++)i[n]&&!Mo(i[n]).test(e)&&(e+=" "+i[n]);return e}function $o(t){if(document.body.getElementsByClassName)for(var e=document.body.getElementsByClassName("CodeMirror"),i=0;i<e.length;i++){var n=e[i].CodeMirror;n&&t(n)}}function Po(){$s||(Do(),$s=!0)}function Do(){var t;cs(window,"resize",function(){null==t&&(t=setTimeout(function(){t=null,Ts=null,$o(Mi)},100))}),cs(window,"blur",function(){$o(Ji)})}function Oo(t){if(null!=Ts)return Ts;var e=ko("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return To(t,e),e.offsetWidth&&(Ts=e.offsetHeight-e.clientHeight),Ts||0}function Eo(t){if(null==Ss){var e=ko("span","â€‹");To(t,ko("span",[e,document.createTextNode("x")])),0!=t.firstChild.offsetHeight&&(Ss=e.offsetWidth<=1&&e.offsetHeight>2&&!(Qo&&8>ta))}return Ss?ko("span","â€‹"):ko("span","Â ",null,"display: inline-block; width: 1px; margin-right: -1px")}function Ho(t){if(null!=Ls)return Ls;var e=To(t,document.createTextNode("AØ®A")),i=_s(e,0,1).getBoundingClientRect();if(!i||i.left==i.right)return!1;var n=_s(e,1,2).getBoundingClientRect();return Ls=n.right-i.right<3}function zo(t){if(null!=Hs)return Hs;var e=To(t,ko("span","x")),i=e.getBoundingClientRect(),n=_s(e,0,1).getBoundingClientRect();return Hs=Math.abs(i.left-n.left)>1}function Io(t,e,i,n){if(!t)return n(e,i,"ltr");for(var r=!1,o=0;o<t.length;++o){var a=t[o];(a.from<i&&a.to>e||e==i&&a.to==e)&&(n(Math.max(a.from,e),Math.min(a.to,i),1==a.level?"rtl":"ltr"),r=!0)}r||n(e,i,"ltr")}function Wo(t){return t.level%2?t.to:t.from}function No(t){return t.level%2?t.from:t.to}function Ro(t){var e=Nr(t);return e?Wo(e[0]):0}function Bo(t){var e=Nr(t);return e?No(fo(e)):t.text.length}function Fo(t,e){var i=Dr(t.doc,e),n=Qn(i);n!=i&&(e=zr(n));var r=Nr(n),o=r?r[0].level%2?Bo(n):Ro(n):0;return ba(e,o)}function qo(t,e){for(var i,n=Dr(t.doc,e);i=Zn(n);)n=i.find(1,!0).line,e=null;var r=Nr(n),o=r?r[0].level%2?Ro(n):Bo(n):n.text.length;return ba(null==e?zr(n):e,o)}function Go(t,e){var i=Fo(t,e.line),n=Dr(t.doc,i.line),r=Nr(n);if(!r||0==r[0].level){var o=Math.max(0,n.text.search(/\S/)),a=e.line==i.line&&e.ch<=o&&e.ch;return ba(i.line,a?0:o)}return i}function Xo(t,e,i){var n=t[0].level;return e==n?!0:i==n?!1:i>e}function Yo(t,e){Is=null;for(var i,n=0;n<t.length;++n){var r=t[n];if(r.from<e&&r.to>e)return n;if(r.from==e||r.to==e){if(null!=i)return Xo(t,r.level,t[i].level)?(r.from!=r.to&&(Is=i),n):(r.from!=r.to&&(Is=n),i);i=n}}return i}function Vo(t,e,i,n){if(!n)return e+i;do e+=i;while(e>0&&wo(t.text.charAt(e)));return e}function Uo(t,e,i,n){var r=Nr(t);if(!r)return jo(t,e,i,n);for(var o=Yo(r,e),a=r[o],s=Vo(t,e,a.level%2?-i:i,n);;){if(s>a.from&&s<a.to)return s;if(s==a.from||s==a.to)return Yo(r,s)==o?s:(a=r[o+=i],i>0==a.level%2?a.to:a.from);if(a=r[o+=i],!a)return null;s=i>0==a.level%2?Vo(t,a.to,-1,n):Vo(t,a.from,1,n)}}function jo(t,e,i,n){var r=e+i;if(n)for(;r>0&&wo(t.text.charAt(r));)r+=i;return 0>r||r>t.text.length?null:r}var Ko=/gecko\/\d/i.test(navigator.userAgent),Zo=/MSIE \d/.test(navigator.userAgent),Jo=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Qo=Zo||Jo,ta=Qo&&(Zo?document.documentMode||6:Jo[1]),ea=/WebKit\//.test(navigator.userAgent),ia=ea&&/Qt\/\d+\.\d+/.test(navigator.userAgent),na=/Chrome\//.test(navigator.userAgent),ra=/Opera\//.test(navigator.userAgent),oa=/Apple Computer/.test(navigator.vendor),aa=/KHTML\//.test(navigator.userAgent),sa=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),la=/PhantomJS/.test(navigator.userAgent),ca=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),ha=ca||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),da=ca||/Mac/.test(navigator.platform),ua=/win/i.test(navigator.platform),pa=ra&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);pa&&(pa=Number(pa[1])),pa&&pa>=15&&(ra=!1,ea=!0);var fa=da&&(ia||ra&&(null==pa||12.11>pa)),ga=Ko||Qo&&ta>=9,ma=!1,va=!1,ba=t.Pos=function(t,e){return this instanceof ba?(this.line=t,this.ch=e,void 0):new ba(t,e)},ya=t.cmpPos=function(t,e){return t.line-e.line||t.ch-e.ch};V.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(t){if(t==this)return!0;if(t.primIndex!=this.primIndex||t.ranges.length!=this.ranges.length)return!1;for(var e=0;e<this.ranges.length;e++){var i=this.ranges[e],n=t.ranges[e];if(0!=ya(i.anchor,n.anchor)||0!=ya(i.head,n.head))return!1}return!0},deepCopy:function(){for(var t=[],e=0;e<this.ranges.length;e++)t[e]=new U(G(this.ranges[e].anchor),G(this.ranges[e].head));return new V(t,this.primIndex)},somethingSelected:function(){for(var t=0;t<this.ranges.length;t++)if(!this.ranges[t].empty())return!0;return!1},contains:function(t,e){e||(e=t);for(var i=0;i<this.ranges.length;i++){var n=this.ranges[i];if(ya(e,n.from())>=0&&ya(t,n.to())<=0)return i}return-1}},U.prototype={from:function(){return Y(this.anchor,this.head)},to:function(){return X(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var xa,_a,wa,ka={left:0,right:0,top:0,bottom:0},Ca=null,Ta=0,Sa=null,La=0,Ma=0,Aa=null;Qo?Aa=-.53:Ko?Aa=15:na?Aa=-.7:oa&&(Aa=-1/3);var $a=new ho,Pa=null,Da=t.changeEnd=function(t){return t.text?ba(t.from.line+t.text.length-1,fo(t.text).length+(1==t.text.length?t.from.ch:0)):t.to};t.prototype={constructor:t,focus:function(){window.focus(),Ci(this),_i(this)},setOption:function(t,e){var i=this.options,n=i[t];(i[t]!=e||"mode"==t)&&(i[t]=e,Ea.hasOwnProperty(t)&&li(this,Ea[t])(this,e,n))},getOption:function(t){return this.options[t]},getDoc:function(){return this.doc},addKeyMap:function(t,e){this.state.keyMaps[e?"push":"unshift"](Mn(t))},removeKeyMap:function(t){for(var e=this.state.keyMaps,i=0;i<e.length;++i)if(e[i]==t||e[i].name==t)return e.splice(i,1),!0},addOverlay:ci(function(e,i){var n=e.token?e:t.getMode(this.options,e);if(n.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:n,modeSpec:e,opaque:i&&i.opaque}),this.state.modeGen++,pi(this)}),removeOverlay:ci(function(t){for(var e=this.state.overlays,i=0;i<e.length;++i){var n=e[i].modeSpec;if(n==t||"string"==typeof t&&n.name==t)return e.splice(i,1),this.state.modeGen++,pi(this),void 0}}),indentLine:ci(function(t,e,i){"string"!=typeof e&&"number"!=typeof e&&(e=null==e?this.options.smartIndent?"smart":"prev":e?"add":"subtract"),te(this.doc,t)&&_n(this,t,e,i)}),indentSelection:ci(function(t){for(var e=this.doc.sel.ranges,i=-1,n=0;n<e.length;n++){var r=e[n];if(r.empty())r.head.line>i&&(_n(this,r.head.line,t,!0),i=r.head.line,n==this.doc.sel.primIndex&&yn(this));else{var o=r.from(),a=r.to(),s=Math.max(i,o.line);i=Math.min(this.lastLine(),a.line-(a.ch?0:1))+1;for(var l=s;i>l;++l)_n(this,l,t);var c=this.doc.sel.ranges;0==o.ch&&e.length==c.length&&c[n].from().ch>0&&oe(this.doc,n,new U(o,c[n].to()),gs)}}}),getTokenAt:function(t,e){return pr(this,t,e)},getLineTokens:function(t,e){return pr(this,ba(t),e,!0)},getTokenTypeAt:function(t){t=J(this.doc,t);var e,i=mr(this,Dr(this.doc,t.line)),n=0,r=(i.length-1)/2,o=t.ch;if(0==o)e=i[2];else for(;;){var a=n+r>>1;if((a?i[2*a-1]:0)>=o)r=a;else{if(!(i[2*a+1]<o)){e=i[2*a+2];break}n=a+1}}var s=e?e.indexOf("cm-overlay "):-1;return 0>s?e:0==s?null:e.slice(0,s-1)},getModeAt:function(e){var i=this.doc.mode;return i.innerMode?t.innerMode(i,this.getTokenAt(e).state).mode:i},getHelper:function(t,e){return this.getHelpers(t,e)[0]},getHelpers:function(t,e){var i=[];if(!Ra.hasOwnProperty(e))return Ra;var n=Ra[e],r=this.getModeAt(t);if("string"==typeof r[e])n[r[e]]&&i.push(n[r[e]]);else if(r[e])for(var o=0;o<r[e].length;o++){var a=n[r[e][o]];a&&i.push(a)}else r.helperType&&n[r.helperType]?i.push(n[r.helperType]):n[r.name]&&i.push(n[r.name]);for(var o=0;o<n._global.length;o++){var s=n._global[o];s.pred(r,this)&&-1==go(i,s.val)&&i.push(s.val)}return i},getStateAfter:function(t,e){var i=this.doc;return t=Z(i,null==t?i.first+i.size-1:t),Ce(this,t+1,e)},cursorCoords:function(t,e){var i,n=this.doc.sel.primary();return i=null==t?n.head:"object"==typeof t?J(this.doc,t):t?n.from():n.to(),Xe(this,i,e||"page")},charCoords:function(t,e){return Ge(this,J(this.doc,t),e||"page")},coordsChar:function(t,e){return t=qe(this,t,e||"page"),Ue(this,t.left,t.top)},lineAtHeight:function(t,e){return t=qe(this,{top:t,left:0},e||"page").top,Ir(this.doc,t+this.display.viewOffset)},heightAtLine:function(t,e){var i=!1,n=this.doc.first+this.doc.size-1;t<this.doc.first?t=this.doc.first:t>n&&(t=n,i=!0);var r=Dr(this.doc,t);return Fe(this,r,{top:0,left:0},e||"page").top+(i?this.doc.height-Wr(r):0)},defaultTextHeight:function(){return Ke(this.display)},defaultCharWidth:function(){return Ze(this.display)},setGutterMarker:ci(function(t,e,i){return wn(this.doc,t,"gutter",function(t){var n=t.gutterMarkers||(t.gutterMarkers={});return n[e]=i,!i&&_o(n)&&(t.gutterMarkers=null),!0})}),clearGutter:ci(function(t){var e=this,i=e.doc,n=i.first;i.iter(function(i){i.gutterMarkers&&i.gutterMarkers[t]&&(i.gutterMarkers[t]=null,fi(e,n,"gutter"),_o(i.gutterMarkers)&&(i.gutterMarkers=null)),++n})}),setLineProperty:ci(function(t,e,i){return wn(this.doc,t,"gutter",function(t){return t[e]=i,!0})}),addLineWidget:ci(function(t,e,i){return sr(this,t,e,i)}),removeLineWidget:function(t){t.clear()},lineInfo:function(t){if("number"==typeof t){if(!te(this.doc,t))return null;var e=t;if(t=Dr(this.doc,t),!t)return null}else{var e=zr(t);if(null==e)return null}return{line:e,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(t,e,i,n,r){var o=this.display;t=Xe(this,J(this.doc,t));var a=t.bottom,s=t.left;if(e.style.position="absolute",o.sizer.appendChild(e),"over"==n)a=t.top;else if("above"==n||"near"==n){var l=Math.max(o.wrapper.clientHeight,this.doc.height),c=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==n||t.bottom+e.offsetHeight>l)&&t.top>e.offsetHeight?a=t.top-e.offsetHeight:t.bottom+e.offsetHeight<=l&&(a=t.bottom),s+e.offsetWidth>c&&(s=c-e.offsetWidth)}e.style.top=a+"px",e.style.left=e.style.right="","right"==r?(s=o.sizer.clientWidth-e.offsetWidth,e.style.right="0px"):("left"==r?s=0:"middle"==r&&(s=(o.sizer.clientWidth-e.offsetWidth)/2),e.style.left=s+"px"),i&&mn(this,s,a,s+e.offsetWidth,a+e.offsetHeight)},triggerOnKeyDown:ci(Vi),triggerOnKeyPress:ci(Ki),triggerOnKeyUp:ji,execCommand:function(t){return qa.hasOwnProperty(t)?qa[t](this):void 0},findPosH:function(t,e,i,n){var r=1;0>e&&(r=-1,e=-e);for(var o=0,a=J(this.doc,t);e>o&&(a=Cn(this.doc,a,r,i,n),!a.hitSide);++o);return a},moveH:ci(function(t,e){var i=this;i.extendSelectionsBy(function(n){return i.display.shift||i.doc.extend||n.empty()?Cn(i.doc,n.head,t,e,i.options.rtlMoveVisually):0>t?n.from():n.to()},vs)}),deleteH:ci(function(t,e){var i=this.doc.sel,n=this.doc;i.somethingSelected()?n.replaceSelection("",null,"+delete"):kn(this,function(i){var r=Cn(n,i.head,t,e,!1);return 0>t?{from:r,to:i.head}:{from:i.head,to:r}})}),findPosV:function(t,e,i,n){var r=1,o=n;0>e&&(r=-1,e=-e);for(var a=0,s=J(this.doc,t);e>a;++a){var l=Xe(this,s,"div");if(null==o?o=l.left:l.left=o,s=Tn(this,l,r,i),s.hitSide)break}return s},moveV:ci(function(t,e){var i=this,n=this.doc,r=[],o=!i.display.shift&&!n.extend&&n.sel.somethingSelected();if(n.extendSelectionsBy(function(a){if(o)return 0>t?a.from():a.to();var s=Xe(i,a.head,"div");null!=a.goalColumn&&(s.left=a.goalColumn),r.push(s.left);var l=Tn(i,s,t,e);return"page"==e&&a==n.sel.primary()&&bn(i,null,Ge(i,l,"div").top-s.top),l},vs),r.length)for(var a=0;a<n.sel.ranges.length;a++)n.sel.ranges[a].goalColumn=r[a]}),findWordAt:function(t){var e=this.doc,i=Dr(e,t.line).text,n=t.ch,r=t.ch;if(i){var o=this.getHelper(t,"wordChars");(t.xRel<0||r==i.length)&&n?--n:++r;for(var a=i.charAt(n),s=xo(a,o)?function(t){return xo(t,o)}:/\s/.test(a)?function(t){return/\s/.test(t)}:function(t){return!/\s/.test(t)&&!xo(t)};n>0&&s(i.charAt(n-1));)--n;for(;r<i.length&&s(i.charAt(r));)++r}return new U(ba(t.line,n),ba(t.line,r))},toggleOverwrite:function(t){(null==t||t!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?As(this.display.cursorDiv,"CodeMirror-overwrite"):Ms(this.display.cursorDiv,"CodeMirror-overwrite"),ds(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return Lo()==this.display.input},scrollTo:ci(function(t,e){(null!=t||null!=e)&&xn(this),null!=t&&(this.curOp.scrollLeft=t),null!=e&&(this.curOp.scrollTop=e)}),getScrollInfo:function(){var t=this.display.scroller,e=ps;return{left:t.scrollLeft,top:t.scrollTop,height:t.scrollHeight-e,width:t.scrollWidth-e,clientHeight:t.clientHeight-e,clientWidth:t.clientWidth-e}},scrollIntoView:ci(function(t,e){if(null==t?(t={from:this.doc.sel.primary().head,to:null},null==e&&(e=this.options.cursorScrollMargin)):"number"==typeof t?t={from:ba(t,0),to:null}:null==t.from&&(t={from:t,to:null}),t.to||(t.to=t.from),t.margin=e||0,null!=t.from.line)xn(this),this.curOp.scrollToPos=t;else{var i=vn(this,Math.min(t.from.left,t.to.left),Math.min(t.from.top,t.to.top)-t.margin,Math.max(t.from.right,t.to.right),Math.max(t.from.bottom,t.to.bottom)+t.margin);this.scrollTo(i.scrollLeft,i.scrollTop)}}),setSize:ci(function(t,e){function i(t){return"number"==typeof t||/^\d+$/.test(String(t))?t+"px":t}var n=this;null!=t&&(n.display.wrapper.style.width=i(t)),null!=e&&(n.display.wrapper.style.height=i(e)),n.options.lineWrapping&&We(this);var r=n.display.viewFrom;n.doc.iter(r,n.display.viewTo,function(t){if(t.widgets)for(var e=0;e<t.widgets.length;e++)if(t.widgets[e].noHScroll){fi(n,r,"widget");break}++r}),n.curOp.forceUpdate=!0,ds(n,"refresh",this)}),operation:function(t){return si(this,t)},refresh:ci(function(){var t=this.display.cachedTextHeight;pi(this),this.curOp.forceUpdate=!0,Ne(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),h(this),(null==t||Math.abs(t-Ke(this.display))>.5)&&a(this),ds(this,"refresh",this)}),swapDoc:ci(function(t){var e=this.doc;return e.cm=null,Pr(this,t),Ne(this),ki(this),this.scrollTo(t.scrollLeft,t.scrollTop),this.curOp.forceScroll=!0,ro(this,"swapDoc",this,e),e}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},co(t);var Oa=t.defaults={},Ea=t.optionHandlers={},Ha=t.Init={toString:function(){return"CodeMirror.Init"}};Sn("value","",function(t,e){t.setValue(e)},!0),Sn("mode",null,function(t,e){t.doc.modeOption=e,i(t)},!0),Sn("indentUnit",2,i,!0),Sn("indentWithTabs",!1),Sn("smartIndent",!0),Sn("tabSize",4,function(t){n(t),Ne(t),pi(t)},!0),Sn("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(t,e){t.options.specialChars=new RegExp(e.source+(e.test("	")?"":"|	"),"g"),t.refresh()},!0),Sn("specialCharPlaceholder",xr,function(t){t.refresh()},!0),Sn("electricChars",!0),Sn("rtlMoveVisually",!ua),Sn("wholeLineUpdateBefore",!0),Sn("theme","default",function(t){s(t),l(t)},!0),Sn("keyMap","default",function(e,i,n){var r=Mn(i),o=n!=t.Init&&Mn(n);o&&o.detach&&o.detach(e,r),r.attach&&r.attach(e,o||null)}),Sn("extraKeys",null),Sn("lineWrapping",!1,r,!0),Sn("gutters",[],function(t){p(t.options),l(t)},!0),Sn("fixedGutter",!0,function(t,e){t.display.gutters.style.left=e?_(t.display)+"px":"0",t.refresh()},!0),Sn("coverGutterNextToScrollbar",!1,m,!0),Sn("lineNumbers",!1,function(t){p(t.options),l(t)},!0),Sn("firstLineNumber",1,l,!0),Sn("lineNumberFormatter",function(t){return t},l,!0),Sn("showCursorWhenSelecting",!1,ve,!0),Sn("resetSelectionOnContextMenu",!0),Sn("readOnly",!1,function(t,e){"nocursor"==e?(Ji(t),t.display.input.blur(),t.display.disabled=!0):(t.display.disabled=!1,e||ki(t))}),Sn("disableInput",!1,function(t,e){e||ki(t)},!0),Sn("dragDrop",!0),Sn("cursorBlinkRate",530),Sn("cursorScrollMargin",0),Sn("cursorHeight",1,ve,!0),Sn("singleCursorHeightPerLine",!0,ve,!0),Sn("workTime",100),Sn("workDelay",100),Sn("flattenSpans",!0,n,!0),Sn("addModeClass",!1,n,!0),Sn("pollInterval",100),Sn("undoDepth",200,function(t,e){t.doc.history.undoDepth=e}),Sn("historyEventDelay",1250),Sn("viewportMargin",10,function(t){t.refresh()},!0),Sn("maxHighlightLength",1e4,n,!0),Sn("moveInputWithCursor",!0,function(t,e){e||(t.display.inputDiv.style.top=t.display.inputDiv.style.left=0)}),Sn("tabindex",null,function(t,e){t.display.input.tabIndex=e||""}),Sn("autofocus",null);var za=t.modes={},Ia=t.mimeModes={};t.defineMode=function(e,i){t.defaults.mode||"null"==e||(t.defaults.mode=e),arguments.length>2&&(i.dependencies=Array.prototype.slice.call(arguments,2)),za[e]=i},t.defineMIME=function(t,e){Ia[t]=e},t.resolveMode=function(e){if("string"==typeof e&&Ia.hasOwnProperty(e))e=Ia[e];else if(e&&"string"==typeof e.name&&Ia.hasOwnProperty(e.name)){var i=Ia[e.name];"string"==typeof i&&(i={name:i}),e=vo(i,e),e.name=i.name}else if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return t.resolveMode("application/xml");return"string"==typeof e?{name:e}:e||{name:"null"}},t.getMode=function(e,i){var i=t.resolveMode(i),n=za[i.name];if(!n)return t.getMode(e,"text/plain");var r=n(e,i);if(Wa.hasOwnProperty(i.name)){var o=Wa[i.name];for(var a in o)o.hasOwnProperty(a)&&(r.hasOwnProperty(a)&&(r["_"+a]=r[a]),r[a]=o[a])}if(r.name=i.name,i.helperType&&(r.helperType=i.helperType),i.modeProps)for(var a in i.modeProps)r[a]=i.modeProps[a];return r},t.defineMode("null",function(){return{token:function(t){t.skipToEnd()}}}),t.defineMIME("text/plain","null");var Wa=t.modeExtensions={};t.extendMode=function(t,e){var i=Wa.hasOwnProperty(t)?Wa[t]:Wa[t]={};bo(e,i)},t.defineExtension=function(e,i){t.prototype[e]=i},t.defineDocExtension=function(t,e){ns.prototype[t]=e},t.defineOption=Sn;var Na=[];t.defineInitHook=function(t){Na.push(t)};var Ra=t.helpers={};t.registerHelper=function(e,i,n){Ra.hasOwnProperty(e)||(Ra[e]=t[e]={_global:[]}),Ra[e][i]=n},t.registerGlobalHelper=function(e,i,n,r){t.registerHelper(e,i,r),Ra[e]._global.push({pred:n,val:r})};var Ba=t.copyState=function(t,e){if(e===!0)return e;if(t.copyState)return t.copyState(e);var i={};for(var n in e){var r=e[n];r instanceof Array&&(r=r.concat([])),i[n]=r}return i},Fa=t.startState=function(t,e,i){return t.startState?t.startState(e,i):!0};t.innerMode=function(t,e){for(;t.innerMode;){var i=t.innerMode(e);if(!i||i.mode==t)break;e=i.state,t=i.mode}return i||{mode:t,state:e}};var qa=t.commands={selectAll:function(t){t.setSelection(ba(t.firstLine(),0),ba(t.lastLine()),gs)},singleSelection:function(t){t.setSelection(t.getCursor("anchor"),t.getCursor("head"),gs)},killLine:function(t){kn(t,function(e){if(e.empty()){var i=Dr(t.doc,e.head.line).text.length;return e.head.ch==i&&e.head.line<t.lastLine()?{from:e.head,to:ba(e.head.line+1,0)}:{from:e.head,to:ba(e.head.line,i)}}return{from:e.from(),to:e.to()}})},deleteLine:function(t){kn(t,function(e){return{from:ba(e.from().line,0),to:J(t.doc,ba(e.to().line+1,0))}})},delLineLeft:function(t){kn(t,function(t){return{from:ba(t.from().line,0),to:t.from()}})},delWrappedLineLeft:function(t){kn(t,function(e){var i=t.charCoords(e.head,"div").top+5,n=t.coordsChar({left:0,top:i},"div");
return{from:n,to:e.from()}})},delWrappedLineRight:function(t){kn(t,function(e){var i=t.charCoords(e.head,"div").top+5,n=t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:i},"div");return{from:e.from(),to:n}})},undo:function(t){t.undo()},redo:function(t){t.redo()},undoSelection:function(t){t.undoSelection()},redoSelection:function(t){t.redoSelection()},goDocStart:function(t){t.extendSelection(ba(t.firstLine(),0))},goDocEnd:function(t){t.extendSelection(ba(t.lastLine()))},goLineStart:function(t){t.extendSelectionsBy(function(e){return Fo(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){t.extendSelectionsBy(function(e){return Go(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(t){t.extendSelectionsBy(function(e){return qo(t,e.head.line)},{origin:"+move",bias:-1})},goLineRight:function(t){t.extendSelectionsBy(function(e){var i=t.charCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:i},"div")},vs)},goLineLeft:function(t){t.extendSelectionsBy(function(e){var i=t.charCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:i},"div")},vs)},goLineLeftSmart:function(t){t.extendSelectionsBy(function(e){var i=t.charCoords(e.head,"div").top+5,n=t.coordsChar({left:0,top:i},"div");return n.ch<t.getLine(n.line).search(/\S/)?Go(t,e.head):n},vs)},goLineUp:function(t){t.moveV(-1,"line")},goLineDown:function(t){t.moveV(1,"line")},goPageUp:function(t){t.moveV(-1,"page")},goPageDown:function(t){t.moveV(1,"page")},goCharLeft:function(t){t.moveH(-1,"char")},goCharRight:function(t){t.moveH(1,"char")},goColumnLeft:function(t){t.moveH(-1,"column")},goColumnRight:function(t){t.moveH(1,"column")},goWordLeft:function(t){t.moveH(-1,"word")},goGroupRight:function(t){t.moveH(1,"group")},goGroupLeft:function(t){t.moveH(-1,"group")},goWordRight:function(t){t.moveH(1,"word")},delCharBefore:function(t){t.deleteH(-1,"char")},delCharAfter:function(t){t.deleteH(1,"char")},delWordBefore:function(t){t.deleteH(-1,"word")},delWordAfter:function(t){t.deleteH(1,"word")},delGroupBefore:function(t){t.deleteH(-1,"group")},delGroupAfter:function(t){t.deleteH(1,"group")},indentAuto:function(t){t.indentSelection("smart")},indentMore:function(t){t.indentSelection("add")},indentLess:function(t){t.indentSelection("subtract")},insertTab:function(t){t.replaceSelection("	")},insertSoftTab:function(t){for(var e=[],i=t.listSelections(),n=t.options.tabSize,r=0;r<i.length;r++){var o=i[r].from(),a=bs(t.getLine(o.line),o.ch,n);e.push(new Array(n-a%n+1).join(" "))}t.replaceSelections(e)},defaultTab:function(t){t.somethingSelected()?t.indentSelection("add"):t.execCommand("insertTab")},transposeChars:function(t){si(t,function(){for(var e=t.listSelections(),i=[],n=0;n<e.length;n++){var r=e[n].head,o=Dr(t.doc,r.line).text;if(o)if(r.ch==o.length&&(r=new ba(r.line,r.ch-1)),r.ch>0)r=new ba(r.line,r.ch+1),t.replaceRange(o.charAt(r.ch-1)+o.charAt(r.ch-2),ba(r.line,r.ch-2),r,"+transpose");else if(r.line>t.doc.first){var a=Dr(t.doc,r.line-1).text;a&&t.replaceRange(o.charAt(0)+"\n"+a.charAt(a.length-1),ba(r.line-1,a.length-1),ba(r.line,1),"+transpose")}i.push(new U(r,r))}t.setSelections(i)})},newlineAndIndent:function(t){si(t,function(){for(var e=t.listSelections().length,i=0;e>i;i++){var n=t.listSelections()[i];t.replaceRange("\n",n.anchor,n.head,"+input"),t.indentLine(n.from().line+1,null,!0),yn(t)}})},toggleOverwrite:function(t){t.toggleOverwrite()}},Ga=t.keyMap={};Ga.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Ga.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Ga.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},Ga.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Ga["default"]=da?Ga.macDefault:Ga.pcDefault,t.normalizeKeyMap=function(t){var e={};for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];if(/^(name|fallthrough|(de|at)tach)$/.test(i))continue;if("..."==n){delete t[i];continue}for(var r=mo(i.split(" "),Ln),o=0;o<r.length;o++){var a,s;o==r.length-1?(s=i,a=n):(s=r.slice(0,o+1).join(" "),a="...");var l=e[s];if(l){if(l!=a)throw new Error("Inconsistent bindings for "+s)}else e[s]=a}delete t[i]}for(var c in e)t[c]=e[c];return t};var Xa=t.lookupKey=function(t,e,i){e=Mn(e);var n=e.call?e.call(t):e[t];if(n===!1)return"nothing";if("..."===n)return"multi";if(null!=n&&i(n))return"handled";if(e.fallthrough){if("[object Array]"!=Object.prototype.toString.call(e.fallthrough))return Xa(t,e.fallthrough,i);for(var r=0;r<e.fallthrough.length;r++){var o=Xa(t,e.fallthrough[r],i);if(o)return o}}},Ya=t.isModifierKey=function(t){var e="string"==typeof t?t:zs[t.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e},Va=t.keyName=function(t,e){if(ra&&34==t.keyCode&&t["char"])return!1;var i=zs[t.keyCode],n=i;return null==n||t.altGraphKey?!1:(t.altKey&&"Alt"!=i&&(n="Alt-"+n),(fa?t.metaKey:t.ctrlKey)&&"Ctrl"!=i&&(n="Ctrl-"+n),(fa?t.ctrlKey:t.metaKey)&&"Cmd"!=i&&(n="Cmd-"+n),!e&&t.shiftKey&&"Shift"!=i&&(n="Shift-"+n),n)};t.fromTextArea=function(e,i){function n(){e.value=c.getValue()}if(i||(i={}),i.value=e.value,!i.tabindex&&e.tabindex&&(i.tabindex=e.tabindex),!i.placeholder&&e.placeholder&&(i.placeholder=e.placeholder),null==i.autofocus){var r=Lo();i.autofocus=r==e||null!=e.getAttribute("autofocus")&&r==document.body}if(e.form&&(cs(e.form,"submit",n),!i.leaveSubmitMethodAlone)){var o=e.form,a=o.submit;try{var s=o.submit=function(){n(),o.submit=a,o.submit(),o.submit=s}}catch(l){}}e.style.display="none";var c=t(function(t){e.parentNode.insertBefore(t,e.nextSibling)},i);return c.save=n,c.getTextArea=function(){return e},c.toTextArea=function(){c.toTextArea=isNaN,n(),e.parentNode.removeChild(c.getWrapperElement()),e.style.display="",e.form&&(hs(e.form,"submit",n),"function"==typeof e.form.submit&&(e.form.submit=a))},c};var Ua=t.StringStream=function(t,e){this.pos=this.start=0,this.string=t,this.tabSize=e||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};Ua.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(t){var e=this.string.charAt(this.pos);if("string"==typeof t)var i=e==t;else var i=e&&(t.test?t.test(e):t(e));return i?(++this.pos,e):void 0},eatWhile:function(t){for(var e=this.pos;this.eat(t););return this.pos>e},eatSpace:function(){for(var t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t},skipToEnd:function(){this.pos=this.string.length},skipTo:function(t){var e=this.string.indexOf(t,this.pos);return e>-1?(this.pos=e,!0):void 0},backUp:function(t){this.pos-=t},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=bs(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?bs(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return bs(this.string,null,this.tabSize)-(this.lineStart?bs(this.string,this.lineStart,this.tabSize):0)},match:function(t,e,i){if("string"!=typeof t){var n=this.string.slice(this.pos).match(t);return n&&n.index>0?null:(n&&e!==!1&&(this.pos+=n[0].length),n)}var r=function(t){return i?t.toLowerCase():t},o=this.string.substr(this.pos,t.length);return r(o)==r(t)?(e!==!1&&(this.pos+=t.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(t,e){this.lineStart+=t;try{return e()}finally{this.lineStart-=t}}};var ja=t.TextMarker=function(t,e){this.lines=[],this.type=e,this.doc=t};co(ja),ja.prototype.clear=function(){if(!this.explicitlyCleared){var t=this.doc.cm,e=t&&!t.curOp;if(e&&Je(t),lo(this,"clear")){var i=this.find();i&&ro(this,"clear",i.from,i.to)}for(var n=null,r=null,o=0;o<this.lines.length;++o){var a=this.lines[o],s=Hn(a.markedSpans,this);t&&!this.collapsed?fi(t,zr(a),"text"):t&&(null!=s.to&&(r=zr(a)),null!=s.from&&(n=zr(a))),a.markedSpans=zn(a.markedSpans,s),null==s.from&&this.collapsed&&!nr(this.doc,a)&&t&&Hr(a,Ke(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var o=0;o<this.lines.length;++o){var l=Qn(this.lines[o]),c=d(l);c>t.display.maxLineLength&&(t.display.maxLine=l,t.display.maxLineLength=c,t.display.maxLineChanged=!0)}null!=n&&t&&this.collapsed&&pi(t,n,r+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&ue(t.doc)),t&&ro(t,"markerCleared",t,this),e&&ti(t),this.parent&&this.parent.clear()}},ja.prototype.find=function(t,e){null==t&&"bookmark"==this.type&&(t=1);for(var i,n,r=0;r<this.lines.length;++r){var o=this.lines[r],a=Hn(o.markedSpans,this);if(null!=a.from&&(i=ba(e?o:zr(o),a.from),-1==t))return i;if(null!=a.to&&(n=ba(e?o:zr(o),a.to),1==t))return n}return i&&{from:i,to:n}},ja.prototype.changed=function(){var t=this.find(-1,!0),e=this,i=this.doc.cm;t&&i&&si(i,function(){var n=t.line,r=zr(t.line),o=De(i,r);if(o&&(Ie(o),i.curOp.selectionChanged=i.curOp.forceUpdate=!0),i.curOp.updateMaxLine=!0,!nr(e.doc,n)&&null!=e.height){var a=e.height;e.height=null;var s=ar(e)-a;s&&Hr(n,n.height+s)}})},ja.prototype.attachLine=function(t){if(!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;e.maybeHiddenMarkers&&-1!=go(e.maybeHiddenMarkers,this)||(e.maybeUnhiddenMarkers||(e.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(t)},ja.prototype.detachLine=function(t){if(this.lines.splice(go(this.lines,t),1),!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;(e.maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)}};var Ka=0,Za=t.SharedTextMarker=function(t,e){this.markers=t,this.primary=e;for(var i=0;i<t.length;++i)t[i].parent=this};co(Za),Za.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var t=0;t<this.markers.length;++t)this.markers[t].clear();ro(this,"clear")}},Za.prototype.find=function(t,e){return this.primary.find(t,e)};var Ja=t.LineWidget=function(t,e,i){if(i)for(var n in i)i.hasOwnProperty(n)&&(this[n]=i[n]);this.cm=t,this.node=e};co(Ja),Ja.prototype.clear=function(){var t=this.cm,e=this.line.widgets,i=this.line,n=zr(i);if(null!=n&&e){for(var r=0;r<e.length;++r)e[r]==this&&e.splice(r--,1);e.length||(i.widgets=null);var o=ar(this);si(t,function(){or(t,i,-o),fi(t,n,"widget"),Hr(i,Math.max(0,i.height-o))})}},Ja.prototype.changed=function(){var t=this.height,e=this.cm,i=this.line;this.height=null;var n=ar(this)-t;n&&si(e,function(){e.curOp.forceUpdate=!0,or(e,i,n),Hr(i,i.height+n)})};var Qa=t.Line=function(t,e,i){this.text=t,Xn(this,e),this.height=i?i(this):1};co(Qa),Qa.prototype.lineNo=function(){return zr(this)};var ts={},es={};Mr.prototype={chunkSize:function(){return this.lines.length},removeInner:function(t,e){for(var i=t,n=t+e;n>i;++i){var r=this.lines[i];this.height-=r.height,cr(r),ro(r,"delete")}this.lines.splice(t,e)},collapse:function(t){t.push.apply(t,this.lines)},insertInner:function(t,e,i){this.height+=i,this.lines=this.lines.slice(0,t).concat(e).concat(this.lines.slice(t));for(var n=0;n<e.length;++n)e[n].parent=this},iterN:function(t,e,i){for(var n=t+e;n>t;++t)if(i(this.lines[t]))return!0}},Ar.prototype={chunkSize:function(){return this.size},removeInner:function(t,e){this.size-=e;for(var i=0;i<this.children.length;++i){var n=this.children[i],r=n.chunkSize();if(r>t){var o=Math.min(e,r-t),a=n.height;if(n.removeInner(t,o),this.height-=a-n.height,r==o&&(this.children.splice(i--,1),n.parent=null),0==(e-=o))break;t=0}else t-=r}if(this.size-e<25&&(this.children.length>1||!(this.children[0]instanceof Mr))){var s=[];this.collapse(s),this.children=[new Mr(s)],this.children[0].parent=this}},collapse:function(t){for(var e=0;e<this.children.length;++e)this.children[e].collapse(t)},insertInner:function(t,e,i){this.size+=e.length,this.height+=i;for(var n=0;n<this.children.length;++n){var r=this.children[n],o=r.chunkSize();if(o>=t){if(r.insertInner(t,e,i),r.lines&&r.lines.length>50){for(;r.lines.length>50;){var a=r.lines.splice(r.lines.length-25,25),s=new Mr(a);r.height-=s.height,this.children.splice(n+1,0,s),s.parent=this}this.maybeSpill()}break}t-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var t=this;do{var e=t.children.splice(t.children.length-5,5),i=new Ar(e);if(t.parent){t.size-=i.size,t.height-=i.height;var n=go(t.parent.children,t);t.parent.children.splice(n+1,0,i)}else{var r=new Ar(t.children);r.parent=t,t.children=[r,i],t=r}i.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},iterN:function(t,e,i){for(var n=0;n<this.children.length;++n){var r=this.children[n],o=r.chunkSize();if(o>t){var a=Math.min(e,o-t);if(r.iterN(t,a,i))return!0;if(0==(e-=a))break;t=0}else t-=o}}};var is=0,ns=t.Doc=function(t,e,i){if(!(this instanceof ns))return new ns(t,e,i);null==i&&(i=0),Ar.call(this,[new Mr([new Qa("",null)])]),this.first=i,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=i;var n=ba(i,0);this.sel=K(n),this.history=new Rr(null),this.id=++is,this.modeOption=e,"string"==typeof t&&(t=Ds(t)),Lr(this,{from:n,to:n,text:t}),ce(this,K(n),gs)};ns.prototype=vo(Ar.prototype,{constructor:ns,iter:function(t,e,i){i?this.iterN(t-this.first,e-t,i):this.iterN(this.first,this.first+this.size,t)},insert:function(t,e){for(var i=0,n=0;n<e.length;++n)i+=e[n].height;this.insertInner(t-this.first,e,i)},remove:function(t,e){this.removeInner(t-this.first,e)},getValue:function(t){var e=Er(this,this.first,this.first+this.size);return t===!1?e:e.join(t||"\n")},setValue:hi(function(t){var e=ba(this.first,0),i=this.first+this.size-1;sn(this,{from:e,to:ba(i,Dr(this,i).text.length),text:Ds(t),origin:"setValue"},!0),ce(this,K(e))}),replaceRange:function(t,e,i,n){e=J(this,e),i=i?J(this,i):e,pn(this,t,e,i,n)},getRange:function(t,e,i){var n=Or(this,J(this,t),J(this,e));return i===!1?n:n.join(i||"\n")},getLine:function(t){var e=this.getLineHandle(t);return e&&e.text},getLineHandle:function(t){return te(this,t)?Dr(this,t):void 0},getLineNumber:function(t){return zr(t)},getLineHandleVisualStart:function(t){return"number"==typeof t&&(t=Dr(this,t)),Qn(t)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(t){return J(this,t)},getCursor:function(t){var e,i=this.sel.primary();return e=null==t||"head"==t?i.head:"anchor"==t?i.anchor:"end"==t||"to"==t||t===!1?i.to():i.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:hi(function(t,e,i){ae(this,J(this,"number"==typeof t?ba(t,e||0):t),null,i)}),setSelection:hi(function(t,e,i){ae(this,J(this,t),J(this,e||t),i)}),extendSelection:hi(function(t,e,i){ne(this,J(this,t),e&&J(this,e),i)}),extendSelections:hi(function(t,e){re(this,ee(this,t,e))}),extendSelectionsBy:hi(function(t,e){re(this,mo(this.sel.ranges,t),e)}),setSelections:hi(function(t,e,i){if(t.length){for(var n=0,r=[];n<t.length;n++)r[n]=new U(J(this,t[n].anchor),J(this,t[n].head));null==e&&(e=Math.min(t.length-1,this.sel.primIndex)),ce(this,j(r,e),i)}}),addSelection:hi(function(t,e,i){var n=this.sel.ranges.slice(0);n.push(new U(J(this,t),J(this,e||t))),ce(this,j(n,n.length-1),i)}),getSelection:function(t){for(var e,i=this.sel.ranges,n=0;n<i.length;n++){var r=Or(this,i[n].from(),i[n].to());e=e?e.concat(r):r}return t===!1?e:e.join(t||"\n")},getSelections:function(t){for(var e=[],i=this.sel.ranges,n=0;n<i.length;n++){var r=Or(this,i[n].from(),i[n].to());t!==!1&&(r=r.join(t||"\n")),e[n]=r}return e},replaceSelection:function(t,e,i){for(var n=[],r=0;r<this.sel.ranges.length;r++)n[r]=t;this.replaceSelections(n,e,i||"+input")},replaceSelections:hi(function(t,e,i){for(var n=[],r=this.sel,o=0;o<r.ranges.length;o++){var a=r.ranges[o];n[o]={from:a.from(),to:a.to(),text:Ds(t[o]),origin:i}}for(var s=e&&"end"!=e&&on(this,n,e),o=n.length-1;o>=0;o--)sn(this,n[o]);s?le(this,s):this.cm&&yn(this.cm)}),undo:hi(function(){cn(this,"undo")}),redo:hi(function(){cn(this,"redo")}),undoSelection:hi(function(){cn(this,"undo",!0)}),redoSelection:hi(function(){cn(this,"redo",!0)}),setExtending:function(t){this.extend=t},getExtending:function(){return this.extend},historySize:function(){for(var t=this.history,e=0,i=0,n=0;n<t.done.length;n++)t.done[n].ranges||++e;for(var n=0;n<t.undone.length;n++)t.undone[n].ranges||++i;return{undo:e,redo:i}},clearHistory:function(){this.history=new Rr(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(t){return t&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(t){return this.history.generation==(t||this.cleanGeneration)},getHistory:function(){return{done:Zr(this.history.done),undone:Zr(this.history.undone)}},setHistory:function(t){var e=this.history=new Rr(this.history.maxGeneration);e.done=Zr(t.done.slice(0),null,!0),e.undone=Zr(t.undone.slice(0),null,!0)},addLineClass:hi(function(t,e,i){return wn(this,t,"gutter"==e?"gutter":"class",function(t){var n="text"==e?"textClass":"background"==e?"bgClass":"gutter"==e?"gutterClass":"wrapClass";if(t[n]){if(Mo(i).test(t[n]))return!1;t[n]+=" "+i}else t[n]=i;return!0})}),removeLineClass:hi(function(t,e,i){return wn(this,t,"class",function(t){var n="text"==e?"textClass":"background"==e?"bgClass":"gutter"==e?"gutterClass":"wrapClass",r=t[n];if(!r)return!1;if(null==i)t[n]=null;else{var o=r.match(Mo(i));if(!o)return!1;var a=o.index+o[0].length;t[n]=r.slice(0,o.index)+(o.index&&a!=r.length?" ":"")+r.slice(a)||null}return!0})}),markText:function(t,e,i){return An(this,J(this,t),J(this,e),i,"range")},setBookmark:function(t,e){var i={replacedWith:e&&(null==e.nodeType?e.widget:e),insertLeft:e&&e.insertLeft,clearWhenEmpty:!1,shared:e&&e.shared};return t=J(this,t),An(this,t,t,i,"bookmark")},findMarksAt:function(t){t=J(this,t);var e=[],i=Dr(this,t.line).markedSpans;if(i)for(var n=0;n<i.length;++n){var r=i[n];(null==r.from||r.from<=t.ch)&&(null==r.to||r.to>=t.ch)&&e.push(r.marker.parent||r.marker)}return e},findMarks:function(t,e,i){t=J(this,t),e=J(this,e);var n=[],r=t.line;return this.iter(t.line,e.line+1,function(o){var a=o.markedSpans;if(a)for(var s=0;s<a.length;s++){var l=a[s];r==t.line&&t.ch>l.to||null==l.from&&r!=t.line||r==e.line&&l.from>e.ch||i&&!i(l.marker)||n.push(l.marker.parent||l.marker)}++r}),n},getAllMarks:function(){var t=[];return this.iter(function(e){var i=e.markedSpans;if(i)for(var n=0;n<i.length;++n)null!=i[n].from&&t.push(i[n].marker)}),t},posFromIndex:function(t){var e,i=this.first;return this.iter(function(n){var r=n.text.length+1;return r>t?(e=t,!0):(t-=r,++i,void 0)}),J(this,ba(i,e))},indexFromPos:function(t){t=J(this,t);var e=t.ch;return t.line<this.first||t.ch<0?0:(this.iter(this.first,t.line,function(t){e+=t.text.length+1}),e)},copy:function(t){var e=new ns(Er(this,this.first,this.first+this.size),this.modeOption,this.first);return e.scrollTop=this.scrollTop,e.scrollLeft=this.scrollLeft,e.sel=this.sel,e.extend=!1,t&&(e.history.undoDepth=this.history.undoDepth,e.setHistory(this.getHistory())),e},linkedDoc:function(t){t||(t={});var e=this.first,i=this.first+this.size;null!=t.from&&t.from>e&&(e=t.from),null!=t.to&&t.to<i&&(i=t.to);var n=new ns(Er(this,e,i),t.mode||this.modeOption,e);return t.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:t.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:t.sharedHist}],Dn(n,Pn(this)),n},unlinkDoc:function(e){if(e instanceof t&&(e=e.doc),this.linked)for(var i=0;i<this.linked.length;++i){var n=this.linked[i];if(n.doc==e){this.linked.splice(i,1),e.unlinkDoc(this),On(Pn(this));break}}if(e.history==this.history){var r=[e.id];$r(e,function(t){r.push(t.id)},!0),e.history=new Rr(null),e.history.done=Zr(this.history.done,r),e.history.undone=Zr(this.history.undone,r)}},iterLinkedDocs:function(t){$r(this,t)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),ns.prototype.eachLine=ns.prototype.iter;var rs="iter insert remove copy getEditor".split(" ");for(var os in ns.prototype)ns.prototype.hasOwnProperty(os)&&go(rs,os)<0&&(t.prototype[os]=function(t){return function(){return t.apply(this.doc,arguments)}}(ns.prototype[os]));co(ns);var as=t.e_preventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},ss=t.e_stopPropagation=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},ls=t.e_stop=function(t){as(t),ss(t)},cs=t.on=function(t,e,i){if(t.addEventListener)t.addEventListener(e,i,!1);else if(t.attachEvent)t.attachEvent("on"+e,i);else{var n=t._handlers||(t._handlers={}),r=n[e]||(n[e]=[]);r.push(i)}},hs=t.off=function(t,e,i){if(t.removeEventListener)t.removeEventListener(e,i,!1);else if(t.detachEvent)t.detachEvent("on"+e,i);else{var n=t._handlers&&t._handlers[e];if(!n)return;for(var r=0;r<n.length;++r)if(n[r]==i){n.splice(r,1);break}}},ds=t.signal=function(t,e){var i=t._handlers&&t._handlers[e];if(i)for(var n=Array.prototype.slice.call(arguments,2),r=0;r<i.length;++r)i[r].apply(null,n)},us=null,ps=30,fs=t.Pass={toString:function(){return"CodeMirror.Pass"}},gs={scroll:!1},ms={origin:"*mouse"},vs={origin:"+move"};ho.prototype.set=function(t,e){clearTimeout(this.id),this.id=setTimeout(e,t)};var bs=t.countColumn=function(t,e,i,n,r){null==e&&(e=t.search(/[^\s\u00a0]/),-1==e&&(e=t.length));for(var o=n||0,a=r||0;;){var s=t.indexOf("	",o);if(0>s||s>=e)return a+(e-o);a+=s-o,a+=i-a%i,o=s+1}},ys=[""],xs=function(t){t.select()};ca?xs=function(t){t.selectionStart=0,t.selectionEnd=t.value.length}:Qo&&(xs=function(t){try{t.select()}catch(e){}}),[].indexOf&&(go=function(t,e){return t.indexOf(e)}),[].map&&(mo=function(t,e){return t.map(e)});var _s,ws=/[\u00df\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,ks=t.isWordChar=function(t){return/\w/.test(t)||t>"Â€"&&(t.toUpperCase()!=t.toLowerCase()||ws.test(t))},Cs=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;_s=document.createRange?function(t,e,i){var n=document.createRange();return n.setEnd(t,i),n.setStart(t,e),n}:function(t,e,i){var n=document.body.createTextRange();try{n.moveToElementText(t.parentNode)}catch(r){return n}return n.collapse(!0),n.moveEnd("character",i),n.moveStart("character",e),n},Qo&&11>ta&&(Lo=function(){try{return document.activeElement}catch(t){return document.body}});var Ts,Ss,Ls,Ms=t.rmClass=function(t,e){var i=t.className,n=Mo(e).exec(i);if(n){var r=i.slice(n.index+n[0].length);t.className=i.slice(0,n.index)+(r?n[1]+r:"")}},As=t.addClass=function(t,e){var i=t.className;Mo(e).test(i)||(t.className+=(i?" ":"")+e)},$s=!1,Ps=function(){if(Qo&&9>ta)return!1;var t=ko("div");return"draggable"in t||"dragDrop"in t}(),Ds=t.splitLines=3!="\n\nb".split(/\n/).length?function(t){for(var e=0,i=[],n=t.length;n>=e;){var r=t.indexOf("\n",e);-1==r&&(r=t.length);var o=t.slice(e,"\r"==t.charAt(r-1)?r-1:r),a=o.indexOf("\r");-1!=a?(i.push(o.slice(0,a)),e+=a+1):(i.push(o),e=r+1)}return i}:function(t){return t.split(/\r\n?|\n/)},Os=window.getSelection?function(t){try{return t.selectionStart!=t.selectionEnd}catch(e){return!1}}:function(t){try{var e=t.ownerDocument.selection.createRange()}catch(i){}return e&&e.parentElement()==t?0!=e.compareEndPoints("StartToEnd",e):!1},Es=function(){var t=ko("div");return"oncopy"in t?!0:(t.setAttribute("oncopy","return;"),"function"==typeof t.oncopy)}(),Hs=null,zs={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};t.keyNames=zs,function(){for(var t=0;10>t;t++)zs[t+48]=zs[t+96]=String(t);for(var t=65;90>=t;t++)zs[t]=String.fromCharCode(t);for(var t=1;12>=t;t++)zs[t+111]=zs[t+63235]="F"+t}();var Is,Ws=function(){function t(t){return 247>=t?i.charAt(t):t>=1424&&1524>=t?"R":t>=1536&&1773>=t?n.charAt(t-1536):t>=1774&&2220>=t?"r":t>=8192&&8203>=t?"w":8204==t?"b":"L"}function e(t,e,i){this.level=t,this.from=e,this.to=i}var i="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",n="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,o=/[stwN]/,a=/[LRr]/,s=/[Lb1n]/,l=/[1n]/,c="L";return function(i){if(!r.test(i))return!1;for(var n,h=i.length,d=[],u=0;h>u;++u)d.push(n=t(i.charCodeAt(u)));for(var u=0,p=c;h>u;++u){var n=d[u];"m"==n?d[u]=p:p=n}for(var u=0,f=c;h>u;++u){var n=d[u];"1"==n&&"r"==f?d[u]="n":a.test(n)&&(f=n,"r"==n&&(d[u]="R"))}for(var u=1,p=d[0];h-1>u;++u){var n=d[u];"+"==n&&"1"==p&&"1"==d[u+1]?d[u]="1":","!=n||p!=d[u+1]||"1"!=p&&"n"!=p||(d[u]=p),p=n}for(var u=0;h>u;++u){var n=d[u];if(","==n)d[u]="N";else if("%"==n){for(var g=u+1;h>g&&"%"==d[g];++g);for(var m=u&&"!"==d[u-1]||h>g&&"1"==d[g]?"1":"N",v=u;g>v;++v)d[v]=m;u=g-1}}for(var u=0,f=c;h>u;++u){var n=d[u];"L"==f&&"1"==n?d[u]="L":a.test(n)&&(f=n)}for(var u=0;h>u;++u)if(o.test(d[u])){for(var g=u+1;h>g&&o.test(d[g]);++g);for(var b="L"==(u?d[u-1]:c),y="L"==(h>g?d[g]:c),m=b||y?"L":"R",v=u;g>v;++v)d[v]=m;u=g-1}for(var x,_=[],u=0;h>u;)if(s.test(d[u])){var w=u;for(++u;h>u&&s.test(d[u]);++u);_.push(new e(0,w,u))}else{var k=u,C=_.length;for(++u;h>u&&"L"!=d[u];++u);for(var v=k;u>v;)if(l.test(d[v])){v>k&&_.splice(C,0,new e(1,k,v));var T=v;for(++v;u>v&&l.test(d[v]);++v);_.splice(C,0,new e(2,T,v)),k=v}else++v;u>k&&_.splice(C,0,new e(1,k,u))}return 1==_[0].level&&(x=i.match(/^\s+/))&&(_[0].from=x[0].length,_.unshift(new e(0,0,x[0].length))),1==fo(_).level&&(x=i.match(/\s+$/))&&(fo(_).to-=x[0].length,_.push(new e(0,h-x[0].length,h))),_[0].level!=fo(_).level&&_.push(new e(_[0].level,h,h)),_}}();return t.version="4.8.0",t}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";function e(e,r,o,a){function s(t){var i=l(e,r);if(!i||i.to.line-i.from.line<c)return null;for(var n=e.findMarksAt(i.from),o=0;o<n.length;++o)if(n[o].__isFold&&"fold"!==a){if(!t)return null;i.cleared=!0,n[o].clear()}return i}if(o&&o.call){var l=o;o=null}else var l=n(e,o,"rangeFinder");"number"==typeof r&&(r=t.Pos(r,0));var c=n(e,o,"minFoldSize"),h=s(!0);if(n(e,o,"scanUp"))for(;!h&&r.line>e.firstLine();)r=t.Pos(r.line-1,0),h=s(!1);if(h&&!h.cleared&&"unfold"!==a){var d=i(e,o);t.on(d,"mousedown",function(e){u.clear(),t.e_preventDefault(e)});var u=e.markText(h.from,h.to,{replacedWith:d,clearOnEnter:!0,__isFold:!0});u.on("clear",function(i,n){t.signal(e,"unfold",e,i,n)}),t.signal(e,"fold",e,h.from,h.to)}}function i(){var t=document.createElement("span"),e=document.createElement("i");return e.className="icon icon-ellipsis-horizontal",t.appendChild(e),t.className="CodeMirror-foldmarker",t}function n(t,e,i){if(e&&void 0!==e[i])return e[i];var n=t.options.foldOptions;return n&&void 0!==n[i]?n[i]:r[i]}t.newFoldFunction=function(t,i){return function(n,r){e(n,r,{rangeFinder:t,widget:i})}},t.defineExtension("foldCode",function(t,i,n){e(this,t,i,n)}),t.defineExtension("isFolded",function(t){for(var e=this.findMarksAt(t),i=0;i<e.length;++i)if(e[i].__isFold)return!0}),t.commands.toggleFold=function(t){t.foldCode(t.getCursor())},t.commands.fold=function(t){t.foldCode(t.getCursor(),null,"fold")},t.commands.unfold=function(t){t.foldCode(t.getCursor(),null,"unfold")},t.commands.foldAll=function(e){e.operation(function(){for(var i=e.firstLine(),n=e.lastLine();n>=i;i++)e.foldCode(t.Pos(i,0),null,"fold")})},t.commands.unfoldAll=function(e){e.operation(function(){for(var i=e.firstLine(),n=e.lastLine();n>=i;i++)e.foldCode(t.Pos(i,0),null,"unfold")})},t.registerHelper("fold","combine",function(){var t=Array.prototype.slice.call(arguments,0);return function(e,i){for(var n=0;n<t.length;++n){var r=t[n](e,i);if(r)return r}}}),t.registerHelper("fold","auto",function(t,e){for(var i=t.getHelpers(e,"fold"),n=0;n<i.length;n++){var r=i[n](t,e);if(r)return r}});var r={rangeFinder:t.fold.auto,widget:"â†”",minFoldSize:0,scanUp:!1};t.defineOption("foldOptions",null)}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror"),require("./foldcode")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./foldcode"],t):t(CodeMirror)}(function(t){"use strict";function e(t){this.options=t,this.from=this.to=0}function i(t){return t===!0&&(t={}),null==t.gutter&&(t.gutter="CodeMirror-foldgutter"),null==t.indicatorOpen&&(t.indicatorOpen="CodeMirror-foldgutter-open"),null==t.indicatorFolded&&(t.indicatorFolded="CodeMirror-foldgutter-folded"),t}function n(t,e){for(var i=t.findMarksAt(d(e)),n=0;n<i.length;++n)if(i[n].__isFold&&i[n].find().from.line==e)return!0}function r(t){if("string"==typeof t){var e=document.createElement("div");return e.className=t+" CodeMirror-guttermarker-subtle",e}return t.cloneNode(!0)}function o(e,i,o){var a=e.state.foldGutter.options,s=i;e.eachLine(i,o,function(i){var o=null;if(n(e,s))o=r(a.indicatorFolded);else{var l=d(s,0),c=a.rangeFinder||t.fold.auto,h=c&&c(e,l);h&&h.from.line+1<h.to.line&&(o=r(a.indicatorOpen))}e.setGutterMarker(i,a.gutter,o),++s})}function a(t){var e=t.getViewport(),i=t.state.foldGutter;i&&(t.operation(function(){o(t,e.from,e.to)}),i.from=e.from,i.to=e.to)}function s(t,e,i){var n=t.state.foldGutter.options;i==n.gutter&&t.foldCode(d(e,0),n.rangeFinder)}function l(t){var e=t.state.foldGutter,i=t.state.foldGutter.options;e.from=e.to=0,clearTimeout(e.changeUpdate),e.changeUpdate=setTimeout(function(){a(t)},i.foldOnChangeTimeSpan||600)}function c(t){var e=t.state.foldGutter,i=t.state.foldGutter.options;clearTimeout(e.changeUpdate),e.changeUpdate=setTimeout(function(){var i=t.getViewport();e.from==e.to||i.from-e.to>20||e.from-i.to>20?a(t):t.operation(function(){i.from<e.from&&(o(t,i.from,e.from),e.from=i.from),i.to>e.to&&(o(t,e.to,i.to),e.to=i.to)})},i.updateViewportTimeSpan||400)}function h(t,e){var i=t.state.foldGutter,n=e.line;n>=i.from&&n<i.to&&o(t,n,n+1)}t.defineOption("foldGutter",!1,function(n,r,o){o&&o!=t.Init&&(n.clearGutter(n.state.foldGutter.options.gutter),n.state.foldGutter=null,n.off("gutterClick",s),n.off("change",l),n.off("viewportChange",c),n.off("fold",h),n.off("unfold",h),n.off("swapDoc",a)),r&&(n.state.foldGutter=new e(i(r)),a(n),n.on("gutterClick",s),n.on("change",l),n.on("viewportChange",c),n.on("fold",h),n.on("unfold",h),n.on("swapDoc",a))});var d=t.Pos}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";t.registerHelper("fold","indent",function(e,i){var n=e.getOption("tabSize"),r=e.getLine(i.line);if(/\S/.test(r)){for(var o=function(e){return t.countColumn(e,null,n)},a=o(r),s=null,l=i.line+1,c=e.lastLine();c>=l;++l){var h=e.getLine(l),d=o(h);if(d>a)s=l;else if(/\S/.test(h))break}return s?{from:t.Pos(i.line,r.length),to:t.Pos(s,e.getLine(s).length)}:void 0}})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";t.registerGlobalHelper("fold","comment",function(t){return t.blockCommentStart&&t.blockCommentEnd},function(e,i){var n=e.getModeAt(i),r=n.blockCommentStart,o=n.blockCommentEnd;if(r&&o){for(var a,s=i.line,l=e.getLine(s),c=i.ch,h=0;;){var d=0>=c?-1:l.lastIndexOf(r,c-1);if(-1!=d){if(1==h&&d<i.ch)return;if(/comment/.test(e.getTokenTypeAt(t.Pos(s,d+1)))){a=d+r.length;break}c=d-1}else{if(1==h)return;h=1,c=l.length}}var u,p,f=1,g=e.lastLine();t:for(var m=s;g>=m;++m)for(var v=e.getLine(m),b=m==s?a:0;;){var y=v.indexOf(r,b),x=v.indexOf(o,b);if(0>y&&(y=v.length),0>x&&(x=v.length),b=Math.min(y,x),b==v.length)break;if(b==y)++f;else if(!--f){u=m,p=b;break t}++b}if(null!=u&&(s!=u||p!=a))return{from:t.Pos(s,a),to:t.Pos(u,p)}}})}),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";function e(t){var e=t.search(n);return-1==e?0:e}var i={},n=/[^\s\u00a0]/,r=t.Pos;t.commands.toggleComment=function(t){for(var e=1/0,i=t.listSelections(),n=null,o=i.length-1;o>=0;o--){var a=i[o].from(),s=i[o].to();a.line>=e||(s.line>=e&&(s=r(e,0)),e=a.line,null==n?t.uncomment(a,s)?n="un":(t.lineComment(a,s,{indent:!0}),n="line"):"un"==n?t.uncomment(a,s):t.lineComment(a,s,{indent:!0}))}},t.defineExtension("lineComment",function(t,o,a){a||(a=i);var s=this,l=s.getModeAt(t),c=a.lineComment||l.lineComment;if(!c)return(a.blockCommentStart||l.blockCommentStart)&&(a.fullLines=!0,s.blockComment(t,o,a)),void 0;var h=s.getLine(t.line);if(null!=h){var d=Math.min(0!=o.ch||o.line==t.line?o.line+1:o.line,s.lastLine()+1),u=null==a.padding?" ":a.padding,p=a.commentBlankLines||t.line==o.line;s.operation(function(){if(a.indent){for(var i=1/0,o=t.line;d>o;++o){var l=s.getLine(o);(p||n.test(l))&&(i=Math.min(e(l),i))}for(var h=new Array(i+1).join(" "),o=t.line;d>o;++o){var l=s.getLine(o),f=h.length;(p||n.test(l))&&(l.slice(0,f)!=h&&(f=e(l)),s.replaceRange(h+c+u,r(o,0),r(o,f)))}}else for(var o=t.line;d>o;++o)(p||n.test(s.getLine(o)))&&s.replaceRange(c+u,r(o,0))})}}),t.defineExtension("blockComment",function(t,e,o){o||(o=i);var a=this,s=a.getModeAt(t),l=o.blockCommentStart||s.blockCommentStart,c=o.blockCommentEnd||s.blockCommentEnd;if(!l||!c)return(o.lineComment||s.lineComment)&&0!=o.fullLines&&a.lineComment(t,e,o),void 0;var h=Math.min(e.line,a.lastLine());h!=t.line&&0==e.ch&&n.test(a.getLine(h))&&--h;var d=null==o.padding?" ":o.padding;t.line>h||a.operation(function(){if(0!=o.fullLines){var i=n.test(a.getLine(h));a.replaceRange(d+c,r(h)),a.replaceRange(l+d,r(t.line,0));var u=o.blockCommentLead||s.blockCommentLead;if(null!=u)for(var p=t.line+1;h>=p;++p)(p!=h||i)&&a.replaceRange(u+d,r(p,0))}else a.replaceRange(c,e),a.replaceRange(l,t)})}),t.defineExtension("uncomment",function(t,e,o){o||(o=i);var a,s=this,l=s.getModeAt(t),c=Math.min(0!=e.ch||e.line==t.line?e.line:e.line-1,s.lastLine()),h=Math.min(t.line,c),d=o.lineComment||l.lineComment,u=[],p=null==o.padding?" ":o.padding;t:if(d){for(var f=h;c>=f;++f){var g=s.getLine(f),m=g.indexOf(d);if(m>-1&&!/comment/.test(s.getTokenTypeAt(r(f,m+1)))&&(m=-1),-1==m&&(f!=c||f==h)&&n.test(g))break t;if(m>-1&&n.test(g.slice(0,m)))break t;u.push(g)}if(s.operation(function(){for(var t=h;c>=t;++t){var e=u[t-h],i=e.indexOf(d),n=i+d.length;0>i||(e.slice(n,n+p.length)==p&&(n+=p.length),a=!0,s.replaceRange("",r(t,i),r(t,n)))}}),a)return!0}var v=o.blockCommentStart||l.blockCommentStart,b=o.blockCommentEnd||l.blockCommentEnd;if(!v||!b)return!1;var y=o.blockCommentLead||l.blockCommentLead,x=s.getLine(h),_=c==h?x:s.getLine(c),w=x.indexOf(v),k=_.lastIndexOf(b);if(-1==k&&h!=c&&(_=s.getLine(--c),k=_.lastIndexOf(b)),-1==w||-1==k||!/comment/.test(s.getTokenTypeAt(r(h,w+1)))||!/comment/.test(s.getTokenTypeAt(r(c,k+1))))return!1;var C=x.lastIndexOf(v,t.ch),T=-1==C?-1:x.slice(0,t.ch).indexOf(b,C+v.length);if(-1!=C&&-1!=T&&T+b.length!=t.ch)return!1;T=_.indexOf(b,e.ch);var S=_.slice(e.ch).lastIndexOf(v,T-e.ch);return C=-1==T||-1==S?-1:e.ch+S,-1!=T&&-1!=C&&C!=e.ch?!1:(s.operation(function(){s.replaceRange("",r(c,k-(p&&_.slice(k-p.length,k)==p?p.length:0)),r(c,k+b.length));var t=w+v.length;if(p&&x.slice(t,t+p.length)==p&&(t+=p.length),s.replaceRange("",r(h,w),r(h,t)),y)for(var e=h+1;c>=e;++e){var i=s.getLine(e),o=i.indexOf(y);if(-1!=o&&!n.test(i.slice(0,o))){var a=o+y.length;p&&i.slice(a,a+p.length)==p&&(a+=p.length),s.replaceRange("",r(e,o),r(e,a))}}}),!0)})}),function(){function t(t,n,r,o){if(this.atOccurrence=!1,this.doc=t,null==o&&"string"==typeof n&&(o=!1),r=r?t.clipPos(r):i(0,0),this.pos={from:r,to:r},"string"!=typeof n)n.global||(n=new RegExp(n.source,n.ignoreCase?"ig":"g")),this.matches=function(e,r){if(e){n.lastIndex=0;for(var o,a,s=t.getLine(r.line).slice(0,r.ch),l=0;;){n.lastIndex=l;var c=n.exec(s);if(!c)break;if(o=c,a=o.index,l=o.index+(o[0].length||1),l==s.length)break}var h=o&&o[0].length||0;h||(0==a&&0==s.length?o=void 0:a!=t.getLine(r.line).length&&h++)}else{n.lastIndex=r.ch;var s=t.getLine(r.line),o=n.exec(s),h=o&&o[0].length||0,a=o&&o.index;a+h==s.length||h||(h=1)}return o&&h?{from:i(r.line,a),to:i(r.line,a+h),match:o}:void 0};else{var a=n;o&&(n=n.toLowerCase());var s=o?function(t){return t.toLowerCase()}:function(t){return t},l=n.split("\n");if(1==l.length)this.matches=n.length?function(r,o){if(r){var l=t.getLine(o.line).slice(0,o.ch),c=s(l),h=c.lastIndexOf(n);if(h>-1)return h=e(l,c,h),{from:i(o.line,h),to:i(o.line,h+a.length)}}else{var l=t.getLine(o.line).slice(o.ch),c=s(l),h=c.indexOf(n);if(h>-1)return h=e(l,c,h)+o.ch,{from:i(o.line,h),to:i(o.line,h+a.length)}}}:function(){};else{var c=a.split("\n");this.matches=function(e,n){var r=l.length-1;if(e){if(n.line-(l.length-1)<t.firstLine())return;if(s(t.getLine(n.line).slice(0,c[r].length))!=l[l.length-1])return;for(var o=i(n.line,c[r].length),a=n.line-1,h=r-1;h>=1;--h,--a)if(l[h]!=s(t.getLine(a)))return;var d=t.getLine(a),u=d.length-c[0].length;if(s(d.slice(u))!=l[0])return;return{from:i(a,u),to:o}}if(!(n.line+(l.length-1)>t.lastLine())){var d=t.getLine(n.line),u=d.length-c[0].length;if(s(d.slice(u))==l[0]){for(var p=i(n.line,u),a=n.line+1,h=1;r>h;++h,++a)if(l[h]!=s(t.getLine(a)))return;if(t.getLine(a).slice(0,c[r].length)==l[r])return{from:p,to:i(a,c[r].length)}}}}}}}function e(t,e,i){if(t.length==e.length)return i;for(var n=Math.min(i,t.length);;){var r=t.slice(0,n).toLowerCase().length;if(i>r)++n;else{if(!(r>i))return n;--n}}}var i=CodeMirror.Pos;t.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(t){function e(t){var e=i(t,0);return n.pos={from:e,to:e},n.atOccurrence=!1,!1}for(var n=this,r=this.doc.clipPos(t?this.pos.from:this.pos.to);;){if(this.pos=this.matches(t,r))return this.atOccurrence=!0,this.pos.match||!0;if(t){if(!r.line)return e(0);r=i(r.line-1,this.doc.getLine(r.line-1).length)}else{var o=this.doc.lineCount();if(r.line==o-1)return e(o);r=i(r.line+1,0)}}},from:function(){return this.atOccurrence?this.pos.from:void 0},to:function(){return this.atOccurrence?this.pos.to:void 0},replace:function(t){if(this.atOccurrence){var e=CodeMirror.splitLines(t);this.doc.replaceRange(e,this.pos.from,this.pos.to),this.pos.to=i(this.pos.from.line+e.length-1,e[e.length-1].length+(1==e.length?this.pos.from.ch:0))}}},CodeMirror.defineExtension("getSearchCursor",function(e,i,n){return new t(this.doc,e,i,n)}),CodeMirror.defineDocExtension("getSearchCursor",function(e,i,n){return new t(this,e,i,n)})}(),/**
 * Copyright 2013 Craig Campbell
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Mousetrap is a simple keyboard shortcut library for Javascript with
 * no external dependencies
 *
 * @version 1.4.6
 * @url craig.is/killing/mice
 */
function(t,e){function i(t,e,i){return t.addEventListener?(t.addEventListener(e,i,!1),void 0):(t.attachEvent("on"+e,i),void 0)}function n(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return C[t.which]?C[t.which]:T[t.which]?T[t.which]:String.fromCharCode(t.which).toLowerCase()}function r(t,e){return t.sort().join(",")===e.sort().join(",")}function o(t){t=t||{};var e,i=!1;for(e in $)t[e]?i=!0:$[e]=0;i||(O=!1)}function a(t,e,i,n,o,a){var s,l,c=[],h=i.type;if(!M[t])return[];for("keyup"==h&&p(t)&&(e=[t]),s=0;s<M[t].length;++s)if(l=M[t][s],(n||!l.seq||$[l.seq]==l.level)&&h==l.action&&("keypress"==h&&!i.metaKey&&!i.ctrlKey||r(e,l.modifiers))){var d=!n&&l.combo==o,u=n&&l.seq==n&&l.level==a;(d||u)&&M[t].splice(s,1),c.push(l)}return c}function s(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}function l(t){return t.preventDefault?(t.preventDefault(),void 0):(t.returnValue=!1,void 0)}function c(t){return t.stopPropagation?(t.stopPropagation(),void 0):(t.cancelBubble=!0,void 0)}function h(t,e,i,n){H.stopCallback(e,e.target||e.srcElement,i,n)||t(e,i)===!1&&(l(e),c(e))}function d(t,e,i){var n,r=a(t,e,i),s={},l=0,c=!1;for(n=0;n<r.length;++n)r[n].seq&&(l=Math.max(l,r[n].level));for(n=0;n<r.length;++n)if(r[n].seq){if(r[n].level!=l)continue;c=!0,s[r[n].seq]=1,h(r[n].callback,i,r[n].combo,r[n].seq)}else c||h(r[n].callback,i,r[n].combo);var d="keypress"==i.type&&D;i.type!=O||p(t)||d||o(s),D=c&&"keydown"==i.type}function u(t){"number"!=typeof t.which&&(t.which=t.keyCode);var e=n(t);if(e)return"keyup"==t.type&&P===e?(P=!1,void 0):(H.handleKey(e,s(t),t),void 0)}function p(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function f(){clearTimeout(k),k=setTimeout(o,1e3)}function g(){if(!w){w={};for(var t in C)t>95&&112>t||C.hasOwnProperty(t)&&(w[C[t]]=t)}return w}function m(t,e,i){return i||(i=g()[t]?"keydown":"keypress"),"keypress"==i&&e.length&&(i="keydown"),i}function v(t,e,i,r){function a(e){return function(){O=e,++$[t],f()}}function s(e){h(i,e,t),"keyup"!==r&&(P=n(e)),setTimeout(o,10)}$[t]=0;for(var l=0;l<e.length;++l){var c=l+1===e.length,d=c?s:a(r||y(e[l+1]).action);x(e[l],d,r,t,l)}}function b(t){return"+"===t?["+"]:t.split("+")}function y(t,e){var i,n,r,o=[];for(i=b(t),r=0;r<i.length;++r)n=i[r],L[n]&&(n=L[n]),e&&"keypress"!=e&&S[n]&&(n=S[n],o.push("shift")),p(n)&&o.push(n);return e=m(n,o,e),{key:n,modifiers:o,action:e}}function x(t,e,i,n,r){A[t+":"+i]=e,t=t.replace(/\s+/g," ");var o,s=t.split(" ");return s.length>1?(v(t,s,e,i),void 0):(o=y(t,i),M[o.key]=M[o.key]||[],a(o.key,o.modifiers,{type:o.action},n,t,r),M[o.key][n?"unshift":"push"]({callback:e,modifiers:o.modifiers,action:o.action,seq:n,level:r,combo:t}),void 0)}function _(t,e,i){for(var n=0;n<t.length;++n)x(t[n],e,i)}for(var w,k,C={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},T={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},S={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},L={option:"alt",command:"meta","return":"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},M={},A={},$={},P=!1,D=!1,O=!1,E=1;20>E;++E)C[111+E]="f"+E;for(E=0;9>=E;++E)C[E+96]=E;i(e,"keypress",u),i(e,"keydown",u),i(e,"keyup",u);var H={bind:function(t,e,i){return t=t instanceof Array?t:[t],_(t,e,i),this},unbind:function(t,e){return H.bind(t,function(){},e)},trigger:function(t,e){return A[t+":"+e]&&A[t+":"+e]({},t),this},reset:function(){return M={},A={},this},stopCallback:function(t,e){return(" "+e.className+" ").indexOf(" mousetrap ")>-1?!1:"INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable},handleKey:d};t.Mousetrap=H,"function"==typeof define&&define.amd&&define(H)}(window,document),Mousetrap=function(t){var e={},i=t.stopCallback;return t.stopCallback=function(t,n,r,o){return e[r]||e[o]?!1:i(t,n,r)},t.bindGlobal=function(i,n,r){if(t.bind(i,n,r),i instanceof Array)for(var o=0;o<i.length;o++)e[i[o]]=!0;else e[i]=!0},t}(Mousetrap),// CodeMirror, copyright (c) by Marijn Haverbeke and others
function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";function e(t){return new RegExp("^(("+t.join(")|(")+"))\\b")}function i(t){return t.scopes[t.scopes.length-1]}var n=e(["and","or","not","is"]),r=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield","in"],o=["abs","all","any","bin","bool","bytearray","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip","__import__","NotImplemented","Ellipsis","__debug__"],a={builtins:["apply","basestring","buffer","cmp","coerce","execfile","file","intern","long","raw_input","reduce","reload","unichr","unicode","xrange","False","True","None"],keywords:["exec","print"]},s={builtins:["ascii","bytes","exec","print"],keywords:["nonlocal","False","True","None"]},l=["settled_cash","accrued_interest","buying_power","equity_with_loan","total_positions_value","regt_equity","regt_margin","initial_margin_requirement","maintenance_margin_requirement","available_funds","excess_liquidity","cushion","day_trades_remaining","leverage","net_liquidation","net_leverage"],c=["capital_used","cash","pnl","portfolio_value","positions","positions_value","returns","start_date","starting_cash"],h=["amount","cost_basis","last_sale_price","sid"],d=["sid"],u=["order","order_percent","order_target","order_target_value","order_target_percent","order_value","get_open_orders","get_order","cancel_order"],p=["set_max_order_count","set_long_only","set_max_order_size","set_max_position_size","set_do_not_order_list"],f=["get_environment"],g=["schedule_function"],m=["symbols"],v=["set_symbol_lookup_date"],b=["set_slippage","set_commission"],y=["symbol","security_name","security_start_date","security_end_date"],x=["record"],w=["fetch_csv"],k=["get_datetime"],C=["get_fundamentals"],T=["log"],S=["account","portfolio"],L=["current","can_trade","is_stale","history","fetcher_assets"],M=["security_lists"],A=["error","info","warn","debug"],$=["FixedSlippage","VolumeShareSlippage"],P=["DollarVolumeUniverse"],D=["PerShare","PerTrade"],O=["set_benchmark"],E=[];"undefined"!=typeof quanto_data&&"undefined"!=typeof quanto_data.talib_info&&(E=_.keys(quanto_data.talib_info)),t.registerHelper("hintWords","python",r.concat(o)),t.defineMode("python",function(H,z){function I(t,e){if(t.sol()&&"py"==i(e).type){var n=i(e).offset;if(t.eatSpace()){var r=t.indentation();return r>n&&R(t,e,"py"),n>r&&B(t,e),null}var o=W(t,e);return n>0&&B(t,e)&&(o+=" "+q),o}return W(t,e)}function W(t,e){if(t.eatSpace())return null;var i=t.peek();if("#"==i)return t.skipToEnd(),"comment";if(t.match(/^[0-9\.]/,!1)){var r=!1;if(t.match(/^\d*\.\d+(e[\+\-]?\d+)?/i)&&(r=!0),t.match(/^\d+\.\d*/)&&(r=!0),t.match(/^\.\d+/)&&(r=!0),r)return t.eat(/J/i),"number";var o=!1;if(t.match(/^0x[0-9a-f]+/i)&&(o=!0),t.match(/^0b[01]+/i)&&(o=!0),t.match(/^0o[0-7]+/i)&&(o=!0),t.match(/^[1-9]\d*(e[\+\-]?\d+)?/)&&(t.eat(/J/i),o=!0),t.match(/^0(?![\dx])/i)&&(o=!0),o)return t.eat(/L/i),"sid("==t.string.substring(t.start-4,t.start)&&")"==t.peek()?"sid-value":"number"}if(t.match(Q))return e.tokenize=N(t.current()),e.tokenize(t,e);if(t.match(V)||t.match(Y))return null;if(t.match(X)||t.match(U)||t.match(n))return"operator";if(t.match(G))return null;if(t.match(te))return"keyword";if(t.match(ee))return"builtin";if(t.match(/^(self|cls)\b/))return"variable-2";if(t.match(ie))return"."==e.lastToken?"quanto-account":"variable";if(t.match(ne))return"."==e.lastToken?"quanto-portfolio":"variable";if(t.match(re))return"."==e.lastToken?"quanto-position":"variable";if(t.match(ae))return"."==e.lastToken?"quanto-sidinfo":"variable";if(t.match(se))return"."==e.lastToken||"("!=t.peek()?"variable":"quanto-symbol";if(t.match(le))return"."==e.lastToken||"("!=t.peek()?"variable":"quanto-lookupdate";if(t.match(oe))return"."==e.lastToken||"("!=t.peek()?"variable":"quanto-toplevel";if(t.match(ce))return"."==e.lastToken||"("!=t.peek()?"variable":"quanto-order";if(t.match(he))return"."==e.lastToken||"("!=t.peek()?"variable":"quanto-tradingcontrols";if(t.match(de))return"."==e.lastToken||"("!=t.peek()?"variable":"quanto-environment";if(t.match(ue))return"."==e.lastToken||"("!=t.peek()?"variable":"quanto-scheduler";if(t.match(pe))return"."==e.lastToken||"("!=t.peek()?"variable":"quanto-recordvars";if(t.match(fe))return"."==e.lastToken||"("!=t.peek()?"variable":"quanto-fetchcsv";if(t.match(ge))return"."==e.lastToken||"("!=t.peek()?"variable":"quanto-getdatetime";if(t.match(me))return"."==e.lastToken||"("!=t.peek()?"variable":"quanto-fundamentals";if(t.match(ve))return"."==e.lastToken||"("!=t.peek()?"variable":"quanto-log";if(t.match(be))return"."==e.lastToken||"("==t.peek()?"quanto-log-method":"variable";if(t.match(ye))return"."==e.lastToken||"("!=t.peek()?"variable":"quanto-toplevel";if(t.match(xe))return"."==e.lastToken||"("!=t.peek()?"quanto-context-method":"variable";if(t.match(_e)){if(t.start-5<0)var a=0;else var a=t.start-5;return"data."==t.string.substring(a,t.start)&&"("==t.peek()?"quanto-data-method":"variable"}return t.match(we)?"."==e.lastToken||"("!=t.peek()?"quanto-securitylist":"variable":t.match(ke)?_.str.endsWith(t.string.substring(0,t.start),"slippage.")?"quanto-slippage":"variable":Le&&t.match(Le)?_.str.endsWith(t.string.substring(0,t.start),"ta.")?"quanto-talib":"variable":t.match(Te)?_.str.endsWith(t.string.substring(0,t.start),"universe.")?"quanto-universe":"variable":t.match(Se)?"."==e.lastToken||"("!=t.peek()?"variable":"quanto-benchmark":t.match(Ce)?_.str.endsWith(t.string.substring(0,t.start),"commission.")?"quanto-commission":"variable":t.match(j)?"def"==e.lastToken||"class"==e.lastToken?"def":"variable":(t.next(),q)}function N(t){function e(e,r){for(;!e.eol();)if(e.eatWhile(/[^'"\\]/),e.eat("\\")){if(e.next(),i&&e.eol())return n}else{if(e.match(t))return r.tokenize=I,n;e.eat(/['"]/)}if(i){if(z.singleLineStringErrors)return q;r.tokenize=I}return n}for(;"rub".indexOf(t.charAt(0).toLowerCase())>=0;)t=t.substr(1);var i=1==t.length,n="string";return e.isString=!0,e}function R(t,e,n){var r=0,o=null;if("py"==n)for(;"py"!=i(e).type;)e.scopes.pop();r=i(e).offset+("py"==n?H.indentUnit:K),"py"==n||t.match(/^(\s|#.*)*$/,!1)||(o=t.column()+1),e.scopes.push({offset:r,type:n,align:o})}function B(t,e){for(var n=t.indentation();i(e).offset>n;){if("py"!=i(e).type)return!0;e.scopes.pop()}return i(e).offset!=n}function F(t,e){var n=e.tokenize(t,e),r=t.current();if("."===r)return"period";if("@"==r)return z.version&&3==parseInt(z.version,10)?t.match(j,!1)?"meta":"operator":t.match(j,!1)?"meta":q;"variable"!=n&&"builtin"!=n||"meta"!=e.lastStyle||(n="meta"),("pass"==r||"return"==r)&&(e.dedent+=1),"lambda"==r&&(e.lambda=!0),":"!=r||e.lambda||"py"!=i(e).type||R(t,e,"py");var o=1==r.length?"[({".indexOf(r):-1;if(-1!=o&&R(t,e,"])}".slice(o,o+1)),o="])}".indexOf(r),-1!=o){if(i(e).type!=r)return q;e.scopes.pop()}return e.dedent>0&&t.eol()&&"py"==i(e).type&&(e.scopes.length>1&&e.scopes.pop(),e.dedent-=1),n}var q="error",G=z.singleDelimiters||new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]"),X=z.doubleOperators||new RegExp("^((==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))"),Y=z.doubleDelimiters||new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))"),V=z.tripleDelimiters||new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))");if(z.version&&3==parseInt(z.version,10))var U=z.singleOperators||new RegExp("^[\\+\\-\\*/%&|\\^~<>!@]"),j=z.identifiers||new RegExp("^[_A-Za-zÂ¡-ï¿¿][_A-Za-z0-9Â¡-ï¿¿]*");else var U=z.singleOperators||new RegExp("^[\\+\\-\\*/%&|\\^~<>!]"),j=z.identifiers||new RegExp("^[_A-Za-z][_A-Za-z0-9]*");var K=z.hangingIndent||H.indentUnit,Z=r,J=o;if(void 0!=z.extra_keywords&&(Z=Z.concat(z.extra_keywords)),void 0!=z.extra_builtins&&(J=J.concat(z.extra_builtins)),z.version&&3==parseInt(z.version,10)){Z=Z.concat(s.keywords),J=J.concat(s.builtins);var Q=new RegExp("^(([rb]|(br))?('{3}|\"{3}|['\"]))","i")}else{Z=Z.concat(a.keywords),J=J.concat(a.builtins);var Q=new RegExp("^(([rub]|(ur)|(br))?('{3}|\"{3}|['\"]))","i")}var te=e(Z),ee=e(J),ie=e(l),ne=e(c),re=e(h),oe=e(b),ae=e(y),se=e(m),le=e(v),ce=e(u),he=e(p),de=e(f),ue=e(g),pe=e(x),fe=e(w),ge=e(k),me=e(C),ve=e(T),be=e(A),ye=e(d),xe=e(S),_e=e(L),we=e(M),ke=e($),Ce=e(D),Te=e(P),Se=e(O);if(E&&E.length>0)var Le=e(E);var Me={startState:function(t){return{tokenize:I,scopes:[{offset:t||0,type:"py",align:null}],lastStyle:null,lastToken:null,lambda:!1,dedent:0}},token:function(t,e){var i=e.errorToken;i&&(e.errorToken=!1);var n=F(t,e);e.lastStyle=n;var r=t.current();return r&&n&&(e.lastToken=r),t.eol()&&e.lambda&&(e.lambda=!1),i?n+" "+q:n},indent:function(e,n){if(e.tokenize!=I)return e.tokenize.isString?t.Pass:0;var r=i(e),o=n&&n.charAt(0)==r.type;return null!=r.align?r.align-(o?1:0):o&&e.scopes.length>1?e.scopes[e.scopes.length-2].offset:r.offset},lineComment:"#",fold:"indent",blockCommentStart:'"""',blockCommentEnd:'"""'};return Me}),t.defineMIME("text/x-python","python");var H=function(t){return t.split(" ")};t.defineMIME("text/x-cython",{name:"python",extra_keywords:H("by cdef cimport cpdef ctypedef enum exceptextern gil include nogil property publicreadonly struct union DEF IF ELIF ELSE")})});